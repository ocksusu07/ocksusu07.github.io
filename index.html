<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üåø ÎßàÎ≤ï Ïò®Ïã§ Í¥ÄÎ¶¨Ïûê</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', monospace;
            min-height: 100vh;
            padding: 20px;
            transition: all 0.5s ease;
        }

        /* ÎÇ†Ïî®Î≥Ñ Î∞∞Í≤Ω Ïä§ÌÉÄÏùº */
        body.weather-sunny {
            background: linear-gradient(135deg, #87CEEB, #FFD700);
            color: #2c3e50;
        }

        body.weather-rainy {
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: #ecf0f1;
        }

        body.weather-foggy {
            background: linear-gradient(135deg, #7f8c8d, #95a5a6);
            color: #2c3e50;
        }

        body.weather-snowy {
            background: linear-gradient(135deg, #bdc3c7, #ecf0f1);
            color: #2c3e50;
        }

        body.weather-storm {
            background: linear-gradient(135deg, #2c3e50, #8e44ad);
            color: #ecf0f1;
        }

        body.weather-rainbow {
            background: linear-gradient(135deg, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4, #feca57, #ff9ff3, #54a0ff);
            background-size: 400% 400%;
            animation: rainbow 3s ease infinite;
            color: #2c3e50;
        }

        body.weather-hot {
            background: linear-gradient(135deg, #e74c3c, #f39c12);
            color: #2c3e50;
        }

        body.weather-night {
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: #ecf0f1;
        }

        @keyframes rainbow {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            border-radius: 20px;
            padding: 30px;
            background: rgba(255, 255, 255, 0.25);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
            transition: all 0.5s ease;
        }

        /* ÎÇ†Ïî®Î≥Ñ Ïª®ÌÖåÏù¥ÎÑà Ïä§ÌÉÄÏùº */
        body.weather-sunny .container {
            background: rgba(255, 255, 255, 0.3);
            border: 2px solid rgba(255, 215, 0, 0.4);
            box-shadow: 0 8px 32px rgba(255, 215, 0, 0.25);
        }

        body.weather-rainy .container {
            background: rgba(52, 73, 94, 0.3);
            border: 2px solid rgba(52, 152, 219, 0.4);
            box-shadow: 0 8px 32px rgba(52, 152, 219, 0.25);
        }

        body.weather-foggy .container {
            background: rgba(149, 165, 166, 0.3);
            border: 2px solid rgba(149, 165, 166, 0.4);
            box-shadow: 0 8px 32px rgba(149, 165, 166, 0.25);
        }

        body.weather-snowy .container {
            background: rgba(236, 240, 241, 0.3);
            border: 2px solid rgba(189, 195, 199, 0.4);
            box-shadow: 0 8px 32px rgba(189, 195, 199, 0.25);
        }

        body.weather-storm .container {
            background: rgba(44, 62, 80, 0.3);
            border: 2px solid rgba(142, 68, 173, 0.4);
            box-shadow: 0 8px 32px rgba(142, 68, 173, 0.25);
        }

        body.weather-rainbow .container {
            background: rgba(255, 255, 255, 0.3);
            border: 2px solid rgba(255, 107, 107, 0.4);
            box-shadow: 0 8px 32px rgba(255, 107, 107, 0.25);
        }

        body.weather-hot .container {
            background: rgba(255, 255, 255, 0.3);
            border: 2px solid rgba(231, 76, 60, 0.4);
            box-shadow: 0 8px 32px rgba(231, 76, 60, 0.25);
        }

        body.weather-night .container {
            background: rgba(44, 62, 80, 0.3);
            border: 2px solid rgba(52, 73, 94, 0.4);
            box-shadow: 0 8px 32px rgba(52, 73, 94, 0.25);
        }

        /* Í∏∞Ï°¥ ÎÇ†Ïî®Î≥Ñ Ïª®ÌÖåÏù¥ÎÑà Ïä§ÌÉÄÏùº Ï†úÍ±∞ - ÏúÑÏóêÏÑú ÏÉàÎ°úÏö¥ Ïä§ÌÉÄÏùºÎ°ú ÎåÄÏ≤¥Îê® */

        .header {
            text-align: center;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 25px;
            transition: all 0.5s ease;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        /* ÎÇ†Ïî®Î≥Ñ Ìó§Îçî Ïä§ÌÉÄÏùº */
        body.weather-sunny .header {
            border: 2px solid #FFD700;
            background: rgba(255, 215, 0, 0.1);
        }

        body.weather-rainy .header {
            border: 2px solid #3498db;
            background: rgba(52, 152, 219, 0.1);
        }

        body.weather-foggy .header {
            border: 2px solid #95a5a6;
            background: rgba(149, 165, 166, 0.1);
        }

        body.weather-snowy .header {
            border: 2px solid #bdc3c7;
            background: rgba(189, 195, 199, 0.1);
        }

        body.weather-storm .header {
            border: 2px solid #8e44ad;
            background: rgba(142, 68, 173, 0.1);
        }

        body.weather-rainbow .header {
            border: 2px solid #ff6b6b;
            background: rgba(255, 107, 107, 0.1);
        }

        body.weather-hot .header {
            border: 2px solid #e74c3c;
            background: rgba(231, 76, 60, 0.1);
        }

        body.weather-night .header {
            border: 2px solid #34495e;
            background: rgba(52, 73, 94, 0.1);
        }

        .status-bar {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-bottom: 20px;
        }

        .sidebar-timer {
            position: fixed;
            top: 50%;
            right: 20px;
            transform: translateY(-50%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            z-index: 1000;
            width: 140px;
            height: 120px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            transition: all 0.3s ease;
            font-family: 'Orbitron', 'Courier New', monospace;
        }

        .sidebar-timer:hover {
            transform: translateY(-50%) scale(1.05);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.4);
        }

        .timer-display {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 8px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            font-family: 'Orbitron', 'Courier New', monospace;
            letter-spacing: 2px;
            width: 100%;
            text-align: center;
            min-height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .timer-label {
            font-size: 12px;
            opacity: 0.9;
            margin-bottom: 10px;
            font-weight: 500;
        }

        .auto-progress-status {
            font-size: 10px;
            opacity: 0.8;
            margin-top: 8px;
            padding: 4px 8px;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.1);
        }

        .timer-pulse {
            animation: timerPulse 2s infinite;
        }

        /* ÎÇ†Ïî®Î≥Ñ ÌÉÄÏù¥Î®∏ Ïä§ÌÉÄÏùº */
        body.weather-sunny .sidebar-timer {
            background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
            border: 2px solid #FFD700;
        }

        body.weather-rainy .sidebar-timer {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            border: 2px solid #3498db;
        }

        body.weather-foggy .sidebar-timer {
            background: linear-gradient(135deg, #95a5a6 0%, #7f8c8d 100%);
            border: 2px solid #95a5a6;
        }

        body.weather-snowy .sidebar-timer {
            background: linear-gradient(135deg, #bdc3c7 0%, #ecf0f1 100%);
            border: 2px solid #bdc3c7;
            color: #2c3e50;
        }

        body.weather-storm .sidebar-timer {
            background: linear-gradient(135deg, #8e44ad 0%, #9b59b6 100%);
            border: 2px solid #8e44ad;
        }

        body.weather-rainbow .sidebar-timer {
            background: linear-gradient(135deg, #ff6b6b 0%, #4ecdc4 50%, #45b7d1 100%);
            background-size: 200% 200%;
            animation: rainbowGradient 3s ease infinite;
            border: 2px solid #ff6b6b;
        }

        body.weather-hot .sidebar-timer {
            background: linear-gradient(135deg, #e74c3c 0%, #f39c12 100%);
            border: 2px solid #e74c3c;
        }

        body.weather-night .sidebar-timer {
            background: linear-gradient(135deg, #34495e 0%, #2c3e50 100%);
            border: 2px solid #34495e;
        }

        @keyframes rainbowGradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        @keyframes timerPulse {
            0% { box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3); }
            50% { box-shadow: 0 8px 32px rgba(255, 255, 255, 0.3); }
            100% { box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3); }
        }

        /* Î©îÎâ¥ Ïπ¥Îìú ÌÉÄÏù¥Î®∏ ÌéÑÏä§ Ìö®Í≥º */
        .menu-card.timer-pulse {
            animation: menuCardPulse 2s infinite;
        }

        @keyframes menuCardPulse {
            0% { 
                box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
                transform: scale(1);
            }
            50% { 
                box-shadow: 0 4px 16px rgba(255, 255, 255, 0.3);
                transform: scale(1.02);
            }
            100% { 
                box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
                transform: scale(1);
            }
        }

        /* Î™®Î∞îÏùº Î∞òÏùëÌòï */
        @media (max-width: 768px) {
            .sidebar-timer {
                position: fixed;
                top: 10px;
                right: 10px;
                transform: none;
                width: 120px;
                height: 100px;
                padding: 15px;
            }
            
            .sidebar-timer:hover {
                transform: none;
            }
            
            .left-sidebar, .right-sidebar {
                position: fixed;
                top: auto;
                bottom: 20px;
                transform: none;
                width: calc(50% - 30px);
                flex-direction: row;
                flex-wrap: wrap;
                gap: 10px;
            }
            
            .left-sidebar {
                left: 20px;
            }
            
            .right-sidebar {
                right: 20px;
            }
            
            .menu-card {
                width: calc(50% - 5px);
                min-width: 120px;
                padding: 15px;
            }
            
            .menu-card-icon {
                font-size: 1.5em;
            }
            
            .menu-card-title {
                font-size: 12px;
            }
            
            .menu-card-description {
                font-size: 10px;
            }
        }

        .status-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid #4CAF50;
        }

        .menu {
            display: none; /* Í∏∞Ï°¥ Î©îÎâ¥ Ïà®Í∏∞Í∏∞ */
        }

        .left-sidebar, .right-sidebar {
            position: fixed;
            top: 50%;
            transform: translateY(-50%);
            display: flex;
            flex-direction: column;
            gap: 10px;
            width: 140px;
            z-index: 1000;
        }

        .left-sidebar {
            left: 15px;
        }

        .right-sidebar {
            right: 15px;
        }

        .menu-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 12px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.2);
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
            width: 100%;
        }

        .menu-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            padding: 25px;
            text-align: center;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .menu-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.4s;
        }

        .menu-card:hover::before {
            left: 100%;
        }

        .menu-card:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
        }

        .menu-card-icon {
            font-size: 1.8em;
            margin-bottom: 8px;
            display: block;
        }

        .menu-card-title {
            font-size: 13px;
            font-weight: 600;
            color: inherit;
            margin-bottom: 4px;
        }

        .menu-card-description {
            font-size: 10px;
            color: rgba(255, 255, 255, 0.7);
            line-height: 1.3;
        }

        /* ÎÇ†Ïî®Î≥Ñ Î©îÎâ¥ Ïπ¥Îìú Ïä§ÌÉÄÏùº */
        body.weather-sunny .menu-card {
            background: rgba(255, 215, 0, 0.15);
            border-color: rgba(255, 215, 0, 0.3);
            color: #2c3e50;
        }

        body.weather-rainy .menu-card {
            background: rgba(52, 152, 219, 0.15);
            border-color: rgba(52, 152, 219, 0.3);
            color: #ecf0f1;
        }

        body.weather-foggy .menu-card {
            background: rgba(149, 165, 166, 0.15);
            border-color: rgba(149, 165, 166, 0.3);
            color: #2c3e50;
        }

        body.weather-snowy .menu-card {
            background: rgba(189, 195, 199, 0.15);
            border-color: rgba(189, 195, 199, 0.3);
            color: #2c3e50;
        }

        body.weather-storm .menu-card {
            background: rgba(142, 68, 173, 0.15);
            border-color: rgba(142, 68, 173, 0.3);
            color: #ecf0f1;
        }

        body.weather-rainbow .menu-card {
            background: rgba(255, 107, 107, 0.15);
            border-color: rgba(255, 107, 107, 0.3);
            color: #2c3e50;
        }

        body.weather-hot .menu-card {
            background: rgba(231, 76, 60, 0.15);
            border-color: rgba(231, 76, 60, 0.3);
            color: #2c3e50;
        }

        body.weather-night .menu-card {
            background: rgba(52, 73, 94, 0.15);
            border-color: rgba(52, 73, 94, 0.3);
            color: #ecf0f1;
        }

        /* Í∏∞Ï°¥ ÏÉâÏÉÅÎ≥Ñ ÌÅ¥ÎûòÏä§ Ï†úÍ±∞ - ÎÇ†Ïî®Î≥Ñ Ïä§ÌÉÄÏùºÎ°ú ÎåÄÏ≤¥Îê® */

        .shop-menu {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .slot-info, .slot-purchase {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .slot-info h3, .slot-purchase h3 {
            margin-bottom: 10px;
            color: #4CAF50;
        }

        /* Í∏∞Ï°¥ menu-item Ïä§ÌÉÄÏùº Ï†úÍ±∞ - Ïπ¥Îìú Ïä§ÌÉÄÏùºÎ°ú ÎåÄÏ≤¥Îê® */

        .content-area {
            border-radius: 15px;
            padding: 30px;
            min-height: 500px;
            transition: all 0.5s ease;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        /* ÎÇ†Ïî®Î≥Ñ ÏΩòÌÖêÏ∏† ÏòÅÏó≠ Ïä§ÌÉÄÏùº */
        body.weather-sunny .content-area {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid #FFD700;
        }

        body.weather-rainy .content-area {
            background: rgba(52, 73, 94, 0.1);
            border: 1px solid #3498db;
        }

        body.weather-foggy .content-area {
            background: rgba(149, 165, 166, 0.1);
            border: 1px solid #95a5a6;
        }

        body.weather-snowy .content-area {
            background: rgba(236, 240, 241, 0.1);
            border: 1px solid #bdc3c7;
        }

        body.weather-storm .content-area {
            background: rgba(44, 62, 80, 0.1);
            border: 1px solid #8e44ad;
        }

        body.weather-rainbow .content-area {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid #ff6b6b;
        }

        body.weather-hot .content-area {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid #e74c3c;
        }

        body.weather-night .content-area {
            background: rgba(44, 62, 80, 0.1);
            border: 1px solid #34495e;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #4CAF50;
        }

        th {
            font-weight: bold;
            transition: all 0.5s ease;
        }

        /* ÎÇ†Ïî®Î≥Ñ ÌÖåÏù¥Î∏î Ìó§Îçî Ïä§ÌÉÄÏùº */
        body.weather-sunny th {
            background: rgba(255, 215, 0, 0.3);
        }

        body.weather-rainy th {
            background: rgba(52, 152, 219, 0.3);
        }

        body.weather-foggy th {
            background: rgba(149, 165, 166, 0.3);
        }

        body.weather-snowy th {
            background: rgba(189, 195, 199, 0.3);
        }

        body.weather-storm th {
            background: rgba(142, 68, 173, 0.3);
        }

        body.weather-rainbow th {
            background: rgba(255, 107, 107, 0.3);
        }

        body.weather-hot th {
            background: rgba(231, 76, 60, 0.3);
        }

        body.weather-night th {
            background: rgba(52, 73, 94, 0.3);
        }

        .plant-slot {
            display: inline-block;
            width: 100px;
            height: 100px;
            border-radius: 20px;
            margin: 8px;
            text-align: center;
            line-height: 1.2;
            position: relative;
            transition: all 0.5s ease;
            font-size: 12px;
            padding: 5px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            vertical-align: top;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(5px);
            border: 2px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
            animation: gentleGlow 4s ease-in-out infinite;
        }

        @keyframes gentleGlow {
            0% {
                box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
                transform: scale(1);
            }
            50% {
                box-shadow: 0 6px 20px rgba(255, 255, 255, 0.2);
                transform: scale(1.02);
            }
            100% {
                box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
                transform: scale(1);
            }
        }

        #plant-slots {
            /* Ï†úÎ™©Í≥º Ïä¨Î°ØÏùÑ Î∂ÑÎ¶¨ */
        }

        .slots-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: flex-start;
            align-items: flex-start;
            gap: 8px;
            margin-top: 10px;
        }

        /* ÎÇ†Ïî®Î≥Ñ ÏãùÎ¨º Ïä¨Î°Ø Ïä§ÌÉÄÏùº */
        body.weather-sunny .plant-slot {
            background: rgba(255, 215, 0, 0.15);
            border-color: rgba(255, 215, 0, 0.4);
            animation: sunnyGlow 4s ease-in-out infinite;
        }

        body.weather-rainy .plant-slot {
            background: rgba(52, 152, 219, 0.15);
            border-color: rgba(52, 152, 219, 0.4);
            animation: rainyGlow 4s ease-in-out infinite;
        }

        body.weather-foggy .plant-slot {
            background: rgba(149, 165, 166, 0.15);
            border-color: rgba(149, 165, 166, 0.4);
            animation: foggyGlow 4s ease-in-out infinite;
        }

        body.weather-snowy .plant-slot {
            background: rgba(189, 195, 199, 0.15);
            border-color: rgba(189, 195, 199, 0.4);
            animation: snowyGlow 4s ease-in-out infinite;
        }

        body.weather-storm .plant-slot {
            background: rgba(142, 68, 173, 0.15);
            border-color: rgba(142, 68, 173, 0.4);
            animation: stormGlow 4s ease-in-out infinite;
        }

        body.weather-rainbow .plant-slot {
            background: rgba(255, 107, 107, 0.15);
            border-color: rgba(255, 107, 107, 0.4);
            animation: rainbowGlow 4s ease-in-out infinite;
        }

        body.weather-hot .plant-slot {
            background: rgba(231, 76, 60, 0.15);
            border-color: rgba(231, 76, 60, 0.4);
            animation: hotGlow 4s ease-in-out infinite;
        }

        body.weather-night .plant-slot {
            background: rgba(52, 73, 94, 0.15);
            border-color: rgba(52, 73, 94, 0.4);
            animation: nightGlow 4s ease-in-out infinite;
        }

        /* ÎÇ†Ïî®Î≥Ñ Î∂ÄÎìúÎü¨Ïö¥ Í∏ÄÎ°úÏö∞ Ïï†ÎãàÎ©îÏù¥ÏÖò */
        @keyframes sunnyGlow {
            0% {
                box-shadow: 0 4px 16px rgba(255, 215, 0, 0.2);
                transform: scale(1);
            }
            50% {
                box-shadow: 0 6px 20px rgba(255, 215, 0, 0.4);
                transform: scale(1.02);
            }
            100% {
                box-shadow: 0 4px 16px rgba(255, 215, 0, 0.2);
                transform: scale(1);
            }
        }

        @keyframes rainyGlow {
            0% {
                box-shadow: 0 4px 16px rgba(52, 152, 219, 0.2);
                transform: scale(1);
            }
            50% {
                box-shadow: 0 6px 20px rgba(52, 152, 219, 0.4);
                transform: scale(1.02);
            }
            100% {
                box-shadow: 0 4px 16px rgba(52, 152, 219, 0.2);
                transform: scale(1);
            }
        }

        @keyframes foggyGlow {
            0% {
                box-shadow: 0 4px 16px rgba(149, 165, 166, 0.2);
                transform: scale(1);
            }
            50% {
                box-shadow: 0 6px 20px rgba(149, 165, 166, 0.4);
                transform: scale(1.02);
            }
            100% {
                box-shadow: 0 4px 16px rgba(149, 165, 166, 0.2);
                transform: scale(1);
            }
        }

        @keyframes snowyGlow {
            0% {
                box-shadow: 0 4px 16px rgba(189, 195, 199, 0.2);
                transform: scale(1);
            }
            50% {
                box-shadow: 0 6px 20px rgba(189, 195, 199, 0.4);
                transform: scale(1.02);
            }
            100% {
                box-shadow: 0 4px 16px rgba(189, 195, 199, 0.2);
                transform: scale(1);
            }
        }

        @keyframes stormGlow {
            0% {
                box-shadow: 0 4px 16px rgba(142, 68, 173, 0.2);
                transform: scale(1);
            }
            50% {
                box-shadow: 0 6px 20px rgba(142, 68, 173, 0.4);
                transform: scale(1.02);
            }
            100% {
                box-shadow: 0 4px 16px rgba(142, 68, 173, 0.2);
                transform: scale(1);
            }
        }

        @keyframes rainbowGlow {
            0% {
                box-shadow: 0 4px 16px rgba(255, 107, 107, 0.2);
                transform: scale(1);
            }
            50% {
                box-shadow: 0 6px 20px rgba(255, 107, 107, 0.4);
                transform: scale(1.02);
            }
            100% {
                box-shadow: 0 4px 16px rgba(255, 107, 107, 0.2);
                transform: scale(1);
            }
        }

        @keyframes hotGlow {
            0% {
                box-shadow: 0 4px 16px rgba(231, 76, 60, 0.2);
                transform: scale(1);
            }
            50% {
                box-shadow: 0 6px 20px rgba(231, 76, 60, 0.4);
                transform: scale(1.02);
            }
            100% {
                box-shadow: 0 4px 16px rgba(231, 76, 60, 0.2);
                transform: scale(1);
            }
        }

        @keyframes nightGlow {
            0% {
                box-shadow: 0 4px 16px rgba(52, 73, 94, 0.2);
                transform: scale(1);
            }
            50% {
                box-shadow: 0 6px 20px rgba(52, 73, 94, 0.4);
                transform: scale(1.02);
            }
            100% {
                box-shadow: 0 4px 16px rgba(52, 73, 94, 0.2);
                transform: scale(1);
            }
        }

        .plant-slot.growing {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            animation: pulse 2s infinite;
        }

        .plant-slot.ready {
            background: linear-gradient(45deg, #FFD700, #FFA500);
            animation: glow 1s infinite alternate;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @keyframes glow {
            from { box-shadow: 0 0 5px #FFD700; }
            to { box-shadow: 0 0 20px #FFD700; }
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(45deg, #FFD700, #FFA500);
            color: #000;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }

        .back-button {
            background: rgba(255, 255, 255, 0.15);
            color: inherit;
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 10px 20px;
            border-radius: 12px;
            cursor: pointer;
            margin-bottom: 15px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            position: relative;
            overflow: hidden;
        }

        .back-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        .back-button:hover::before {
            left: 100%;
        }

        .back-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
            background: rgba(255, 255, 255, 0.25);
        }

        button {
            background: rgba(255, 255, 255, 0.2);
            color: inherit;
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 8px 16px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(8px);
            position: relative;
            overflow: hidden;
        }

        button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.4s;
        }

        button:hover::before {
            left: 100%;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            background: rgba(255, 255, 255, 0.3);
        }

        button:disabled {
            background: rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.5);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* ÎÇ†Ïî®Î≥Ñ Î≤ÑÌäº Ïä§ÌÉÄÏùº */
        body.weather-sunny button {
            background: rgba(255, 215, 0, 0.2);
            border-color: rgba(255, 215, 0, 0.4);
            color: #2c3e50;
        }

        body.weather-rainy button {
            background: rgba(52, 152, 219, 0.2);
            border-color: rgba(52, 152, 219, 0.4);
            color: #ecf0f1;
        }

        body.weather-foggy button {
            background: rgba(149, 165, 166, 0.2);
            border-color: rgba(149, 165, 166, 0.4);
            color: #2c3e50;
        }

        body.weather-snowy button {
            background: rgba(189, 195, 199, 0.2);
            border-color: rgba(189, 195, 199, 0.4);
            color: #2c3e50;
        }

        body.weather-storm button {
            background: rgba(142, 68, 173, 0.2);
            border-color: rgba(142, 68, 173, 0.4);
            color: #ecf0f1;
        }

        body.weather-rainbow button {
            background: rgba(255, 107, 107, 0.2);
            border-color: rgba(255, 107, 107, 0.4);
            color: #2c3e50;
        }

        body.weather-hot button {
            background: rgba(231, 76, 60, 0.2);
            border-color: rgba(231, 76, 60, 0.4);
            color: #2c3e50;
        }

        body.weather-night button {
            background: rgba(52, 73, 94, 0.2);
            border-color: rgba(52, 73, 94, 0.4);
            color: #ecf0f1;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            overflow: hidden;
            margin-top: 5px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(45deg, #4CAF50, #45a049);
            transition: width 0.3s ease;
        }

        .trend-up { color: #4CAF50; }
        .trend-down { color: #f44336; }
        .trend-neutral { color: #FFD700; }

        /* ÎÇ†Ïî®Î≥Ñ Ìä∏Î†åÎìú ÏÉâÏÉÅ */
        body.weather-sunny .trend-up { color: #FFD700; }
        body.weather-sunny .trend-down { color: #e74c3c; }
        body.weather-sunny .trend-neutral { color: #f39c12; }

        body.weather-rainy .trend-up { color: #3498db; }
        body.weather-rainy .trend-down { color: #e74c3c; }
        body.weather-rainy .trend-neutral { color: #95a5a6; }

        body.weather-foggy .trend-up { color: #95a5a6; }
        body.weather-foggy .trend-down { color: #7f8c8d; }
        body.weather-foggy .trend-neutral { color: #bdc3c7; }

        body.weather-snowy .trend-up { color: #bdc3c7; }
        body.weather-snowy .trend-down { color: #95a5a6; }
        body.weather-snowy .trend-neutral { color: #ecf0f1; }

        body.weather-storm .trend-up { color: #8e44ad; }
        body.weather-storm .trend-down { color: #e74c3c; }
        body.weather-storm .trend-neutral { color: #9b59b6; }

        body.weather-rainbow .trend-up { color: #ff6b6b; }
        body.weather-rainbow .trend-down { color: #4ecdc4; }
        body.weather-rainbow .trend-neutral { color: #feca57; }

        body.weather-hot .trend-up { color: #e74c3c; }
        body.weather-hot .trend-down { color: #f39c12; }
        body.weather-hot .trend-neutral { color: #ff7675; }

        body.weather-night .trend-up { color: #34495e; }
        body.weather-night .trend-down { color: #2c3e50; }
        body.weather-night .trend-neutral { color: #7f8c8d; }

        @media (max-width: 768px) {
            .container {
                max-width: 100vw;
                padding: 10px;
                border-radius: 0;
                margin: 0;
            }
            .header {
                padding: 10px;
                font-size: 1em;
            }
            .content-area {
                padding: 10px;
                min-height: 300px;
                font-size: 0.95em;
            }
            .left-sidebar, .right-sidebar {
                position: fixed;
                top: auto;
                bottom: 0;
                left: 0;
                right: 0;
                width: 100vw;
                flex-direction: row;
                justify-content: flex-start;
                gap: 0;
                transform: none;
                z-index: 1001;
                background: rgba(255,255,255,0.7);
                border-radius: 0;
                box-shadow: 0 -2px 12px rgba(0,0,0,0.08);
                padding: 2px 0;
                height: auto;
                min-height: 48px;
                pointer-events: auto;
                display: flex !important;
                flex-wrap: nowrap;
                overflow-x: auto;
                white-space: nowrap;
            }
            .left-sidebar {
                right: 0;
            }
            .right-sidebar {
                left: 0;
                margin-left: 0;
            }
            body {
                padding-bottom: 56px;
            }
            .menu-card {
                display: inline-block;
                min-width: 38px;
                max-width: 44px;
                width: 11vw;
                flex: 0 0 38px;
                padding: 4px 0 2px 0;
                font-size: 0.75em;
                margin: 0 1px;
                border-radius: 10px;
            }
            .menu-card-icon {
                font-size: 1.1em;
                margin-bottom: 0;
            }
            .menu-card-title {
                font-size: 9px;
                line-height: 1.1;
            }
            .menu-card-description {
                display: none;
            }
        }
        @media (max-width: 768px) {
            .content-area,
            #inventory-content,
            #plant-inventory,
            #shop-items,
            #gear-items,
            #slot-items,
            #market-prices,
            #growth-status {
                overflow-x: auto;
                max-width: 100vw;
                box-sizing: border-box;
                display: block;
            }
            table {
                display: block;
                width: 100%;
                max-width: 100vw;
                overflow-x: auto;
                white-space: nowrap;
                border-spacing: 0;
                border-collapse: separate;
            }
            th, td {
                min-width: 70px;
                box-sizing: border-box;
                padding: 6px 4px;
            }
            .shop-menu {
                display: block;
                overflow-x: auto;
                white-space: nowrap;
                max-width: 100vw;
            }
        }
    </style>
</head>
<body>
    <!-- Ï¢åÏ∏° ÏÇ¨Ïù¥ÎìúÎ∞î -->
    <div class="left-sidebar">
        <div class="menu-card" onclick="showMainMenu()">
            <span class="menu-card-icon">üè†</span>
            <div class="menu-card-title">Ïò®Ïã§Î°ú Ïù¥Îèô</div>
            <div class="menu-card-description">ÎÇòÏùò Ïò®Ïã§ÏùÑ ÌôïÏù∏ÌïòÍ≥† Í¥ÄÎ¶¨ÌïòÏÑ∏Ïöî</div>
        </div>
        
        <div class="menu-card" onclick="showPlantMenu()">
            <span class="menu-card-icon">üå±</span>
            <div class="menu-card-title">ÏãùÎ¨º Ïã¨Í∏∞</div>
            <div class="menu-card-description">Ïî®ÏïóÏùÑ Ïã¨Ïñ¥ ÏÉàÎ°úÏö¥ ÏãùÎ¨ºÏùÑ ÌÇ§Ïö∞ÏÑ∏Ïöî</div>
        </div>
        
        <div class="menu-card" onclick="showShop()">
            <span class="menu-card-icon">üõí</span>
            <div class="menu-card-title">ÏÉÅÏ†ê Î∞©Î¨∏</div>
            <div class="menu-card-description">ÏÉàÎ°úÏö¥ Ïî®ÏïóÍ≥º Í∏∞Ïñ¥Î•º Íµ¨Îß§ÌïòÏÑ∏Ïöî</div>
        </div>
        
        <div class="menu-card" onclick="showInventory()">
            <span class="menu-card-icon">üì¶</span>
            <div class="menu-card-title">Ïù∏Î≤§ÌÜ†Î¶¨</div>
            <div class="menu-card-description">Î≥¥Ïú†Ìïú ÏïÑÏù¥ÌÖúÎì§ÏùÑ ÌôïÏù∏ÌïòÏÑ∏Ïöî</div>
        </div>
    </div>

    <!-- Ïö∞Ï∏° ÏÇ¨Ïù¥ÎìúÎ∞î -->
    <div class="right-sidebar">
        <div class="menu-card" onclick="showMarketPrices()">
            <span class="menu-card-icon">üìä</span>
            <div class="menu-card-title">ÏãúÏÑ∏ ÌôïÏù∏</div>
            <div class="menu-card-description">ÌòÑÏû¨ ÏãúÏû• Í∞ÄÍ≤©ÏùÑ ÌôïÏù∏ÌïòÏÑ∏Ïöî</div>
        </div>
        
        <div class="menu-card" onclick="waitNextDay()">
            <span class="menu-card-icon">‚è≥</span>
            <div class="menu-card-title">Îã§ÏùåÎÇ† Í∏∞Îã§Î¶¨Í∏∞</div>
            <div class="menu-card-description">ÏãúÍ∞ÑÏùÑ Í±¥ÎÑàÎõ∞Ïñ¥ Îã§ÏùåÎÇ†Î°ú ÏßÑÌñâÌïòÏÑ∏Ïöî</div>
        </div>
        
        <div class="menu-card" id="timer-menu-card">
            <span class="menu-card-icon">‚è∞</span>
            <div class="menu-card-title">Îã§ÏùåÎÇ†ÍπåÏßÄ</div>
            <div class="menu-card-description" id="timer-display">--:--</div>
        </div>
        
        <div class="menu-card" onclick="checkNotificationPermission()">
            <span class="menu-card-icon">üîî</span>
            <div class="menu-card-title">ÏïåÎ¶º ÏÉÅÌÉú ÌôïÏù∏</div>
            <div class="menu-card-description">Î∏åÎùºÏö∞Ï†Ä ÏïåÎ¶º ÏÑ§Ï†ïÏùÑ ÌôïÏù∏ÌïòÏÑ∏Ïöî</div>
        </div>
    </div>

    <div class="container">
        <div class="header">
            <h1>üåø ÎßàÎ≤ï Ïò®Ïã§ Í¥ÄÎ¶¨Ïûê</h1>
            <div id="game-status">
                <div>‚Äî Day <span id="current-day">1</span> / <span id="current-time">6:00 AM</span> ‚Äî</div>
                <div>Gold: üíé <span id="player-gold">100</span></div>
                <div>Slots: <span id="used-slots">0</span>/<span id="total-slots">2</span> (Empty slots: <span id="empty-slots">0</span>)</div>
                <div>Weather: <span id="current-weather">‚òÄÔ∏è</span> <span id="weather-name">Sunny</span></div>
                <div id="weather-effect">‚òÄÔ∏è ÎßëÏùå: Ï¢ãÏùÄ ÌíàÏßà ÌôïÎ•† Ï¶ùÍ∞Ä</div>
                <div>Next Day Cost: üíé <span id="next-day-cost">10</span></div>
                <div id="active-events"></div>
            </div>
        </div>

        <div class="content-area" id="content-area">
            <h2>üåø Ïò®Ïã§Ïóê Ïò§Ïã† Í≤ÉÏùÑ ÌôòÏòÅÌï©ÎãàÎã§!</h2>
            <br>
            <div id="plant-slots"></div>
        </div>
    </div>



    <!-- Îç∞Ïù¥ÌÑ∞ Ï¥àÍ∏∞Ìôî Î≤ÑÌäº (Íµ¨ÏÑùÏóê ÏûëÍ≤å Î∞∞Ïπò) -->
    <div style="position: fixed; bottom: 20px; right: 20px; z-index: 1000;">
        <button onclick="clearGameData()" style="
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 8px 12px;
            font-size: 12px;
            cursor: pointer;
            opacity: 0.7;
            transition: opacity 0.3s ease;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
        " onmouseover="this.style.opacity='1'" onmouseout="this.style.opacity='0.7'">
            üóëÔ∏è Ï¥àÍ∏∞Ìôî
        </button>
    </div>

    <script>
        // Í≤åÏûÑ ÏÉÅÌÉú
        let gameState = {
            day: 1,
            time: '6:00 AM',
            gold: 100,
            usedSlots: 0,
            totalSlots: 2,
            emptySlots: 0,
            weather: '‚òÄÔ∏è',
            weatherName: 'Sunny',
            inventory: [], // Ïî®Ïïó Ïù∏Î≤§ÌÜ†Î¶¨
            harvestedPlants: [], // ÏàòÌôïÌïú ÏãùÎ¨º Ïù∏Î≤§ÌÜ†Î¶¨
            plantedCrops: [],
            gears: [], // Í∏∞Ïñ¥ Ïù∏Î≤§ÌÜ†Î¶¨
            lastSave: Date.now(),
            nextDayCost: 10, // Îã§ÏùåÎÇ†Î°ú ÎÑòÏñ¥Í∞ÄÎäî ÎπÑÏö©
            slotCost: 10, // Ïä¨Î°Ø Íµ¨Îß§ ÎπÑÏö©
            activeEvents: [], // ÌôúÏÑ± Ïù¥Î≤§Ìä∏ Î™©Î°ù
            lastAutoProgress: Date.now(), // ÏûêÎèô ÏßÑÌñâ ÏãúÍ∞Ñ Ï∂îÏ†Å
            autoProgressEnabled: true // ÏûêÎèô ÏßÑÌñâ ÌôúÏÑ±Ìôî Ïó¨Î∂Ä (Ìï≠ÏÉÅ ÌôúÏÑ±Ìôî)
        };

        // ÎßàÎ≤ï ÏãùÎ¨º Îç∞Ïù¥ÌÑ∞
        const plants = [
            {
                id: 'herb_sprout',
                name: 'üå± Herb Sprout',
                growTime: 10, // 10Ï¥à
                priceRange: [10, 15],
                sellRange: [12, 18],
                description: 'Í∏∞Î≥∏ ÌóàÎ∏å ÏÉàÏãπ',
                rarity: 'common',
                unlockLevel: 0,
                baseStock: 8, // Í∏∞Î≥∏ Ïû¨Í≥†
                maxStock: 12 // ÏµúÎåÄ Ïû¨Í≥†
            },
            {
                id: 'starglow_herb',
                name: 'üåü Starglow Herb',
                growTime: 30, // 30Ï¥à
                priceRange: [25, 35],
                sellRange: [30, 42],
                description: 'Î≥ÑÎπõÏù¥ ÍπÉÎì† ÌóàÎ∏å',
                rarity: 'common',
                unlockLevel: 0,
                baseStock: 6,
                maxStock: 10
            },
            {
                id: 'moonflower',
                name: 'üåô Moonflower',
                growTime: 60, // 1Î∂Ñ
                priceRange: [50, 70],
                sellRange: [60, 84],
                description: 'Îã¨ÎπõÏùÑ Ìù°ÏàòÌïòÎäî ÍΩÉ',
                rarity: 'uncommon',
                unlockLevel: 0,
                baseStock: 5,
                maxStock: 8
            },
            {
                id: 'crystal_rose',
                name: 'üíé Crystal Rose',
                growTime: 120, // 2Î∂Ñ
                priceRange: [100, 130],
                sellRange: [120, 156],
                description: 'ÏàòÏ†ïÏ≤òÎüº ÎπõÎÇòÎäî Ïû•ÎØ∏',
                rarity: 'uncommon',
                unlockLevel: 5,
                baseStock: 4,
                maxStock: 6
            },
            {
                id: 'phoenix_plant',
                name: 'üî• Phoenix Plant',
                growTime: 300, // 5Î∂Ñ
                priceRange: [200, 250],
                sellRange: [240, 300],
                description: 'Î∂àÏÇ¨Ï°∞Ïùò Î∂àÍΩÉÏùÑ Îã¥ÏùÄ ÏãùÎ¨º',
                rarity: 'rare',
                unlockLevel: 10,
                baseStock: 3,
                maxStock: 5
            },
            {
                id: 'dragon_fruit',
                name: 'üêâ Dragon Fruit',
                growTime: 600, // 10Î∂Ñ
                priceRange: [400, 500],
                sellRange: [480, 600],
                description: 'Ïö©Ïùò ÌûòÏùÑ Îã¥ÏùÄ Í≥ºÏùº',
                rarity: 'epic',
                unlockLevel: 20,
                baseStock: 4,
                maxStock: 6
            },
            {
                id: 'golden_tree',
                name: 'üå≥ Golden Tree',
                growTime: 1800, // 30Î∂Ñ
                priceRange: [800, 1000],
                sellRange: [960, 1200],
                description: 'Ìô©Í∏àÎπõ Ïó¥Îß§Î•º Îß∫Îäî ÎÇòÎ¨¥',
                rarity: 'legendary',
                unlockLevel: 35,
                baseStock: 3,
                maxStock: 5
            },
            {
                id: 'eternal_bloom',
                name: 'üå∏ Eternal Bloom',
                growTime: 3600, // 1ÏãúÍ∞Ñ
                priceRange: [1500, 2000],
                sellRange: [1800, 2400],
                description: 'ÏòÅÏõêÌûà ÌîºÏñ¥ÏûàÎäî Ïã†ÎπÑÌïú ÍΩÉ',
                rarity: 'mythic',
                unlockLevel: 50,
                baseStock: 2,
                maxStock: 4
            }
        ];

        // ÎÇ†Ïî® ÏãúÏä§ÌÖú
        const weathers = [
            { emoji: '‚òÄÔ∏è', name: 'ÎßëÏùå', effect: 'normal', class: 'weather-sunny', probability: 25 },
            { emoji: 'üåßÔ∏è', name: 'ÎπÑ', effect: 'growth_boost', class: 'weather-rainy', probability: 20 },
            { emoji: 'üåô', name: 'Îã¨Îπõ', effect: 'moonlight_bonus', class: 'weather-night', probability: 15 },
            { emoji: 'üå©Ô∏è', name: 'Î≤àÍ∞ú', effect: 'electric_charge', class: 'weather-storm', probability: 10 },
            { emoji: 'üå´Ô∏è', name: 'ÏïàÍ∞ú', effect: 'unstable_price', class: 'weather-foggy', probability: 5 },
            { emoji: 'üå™Ô∏è', name: 'Í∞ïÌíç', effect: 'wind_damage', class: 'weather-storm', probability: 5 },
            { emoji: '‚ùÑÔ∏è', name: 'ÏÑúÎ¶¨', effect: 'frost_delay', class: 'weather-snowy', probability: 5 },
            { emoji: 'üî•', name: 'Ïó¥Í∏∞', effect: 'heat_growth', class: 'weather-hot', probability: 5 },
            { emoji: 'üåà', name: 'Î¨¥ÏßÄÍ∞ú', effect: 'rainbow_rare', class: 'weather-rainbow', probability: 5 },
            { emoji: 'üåò', name: 'ÏïîÏö¥', effect: 'dark_cloud', class: 'weather-night', probability: 5 }
        ];

        // Í∞ÄÍ≤© Î≥ÄÎèô ÏãúÏä§ÌÖú
        let priceHistory = {};
        let dailyPrices = {}; // Îß§ÏùºÏùò Ïî®Ïïó Í∞ÄÍ≤©
        let dailyStock = {}; // Îß§ÏùºÏùò Ïû¨Í≥†Îüâ

        // Ïù¥Î≤§Ìä∏ ÏãúÏä§ÌÖú
        const events = [
            {
                id: 'herb_festival',
                name: 'üåø ÌóàÎ∏å Ï∂ïÏ†ú',
                description: 'ÌóàÎ∏åÎ•ò ÏãùÎ¨ºÎì§Ïùò ÏàòÏöîÍ∞Ä Í∏âÏ¶ùÌñàÏäµÎãàÎã§!',
                affectedPlants: ['herb_sprout', 'starglow_herb'],
                priceMultiplier: 3.0,
                duration: 1,
                probability: 0.05
            },
            {
                id: 'crystal_craze',
                name: 'üíé ÏàòÏ†ï Ïó¥Ìíç',
                description: 'ÏàòÏ†ï Ïû•ÎØ∏Ïùò ÏïÑÎ¶ÑÎã§ÏõÄÏù¥ ÌôîÏ†úÍ∞Ä ÎêòÏóàÏäµÎãàÎã§!',
                affectedPlants: ['crystal_rose'],
                priceMultiplier: 4.0,
                duration: 1,
                probability: 0.03
            },
            {
                id: 'phoenix_mania',
                name: 'üî• Î∂àÏÇ¨Ï°∞ Ïó¥Ìíç',
                description: 'Î∂àÏÇ¨Ï°∞ ÏãùÎ¨ºÏùò Ìù¨Í∑ÄÏÑ±Ïù¥ Ï£ºÎ™©Î∞õÍ≥† ÏûàÏäµÎãàÎã§!',
                affectedPlants: ['phoenix_plant'],
                priceMultiplier: 5.0,
                duration: 1,
                probability: 0.02
            },
            {
                id: 'dragon_fever',
                name: 'üêâ Ïö©Ïùò Ìûò Ïó¥Ìíç',
                description: 'Ïö©Í≥ºÏùºÏùò Í∞ïÎ†•Ìïú Ìö®Í≥ºÍ∞Ä ÌôîÏ†úÍ∞Ä ÎêòÏóàÏäµÎãàÎã§!',
                affectedPlants: ['dragon_fruit'],
                priceMultiplier: 4.5,
                duration: 1,
                probability: 0.02
            },
            {
                id: 'golden_boom',
                name: 'üå≥ Ìô©Í∏à ÎÇòÎ¨¥ Ïó¥Ìíç',
                description: 'Ìô©Í∏à ÎÇòÎ¨¥Ïùò Í∞ÄÏπòÍ∞Ä Í∏âÎì±ÌñàÏäµÎãàÎã§!',
                affectedPlants: ['golden_tree'],
                priceMultiplier: 6.0,
                duration: 1,
                probability: 0.01
            },
            {
                id: 'eternal_hype',
                name: 'üå∏ ÏòÅÏõêÏùò ÍΩÉ Ïó¥Ìíç',
                description: 'ÏòÅÏõêÏùò ÍΩÉÏùò Ïã†ÎπÑÎ°úÏõÄÏù¥ Ï†Ñ ÏÑ∏Í≥ÑÏóê ÏïåÎ†§Ï°åÏäµÎãàÎã§!',
                affectedPlants: ['eternal_bloom'],
                priceMultiplier: 8.0,
                duration: 1,
                probability: 0.005
            },
            {
                id: 'moonlight_madness',
                name: 'üåô Îã¨Îπõ ÏãùÎ¨º Ïó¥Ìíç',
                description: 'Îã¨ÎπõÏùÑ Î∞õÎäî ÏãùÎ¨ºÎì§Ïù¥ ÌäπÎ≥ÑÌïú Í∞ÄÏπòÎ•º Ïù∏Ï†ïÎ∞õÍ≥† ÏûàÏäµÎãàÎã§!',
                affectedPlants: ['moonflower', 'crystal_rose'],
                priceMultiplier: 2.5,
                duration: 1,
                probability: 0.04
            },
            {
                id: 'rare_plant_boom',
                name: 'üåü Ìù¨Í∑Ä ÏãùÎ¨º Ïó¥Ìíç',
                description: 'Î™®Îì† Ìù¨Í∑Ä ÏãùÎ¨ºÎì§Ïùò Í∞ÄÏπòÍ∞Ä ÏÉÅÏäπÌñàÏäµÎãàÎã§!',
                affectedPlants: ['crystal_rose', 'phoenix_plant', 'dragon_fruit', 'golden_tree', 'eternal_bloom'],
                priceMultiplier: 2.0,
                duration: 1,
                probability: 0.03
            }
        ];

        // ÏïåÎ¶º Í∂åÌïú ÏöîÏ≤≠
        function requestNotificationPermission() {
            if ('Notification' in window) {
                if (Notification.permission === 'default') {
                    Notification.requestPermission().then(permission => {
                        if (permission === 'granted') {
                            showNotification('üîî ÏïåÎ¶ºÏù¥ ÌôúÏÑ±ÌôîÎêòÏóàÏäµÎãàÎã§!');
                        } else if (permission === 'denied') {
                            showNotification('üîï ÏïåÎ¶ºÏù¥ Í±∞Î∂ÄÎêòÏóàÏäµÎãàÎã§. Î∏åÎùºÏö∞Ï†Ä ÏÑ§Ï†ïÏóêÏÑú ÌóàÏö©Ìï¥Ï£ºÏÑ∏Ïöî.');
                        }
                    });
                } else if (Notification.permission === 'granted') {
                    showNotification('üîî ÏïåÎ¶ºÏù¥ ÌôúÏÑ±ÌôîÎêòÏñ¥ ÏûàÏäµÎãàÎã§!');
                } else if (Notification.permission === 'denied') {
                    showNotification('üîï ÏïåÎ¶ºÏù¥ ÎπÑÌôúÏÑ±ÌôîÎêòÏñ¥ ÏûàÏäµÎãàÎã§. Î∏åÎùºÏö∞Ï†Ä ÏÑ§Ï†ïÏóêÏÑú ÌóàÏö©Ìï¥Ï£ºÏÑ∏Ïöî.');
                }
            }
        }

        // Ïõπ ÏïåÎ¶º ÌëúÏãú
        function showWebNotification(title, message) {
            if ('Notification' in window && Notification.permission === 'granted') {
                const notification = new Notification(title, {
                    body: message,
                    icon: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjQiIGhlaWdodD0iNjQiIHZpZXdCb3g9IjAgMCA2NCA2NCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTMyIDhDNDAuODM2NiA4IDQ4IDE1LjE2MzQgNDggMjRWMzJINjRWMjRDNjQgMTAuNzQ1MiA1My4yNTQ4IDAgNDAgMEMyNi43NDUyIDAgMTYgMTAuNzQ1MiAxNiAyNFYzMkgyNFYyNEMyNCAxNS4xNjM0IDMxLjE2MzQgOCA0MCA4WiIgZmlsbD0iIzRDRkY1MCIvPgo8cGF0aCBkPSJNNDAgNTZDNjIuMDkxNCA1NiA4MCAzOC4wOTE0IDgwIDE2SDQ4VjU2WiIgZmlsbD0iIzRDRkY1MCIvPgo8L3N2Zz4K',
                    badge: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTEyIDJMMTMuMDkgOC4yNkwyMCA5TDEzLjA5IDkuNzRMMTIgMTZMMTAuOTEgOS43NEw0IDlMMTAuOTEgOC4yNkwxMiAyWiIgZmlsbD0iI0ZGRDcwMCIvPgo8L3N2Zz4K',
                    tag: 'plant-harvest',
                    requireInteraction: true,
                    silent: false,
                    vibrate: [200, 100, 200] // ÏßÑÎèô ÏïåÎ¶º (Î™®Î∞îÏùº)
                });

                // ÏïåÎ¶º ÌÅ¥Î¶≠ Ïãú Í≤åÏûÑ ÌÉ≠ÏúºÎ°ú Ìè¨Ïª§Ïä§
                notification.onclick = function() {
                    window.focus();
                    this.close();
                };

                // 10Ï¥à ÌõÑ ÏûêÎèôÏúºÎ°ú ÏïåÎ¶º Îã´Í∏∞
                setTimeout(() => {
                    notification.close();
                }, 10000);
            }
        }

        // Í≤åÏûÑ Ï¥àÍ∏∞Ìôî
        function initGame() {
            const isLoaded = loadGameState();
            
            // Ï†ÄÏû•Îêú ÎÇ†Ïî®Í∞Ä ÏóÜÏúºÎ©¥ Í∏∞Î≥∏ ÎÇ†Ïî® ÏÑ§Ï†ï
            if (!gameState.weather || !gameState.weatherName) {
                const defaultWeather = weathers.find(w => w.emoji === '‚òÄÔ∏è');
                gameState.weather = defaultWeather.emoji;
                gameState.weatherName = defaultWeather.name;
            }
            
            // Ï†ÄÏû•Îêú ÎÇ†Ïî®Ïóê Îî∞Îùº Î∞∞Í≤Ω ÏÑ§Ï†ï
            const currentWeather = weathers.find(w => w.emoji === gameState.weather);
            if (currentWeather) {
                document.body.className = currentWeather.class;
            } else {
                // Í∏∞Î≥∏ ÎÇ†Ïî® ÏÑ§Ï†ï
                document.body.className = 'weather-sunny';
            }
            
            updateDisplay();
            renderPlantSlots();
            startGameLoop();
            startAutoSave(); // ÏûêÎèô Ï†ÄÏû• ÏãúÏûë
            
            // ÏïåÎ¶º Í∂åÌïú ÏöîÏ≤≠
            requestNotificationPermission();
            
            // Ï¥àÍ∏∞ Ï†ÄÏû•
            saveGameState();
        }

        // Í≤åÏûÑ ÏÉÅÌÉú Ï†ÄÏû• (Í∞ïÌôîÎêú Î≤ÑÏ†Ñ)
        function saveGameState() {
            const saveData = {
                ...gameState,
                dailyPrices: dailyPrices,
                dailyStock: dailyStock,
                lastSave: Date.now(),
                saveVersion: '1.0' // Îç∞Ïù¥ÌÑ∞ Î≤ÑÏ†Ñ Í¥ÄÎ¶¨
            };
            
            try {
                // Î©îÏù∏ Ï†ÄÏû•
                localStorage.setItem('magicalGreenhouse', JSON.stringify(saveData));
                
                // Î∞±ÏóÖ Ï†ÄÏû• (1Î∂Ñ Ï†Ñ Îç∞Ïù¥ÌÑ∞)
                const backupData = {
                    ...saveData,
                    isBackup: true,
                    backupTime: Date.now()
                };
                localStorage.setItem('magicalGreenhouse_backup', JSON.stringify(backupData));
                
                // Ï†ÄÏû• ÏÑ±Í≥µ Î°úÍ∑∏
                console.log('Í≤åÏûÑ Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû• ÏôÑÎ£å:', new Date().toLocaleString());
                
            } catch (error) {
                console.error('Ï†ÄÏû• Ï§ë Ïò§Î•ò Î∞úÏÉù:', error);
                showNotification('‚ö†Ô∏è Ï†ÄÏû• Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§. Î∏åÎùºÏö∞Ï†Ä Ï†ÄÏû• Í≥µÍ∞ÑÏùÑ ÌôïÏù∏Ìï¥Ï£ºÏÑ∏Ïöî.');
            }
        }

        // ÏûêÎèô Ï†ÄÏû• ÏãúÏä§ÌÖú
        function startAutoSave() {
            // 30Ï¥àÎßàÎã§ ÏûêÎèô Ï†ÄÏû•
            setInterval(() => {
                saveGameState();
            }, 30000);
            
            // Î∏åÎùºÏö∞Ï†Ä Ï¢ÖÎ£å Ïãú Ï†ÄÏû•
            window.addEventListener('beforeunload', () => {
                saveGameState();
            });
            
            // ÌéòÏù¥ÏßÄ Ïà®ÍπÄ Ïãú Ï†ÄÏû•
            document.addEventListener('visibilitychange', () => {
                if (document.hidden) {
                    saveGameState();
                }
            });
        }

        // Í≤åÏûÑ ÏÉÅÌÉú Î°úÎìú (Í∞ïÌôîÎêú Î≤ÑÏ†Ñ)
        function loadGameState() {
            try {
                // Î©îÏù∏ Îç∞Ïù¥ÌÑ∞ Î°úÎìú ÏãúÎèÑ
                const saved = localStorage.getItem('magicalGreenhouse');
                if (saved) {
                    const savedState = JSON.parse(saved);
                    
                    // Îç∞Ïù¥ÌÑ∞ Î≤ÑÏ†Ñ ÌôïÏù∏
                    if (savedState.saveVersion === '1.0') {
                        gameState = { ...gameState, ...savedState };
                        
                        // Ï†ÄÏû•Îêú Í∞ÄÍ≤© Îç∞Ïù¥ÌÑ∞ Î°úÎìú
                        if (savedState.dailyPrices) {
                            dailyPrices = savedState.dailyPrices;
                        }
                        
                        // Ï†ÄÏû•Îêú Ïû¨Í≥† Îç∞Ïù¥ÌÑ∞ Î°úÎìú
                        if (savedState.dailyStock) {
                            dailyStock = savedState.dailyStock;
                        }
                        
                        console.log('Í≤åÏûÑ Îç∞Ïù¥ÌÑ∞ Î°úÎìú ÏôÑÎ£å:', new Date().toLocaleString());
                        showNotification('‚úÖ Í≤åÏûÑ Îç∞Ïù¥ÌÑ∞Î•º ÏÑ±Í≥µÏ†ÅÏúºÎ°ú Î°úÎìúÌñàÏäµÎãàÎã§!');
                        return true;
                    }
                }
                
                // Î∞±ÏóÖ Îç∞Ïù¥ÌÑ∞ Î°úÎìú ÏãúÎèÑ
                const backup = localStorage.getItem('magicalGreenhouse_backup');
                if (backup) {
                    const backupState = JSON.parse(backup);
                    gameState = { ...gameState, ...backupState };
                    
                    if (backupState.dailyPrices) {
                        dailyPrices = backupState.dailyPrices;
                    }
                    
                    if (backupState.dailyStock) {
                        dailyStock = backupState.dailyStock;
                    }
                    
                    console.log('Î∞±ÏóÖ Îç∞Ïù¥ÌÑ∞ Î°úÎìú ÏôÑÎ£å:', new Date().toLocaleString());
                    showNotification('‚ö†Ô∏è Î∞±ÏóÖ Îç∞Ïù¥ÌÑ∞Î•º Î°úÎìúÌñàÏäµÎãàÎã§. ÏùºÎ∂Ä ÏßÑÌñâ ÏÉÅÌô©Ïù¥ ÏÜêÏã§ÎêòÏóàÏùÑ Ïàò ÏûàÏäµÎãàÎã§.');
                    return true;
                }
                
                // ÏÉà Í≤åÏûÑ ÏãúÏûë
                console.log('ÏÉà Í≤åÏûÑ ÏãúÏûë:', new Date().toLocaleString());
                showNotification('üå± ÏÉàÎ°úÏö¥ Ïò®Ïã§ÏùÑ ÏãúÏûëÌï©ÎãàÎã§!');
                return false;
                
            } catch (error) {
                console.error('Îç∞Ïù¥ÌÑ∞ Î°úÎìú Ï§ë Ïò§Î•ò Î∞úÏÉù:', error);
                showNotification('‚ùå Îç∞Ïù¥ÌÑ∞ Î°úÎìú Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§. ÏÉà Í≤åÏûÑÏùÑ ÏãúÏûëÌï©ÎãàÎã§.');
                return false;
            }
        }

        // ÎÇ†Ïî® Ìö®Í≥º ÏÑ§Î™Ö Í∞ÄÏ†∏Ïò§Í∏∞
        function getWeatherEffectDescription(weatherEmoji) {
            const weatherEffects = {
                '‚òÄÔ∏è': 'Ï¢ãÏùÄ ÌíàÏßà ÌôïÎ•† Ï¶ùÍ∞Ä (+10%)',
                'üåßÔ∏è': 'ÏÑ±Ïû• ÏÜçÎèÑ 50% Ï¶ùÍ∞Ä, Ï¢ãÏùÄ ÌíàÏßà ÌôïÎ•† Ï¶ùÍ∞Ä (+15%)',
                'üåô': 'ÌåêÎß§Í∞Ä 2Î∞∞ Ìö®Í≥º (20% ÌôïÎ•†), Ï¢ãÏùÄ ÌíàÏßà ÌôïÎ•† Ï¶ùÍ∞Ä (+20%)',
                'üå©Ô∏è': 'ÌåêÎß§Í∞Ä 3Î∞∞ Ìö®Í≥º (15% ÌôïÎ•†), Ï¢ãÏùÄ ÌíàÏßà ÌôïÎ•† Ï¶ùÍ∞Ä (+25%)',
                'üå´Ô∏è': 'ÏàòÌôïÍ∞Ä Î∂àÏïàÏ†ï (50~150%), ÌíàÏßà ÌôïÎ•† Í∞êÏÜå (-10%)',
                'üå™Ô∏è': 'ÏûëÎ¨º ÏÜêÏã§ ÏúÑÌóò (25% ÌôïÎ•†), ÌíàÏßà ÌôïÎ•† Í∞êÏÜå (-15%)',
                '‚ùÑÔ∏è': 'ÏÑ±Ïû• Ï†ïÏßÄ, Î≥¥Ï°¥ Í∏∞Í∞Ñ 1Ïùº Ï¶ùÍ∞Ä, ÌíàÏßà ÌôïÎ•† Í∞êÏÜå (-5%)',
                'üî•': 'ÏÑ±Ïû• ÏÜçÎèÑ 2Î∞∞, ÏãúÎì§ ÏúÑÌóò, Ï¢ãÏùÄ ÌíàÏßà ÌôïÎ•† Ï¶ùÍ∞Ä (+15%)',
                'üåà': 'Ìù¨Í∑ÄÏÑ± Î∂ÄÏó¨ (ÌåêÎß§Í∞Ä+40%, ÏÑ±Ïû•+20%), Ï¢ãÏùÄ ÌíàÏßà ÌôïÎ•† Ï¶ùÍ∞Ä (+30%)',
                'üåò': 'Î≥µÌï© Ìö®Í≥º, Ï¢ãÏùÄ ÌíàÏßà ÌôïÎ•† Ï¶ùÍ∞Ä (+5%)'
            };
            return weatherEffects[weatherEmoji] || 'Ìö®Í≥º ÏóÜÏùå';
        }

        // ÌôîÎ©¥ ÏóÖÎç∞Ïù¥Ìä∏
        function updateDisplay() {
            document.getElementById('current-day').textContent = gameState.day;
            document.getElementById('current-time').textContent = gameState.time;
            document.getElementById('player-gold').textContent = gameState.gold;
            document.getElementById('used-slots').textContent = gameState.usedSlots;
            document.getElementById('total-slots').textContent = gameState.totalSlots;
            document.getElementById('empty-slots').textContent = gameState.emptySlots;
            document.getElementById('current-weather').textContent = gameState.weather;
            document.getElementById('weather-name').textContent = gameState.weatherName;
            document.getElementById('next-day-cost').textContent = gameState.nextDayCost;
            
            // ÎÇ†Ïî® Ìö®Í≥º ÌëúÏãú
            const weatherEffect = getWeatherEffectDescription(gameState.weather);
            document.getElementById('weather-effect').textContent = `${gameState.weather} ${gameState.weatherName}: ${weatherEffect}`;
            
            // ÌôúÏÑ± Ïù¥Î≤§Ìä∏ ÌëúÏãú
            const activeEventsDiv = document.getElementById('active-events');
            if (gameState.activeEvents.length > 0) {
                let eventsHtml = '<div style="margin-top: 10px; padding: 8px; background: rgba(255, 107, 107, 0.2); border-radius: 5px; border: 1px solid #FF6B6B;">';
                eventsHtml += '<strong>üéâ ÌôúÏÑ± Ïù¥Î≤§Ìä∏:</strong><br>';
                gameState.activeEvents.forEach(event => {
                    const remainingDays = event.endDay - gameState.day;
                    eventsHtml += `‚Ä¢ ${event.name} (${remainingDays}Ïùº ÎÇ®Ïùå)<br>`;
                });
                eventsHtml += '</div>';
                activeEventsDiv.innerHTML = eventsHtml;
            } else {
                activeEventsDiv.innerHTML = '';
            }
            
            // ÌÉÄÏù¥Î®∏ ÏóÖÎç∞Ïù¥Ìä∏
            updateTimer();
            
            // ÏûêÎèô ÏßÑÌñâ ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
            updateAutoProgressStatus();
            
            // ÌÉÄÏù¥Î®∏ ÎÇ†Ïî® Ïä§ÌÉÄÏùº ÏóÖÎç∞Ïù¥Ìä∏
            updateTimerWeatherStyle();
        }

        // ÏãúÍ∞Ñ Ìè¨Îß∑ÌåÖ Ìï®Ïàò
        function formatTime(seconds) {
            if (seconds < 60) {
                return `${seconds}Ï¥à`;
            } else if (seconds < 3600) {
                const minutes = Math.floor(seconds / 60);
                const remainingSeconds = seconds % 60;
                return remainingSeconds > 0 ? `${minutes}Î∂Ñ ${remainingSeconds}Ï¥à` : `${minutes}Î∂Ñ`;
            } else {
                const hours = Math.floor(seconds / 3600);
                const remainingMinutes = Math.floor((seconds % 3600) / 60);
                return remainingMinutes > 0 ? `${hours}ÏãúÍ∞Ñ ${remainingMinutes}Î∂Ñ` : `${hours}ÏãúÍ∞Ñ`;
            }
        }

        // ÏãùÎ¨º Ïä¨Î°Ø Î†åÎçîÎßÅ
        function renderPlantSlots() {
            const slotsContainer = document.getElementById('plant-slots');
            slotsContainer.innerHTML = '<h3>üå± ÎÇòÏùò Ïò®Ïã§:</h3><div class="slots-container"></div>';
            
            const slotsInnerContainer = slotsContainer.querySelector('.slots-container');
            
            for (let i = 0; i < gameState.totalSlots; i++) {
                const slot = document.createElement('div');
                slot.className = 'plant-slot';
                
                const plantedCrop = gameState.plantedCrops[i];
                if (plantedCrop) {
                    const plant = plants.find(p => p.id === plantedCrop.plantId);
                    const progress = (Date.now() - plantedCrop.plantTime) / (plant.growTime * 1000);
                    
                    if (progress >= 1) {
                        slot.className = 'plant-slot ready';
                        slot.innerHTML = `${plant.name}<br><small>ÏàòÌôï Í∞ÄÎä•!</small>`;
                    } else {
                        slot.className = 'plant-slot growing';
                        const remainingTime = Math.max(0, plant.growTime - (Date.now() - plantedCrop.plantTime) / 1000);
                        slot.innerHTML = `${plant.name}<br><small>${Math.round(progress * 100)}% ‚Ä¢ ${formatTime(Math.ceil(remainingTime))}</small>`;
                    }
                } else {
                    slot.innerHTML = 'üå±<br><small>Îπà Ïä¨Î°Ø</small>';
                }
                
                slot.onclick = () => handleSlotClick(i);
                slotsInnerContainer.appendChild(slot);
            }
        }

        // Ïä¨Î°Ø ÌÅ¥Î¶≠ Ï≤òÎ¶¨
        function handleSlotClick(slotIndex) {
            const plantedCrop = gameState.plantedCrops[slotIndex];
            if (plantedCrop) {
                const plant = plants.find(p => p.id === plantedCrop.plantId);
                const progress = (Date.now() - plantedCrop.plantTime) / (plant.growTime * 1000);
                
                if (progress >= 1) {
                    harvestPlant(slotIndex);
                } else {
                    // Í∏∞Ïñ¥ ÏÇ¨Ïö© Î©îÎâ¥ ÌëúÏãú
                    showGearMenu(slotIndex, plantedCrop, plant);
                }
            } else {
                showPlantMenu();
            }
        }

        // Í∏∞Ïñ¥ ÏÇ¨Ïö© Î©îÎâ¥
        function showGearMenu(slotIndex, plantedCrop, plant) {
            const remainingTime = Math.max(0, plant.growTime - (Date.now() - plantedCrop.plantTime) / 1000);
            const progress = (Date.now() - plantedCrop.plantTime) / (plant.growTime * 1000);
            
            const contentArea = document.getElementById('content-area');
            contentArea.innerHTML = `
                <button class="back-button" onclick="showMainMenu()">‚Üê Îí§Î°ú Í∞ÄÍ∏∞</button>
                <h2>üå± ${plant.name} Í¥ÄÎ¶¨</h2>
                <p>ÏÑ±Ïû•Î•†: ${Math.round(progress * 100)}% (${formatTime(Math.ceil(remainingTime))} ÎÇ®Ïùå)</p>
                <div id="gear-menu"></div>
            `;
            
            renderGearMenu(slotIndex, plantedCrop, plant);
        }

        // Í∏∞Ïñ¥ Î©îÎâ¥ Î†åÎçîÎßÅ
        function renderGearMenu(slotIndex, plantedCrop, plant) {
            const gearMenu = document.getElementById('gear-menu');
            
            if (gameState.gears.length === 0) {
                gearMenu.innerHTML = `
                    <p>Î≥¥Ïú†Ìïú Í∏∞Ïñ¥Í∞Ä ÏóÜÏäµÎãàÎã§.</p>
                    <p>ÏÉÅÏ†êÏóêÏÑú Í∏∞Ïñ¥Î•º Íµ¨Îß§ÌïòÏó¨ ÏÑ±Ïû•ÏùÑ Í∞ÄÏÜçÌôîÌï† Ïàò ÏûàÏäµÎãàÎã§!</p>
                `;
                return;
            }
            
            let html = '<h3>‚öôÔ∏è ÏÇ¨Ïö© Í∞ÄÎä•Ìïú Í∏∞Ïñ¥</h3><table><tr><th>Í∏∞Ïñ¥</th><th>ÏàòÎüâ</th><th>Ìö®Í≥º</th><th>Ïï°ÏÖò</th></tr>';
            
            gameState.gears.forEach(gear => {
                html += `
                    <tr>
                        <td>${gear.name}</td>
                        <td>${gear.count}Í∞ú</td>
                        <td>${gear.effect}</td>
                        <td><button onclick="useGear('${gear.id}', ${slotIndex})" ${gear.count <= 0 ? 'disabled' : ''}>ÏÇ¨Ïö©</button></td>
                    </tr>
                `;
            });
            
            html += '</table>';
            gearMenu.innerHTML = html;
        }

        // Í∏∞Ïñ¥ ÏÇ¨Ïö©
        function useGear(gearId, slotIndex) {
            const gear = gameState.gears.find(g => g.id === gearId);
            const plantedCrop = gameState.plantedCrops[slotIndex];
            const plant = plants.find(p => p.id === plantedCrop.plantId);
            
            if (!gear || gear.count <= 0) {
                showNotification('‚ùå ÏÇ¨Ïö©Ìï† Ïàò ÏûàÎäî Í∏∞Ïñ¥Í∞Ä ÏóÜÏäµÎãàÎã§!');
                return;
            }
            
            // Í∏∞Ïñ¥ Ìö®Í≥º Ï†ÅÏö©
            let growthBoost = 0;
            switch (gearId) {
                case 'water_sprinkler':
                    growthBoost = 0.1; // 10% ÏÑ±Ïû• Í∞ÄÏÜç
                    break;
                case 'sunlight_lamp':
                    growthBoost = 0.2; // 20% ÏÑ±Ïû• Í∞ÄÏÜç
                    break;
                case 'magic_fertilizer':
                    growthBoost = 0.3; // 30% ÏÑ±Ïû• Í∞ÄÏÜç
                    break;
                case 'time_accelerator':
                    growthBoost = 0.5; // 50% ÏÑ±Ïû• Í∞ÄÏÜç
                    break;
            }
            
            // ÏÑ±Ïû• ÏãúÍ∞Ñ Îã®Ï∂ï
            const timeReduction = plant.growTime * growthBoost;
            plantedCrop.plantTime -= timeReduction * 1000; // Î∞ÄÎ¶¨Ï¥à Îã®ÏúÑÎ°ú Î≥ÄÌôò
            
            // Í∏∞Ïñ¥ ÏÇ¨Ïö©
            gear.count--;
            if (gear.count <= 0) {
                gameState.gears = gameState.gears.filter(g => g.id !== gearId);
            }
            
            const remainingTime = Math.max(0, plant.growTime - (Date.now() - plantedCrop.plantTime) / 1000);
            showNotification(`‚öôÔ∏è ${gear.name}ÏùÑ(Î•º) ÏÇ¨Ïö©ÌñàÏäµÎãàÎã§! ${plant.name}Ïùò ÏÑ±Ïû•Ïù¥ Í∞ÄÏÜçÌôîÎêòÏóàÏäµÎãàÎã§! (${formatTime(Math.ceil(remainingTime))} ÎÇ®Ïùå)`);
            
            updateDisplay();
            renderPlantSlots();
            saveGameState();
        }

        // ÏãùÎ¨º ÏàòÌôï
        function harvestPlant(slotIndex) {
            const plantedCrop = gameState.plantedCrops[slotIndex];
            const plant = plants.find(p => p.id === plantedCrop.plantId);
            
            // ÌíàÏßà Í≥ÑÏÇ∞ (ÎÇ†Ïî®ÏôÄ ÏãúÍ∞ÑÏóê Îî∞Î•∏ ÌíàÏßà Î≥ÄÌôî)
            let quality = 'normal';
            const random = Math.random();
            
            // ÎÇ†Ïî®Ïóê Îî∞Î•∏ ÌíàÏßà Î≥¥ÎÑàÏä§ (ÏÉàÎ°úÏö¥ ÏãúÏä§ÌÖú)
            const weatherBonus = {
                '‚òÄÔ∏è': 0.1, // ÎßëÏùå - Ï¢ãÏùÄ ÌíàÏßà ÌôïÎ•† Ï¶ùÍ∞Ä
                'üåßÔ∏è': 0.15, // ÎπÑ - ÏÑ±Ïû• ÏÜçÎèÑ +50% Ìö®Í≥º
                'üåô': 0.2, // Îã¨Îπõ - ÌåêÎß§Í∞Ä 2Î∞∞ Ìö®Í≥º
                'üå©Ô∏è': 0.25, // Î≤àÍ∞ú - ÌåêÎß§Í∞Ä 3Î∞∞ Ìö®Í≥º
                'üå´Ô∏è': -0.1, // ÏïàÍ∞ú - ÏàòÌôïÍ∞Ä Î∂àÏïàÏ†ï
                'üå™Ô∏è': -0.15, // Í∞ïÌíç - ÏûëÎ¨º ÏÜêÏã§ ÏúÑÌóò
                '‚ùÑÔ∏è': -0.05, // ÏÑúÎ¶¨ - ÏÑ±Ïû• Ï†ïÏßÄ
                'üî•': 0.15, // Ïó¥Í∏∞ - ÏÑ±Ïû• ÏÜçÎèÑ 2Î∞∞
                'üåà': 0.3, // Î¨¥ÏßÄÍ∞ú - Ìù¨Í∑ÄÏÑ± Î∂ÄÏó¨
                'üåò': 0.05 // ÏïîÏö¥ - Î≥µÌï© Ìö®Í≥º
            };
            
            const currentWeather = gameState.weather;
            const weatherModifier = weatherBonus[currentWeather] || 0;
            
            // ÏàòÏ†ïÎêú ÌôïÎ•†Î°ú ÌíàÏßà Í≤∞Ï†ï (Î≥¥ÌÜµ ÌíàÏßà ÎπÑÏ§ë Ï¶ùÍ∞Ä)
            const adjustedRandom = random + weatherModifier;
            
            if (adjustedRandom > 0.9) {
                quality = 'perfect';
            } else if (adjustedRandom > 0.75) {
                quality = 'good';
            } else {
                quality = 'normal';
            }
            
            // ÌäπÎ≥Ñ Ìö®Í≥º Ï†ÅÏö©
            let specialEffect = '';
            switch (currentWeather) {
                case 'üåô': // Îã¨Îπõ
                    if (Math.random() < 0.2) {
                        specialEffect = ' (Îã¨Îπõ Ìö®Í≥º: ÌåêÎß§Í∞Ä 2Î∞∞)';
                    }
                    break;
                case 'üå©Ô∏è': // Î≤àÍ∞ú
                    if (Math.random() < 0.15) {
                        specialEffect = ' (Î≤àÍ∞ú Ï∂©Ï†Ñ: ÌåêÎß§Í∞Ä 3Î∞∞)';
                    }
                    break;
                case 'üåà': // Î¨¥ÏßÄÍ∞ú
                    specialEffect = ' (Î¨¥ÏßÄÍ∞ú Ìö®Í≥º: Ìù¨Í∑ÄÏÑ± Î∂ÄÏó¨)';
                    break;
            }
            
            // ÏàòÌôïÌïú ÏãùÎ¨ºÏùÑ Ïù∏Î≤§ÌÜ†Î¶¨Ïóê Ï∂îÍ∞Ä
            gameState.harvestedPlants.push({
                plantId: plantedCrop.plantId,
                harvestTime: Date.now(),
                quality: quality,
                specialEffect: specialEffect
            });
            
            gameState.plantedCrops.splice(slotIndex, 1);
            gameState.usedSlots--;
            
            const qualityEmoji = quality === 'perfect' ? '‚ú®' : quality === 'good' ? '‚≠ê' : 'üå±';
            const qualityText = quality === 'perfect' ? 'ÏôÑÎ≤Ω' : quality === 'good' ? 'Ï¢ãÏùå' : 'Î≥¥ÌÜµ';
            
            showNotification(`üå± ${plant.name} (${qualityEmoji} ${qualityText})ÏùÑ(Î•º) ÏàòÌôïÌñàÏäµÎãàÎã§!${specialEffect} Ïù∏Î≤§ÌÜ†Î¶¨Ïóê Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§.`);
            updateDisplay();
            renderPlantSlots();
            saveGameState();
        }

        // ÏãùÎ¨º Ïã¨Í∏∞ Î©îÎâ¥
        function showPlantMenu() {
            const contentArea = document.getElementById('content-area');
            contentArea.innerHTML = `
                <button class="back-button" onclick="showMainMenu()">‚Üê Îí§Î°ú Í∞ÄÍ∏∞</button>
                <h2>üå± ÏãùÎ¨º Ïã¨Í∏∞</h2>
                <p>Ïù∏Î≤§ÌÜ†Î¶¨ÏóêÏÑú Ïã¨ÏùÑ ÏãùÎ¨ºÏùÑ ÏÑ†ÌÉùÌïòÏÑ∏Ïöî.</p>
                <div id="plant-inventory"></div>
            `;
            
            renderPlantInventory();
        }

        // Ïã¨Í∏∞Ïö© Ïù∏Î≤§ÌÜ†Î¶¨ Î†åÎçîÎßÅ
        function renderPlantInventory() {
            const plantInventory = document.getElementById('plant-inventory');
            if (gameState.inventory.length === 0) {
                plantInventory.innerHTML = '<p>Ïî®ÏïóÏù¥ ÏóÜÏäµÎãàÎã§. ÏÉÅÏ†êÏóêÏÑú Ïî®ÏïóÏùÑ Íµ¨Îß§ÌïòÏÑ∏Ïöî!</p>';
                return;
            }
            
            let html = '<table><tr><th>ÏãùÎ¨º</th><th>ÏàòÎüâ</th><th>Ïï°ÏÖò</th></tr>';
            
            const inventoryCount = {};
            gameState.inventory.forEach(item => {
                inventoryCount[item] = (inventoryCount[item] || 0) + 1;
            });
            
            Object.entries(inventoryCount).forEach(([plantId, count]) => {
                const plant = plants.find(p => p.id === plantId);
                html += `
                    <tr>
                        <td>${plant.name}</td>
                        <td>${count}</td>
                        <td><button onclick="plantSeed('${plantId}')" ${gameState.usedSlots >= gameState.totalSlots ? 'disabled' : ''}>Ïã¨Í∏∞</button></td>
                    </tr>
                `;
            });
            
            html += '</table>';
            plantInventory.innerHTML = html;
        }

        // Ïù∏Î≤§ÌÜ†Î¶¨ ÌëúÏãú
        function showInventory() {
            const contentArea = document.getElementById('content-area');
            contentArea.innerHTML = `
                <button class="back-button" onclick="showMainMenu()">‚Üê Îí§Î°ú Í∞ÄÍ∏∞</button>
                <h2>üì¶ Ïù∏Î≤§ÌÜ†Î¶¨</h2>
                <br>
                <div id="inventory-content"></div>
            `;
            
            renderInventory();
        }

        // Ïù∏Î≤§ÌÜ†Î¶¨ Î†åÎçîÎßÅ
        function renderInventory() {
            const inventoryContent = document.getElementById('inventory-content');
            
            // Ïî®Ïïó Ïù∏Î≤§ÌÜ†Î¶¨
            let seedHtml = '<h3>üå± Ïî®Ïïó Ïù∏Î≤§ÌÜ†Î¶¨</h3>';
            if (gameState.inventory.length === 0) {
                seedHtml += '<p>Ïî®ÏïóÏù¥ ÏóÜÏäµÎãàÎã§. ÏÉÅÏ†êÏóêÏÑú Ïî®ÏïóÏùÑ Íµ¨Îß§ÌïòÏÑ∏Ïöî!</p>';
            } else {
                seedHtml += '<table><tr><th>ÏãùÎ¨º</th><th>ÏàòÎüâ</th><th>Ïï°ÏÖò</th></tr>';
                
                const inventoryCount = {};
                gameState.inventory.forEach(item => {
                    inventoryCount[item] = (inventoryCount[item] || 0) + 1;
                });
                
                Object.entries(inventoryCount).forEach(([plantId, count]) => {
                    const plant = plants.find(p => p.id === plantId);
                    seedHtml += `
                        <tr>
                            <td>${plant.name}</td>
                            <td>${count}</td>
                            <td><button onclick="plantSeed('${plantId}')" ${gameState.usedSlots >= gameState.totalSlots ? 'disabled' : ''}>Ïã¨Í∏∞</button></td>
                        </tr>
                    `;
                });
                
                seedHtml += '</table>';
            }
            
            // ÏàòÌôïÌïú ÏãùÎ¨º Ïù∏Î≤§ÌÜ†Î¶¨
            let harvestedHtml = '<h3>üå∏ ÏàòÌôïÌïú ÏãùÎ¨º</h3>';
            if (gameState.harvestedPlants.length === 0) {
                harvestedHtml += '<p>ÏàòÌôïÌïú ÏãùÎ¨ºÏù¥ ÏóÜÏäµÎãàÎã§.</p>';
            } else {
                harvestedHtml += '<table><tr><th>ÏãùÎ¨º</th><th>ÏàòÎüâ</th><th>ÌíàÏßà</th><th>ÌòÑÏû¨ ÌåêÎß§Í∞Ä</th><th>Íµ¨Îß§Í∞Ä</th><th>Ïï°ÏÖò</th></tr>';
                
                const harvestedCount = {};
                gameState.harvestedPlants.forEach(plant => {
                    if (!harvestedCount[plant.plantId]) {
                        harvestedCount[plant.plantId] = { count: 0, quality: plant.quality };
                    }
                    harvestedCount[plant.plantId].count++;
                });
                
                Object.entries(harvestedCount).forEach(([plantId, data]) => {
                    const plant = plants.find(p => p.id === plantId);
                    const qualityEmoji = data.quality === 'perfect' ? '‚ú®' : data.quality === 'good' ? '‚≠ê' : 'üå±';
                    const qualityText = data.quality === 'perfect' ? 'ÏôÑÎ≤Ω' : data.quality === 'good' ? 'Ï¢ãÏùå' : 'Î≥¥ÌÜµ';
                    const currentSellPrice = getCurrentSellPrice(plant);
                    const qualityPrice = getQualityPrice(currentSellPrice, data.quality, data.specialEffect || '');
                    const eventPrice = getEventPrice(qualityPrice, plantId);
                    const buyPrice = (plant.priceRange[0] + plant.priceRange[1]) / 2; // ÌèâÍ∑† Íµ¨Îß§Í∞Ä
                    
                    let effectText = '';
                    if (data.specialEffect) {
                        effectText = `<br><small style="color: #FFD700;">${data.specialEffect}</small>`;
                    }
                    
                    // Ïù¥Î≤§Ìä∏ Î≥¥ÎÑàÏä§ ÌëúÏãú
                    let eventBonusText = '';
                    if (eventPrice > qualityPrice) {
                        eventBonusText = `<br><small style="color: #FF6B6B; font-weight: bold;">üéâ Ïù¥Î≤§Ìä∏ Î≥¥ÎÑàÏä§: +${eventPrice - qualityPrice}</small>`;
                    }
                    
                    harvestedHtml += `
                        <tr>
                            <td>${plant.name}${effectText}</td>
                            <td>${data.count}</td>
                            <td>${qualityEmoji} ${qualityText}</td>
                            <td>üíé ${eventPrice}${eventBonusText}</td>
                            <td>üíé ${Math.floor(buyPrice)}</td>
                            <td><button onclick="sellPlant('${plantId}')">ÌåêÎß§</button></td>
                        </tr>
                    `;
                });
                
                harvestedHtml += '</table>';
            }
            
            // Í∏∞Ïñ¥ Ïù∏Î≤§ÌÜ†Î¶¨
            let gearHtml = '<h3>‚öôÔ∏è Í∏∞Ïñ¥</h3>';
            if (gameState.gears.length === 0) {
                gearHtml += '<p>Î≥¥Ïú†Ìïú Í∏∞Ïñ¥Í∞Ä ÏóÜÏäµÎãàÎã§.</p>';
            } else {
                gearHtml += '<table><tr><th>Í∏∞Ïñ¥</th><th>ÏàòÎüâ</th><th>Ìö®Í≥º</th></tr>';
                
                gameState.gears.forEach(gear => {
                    gearHtml += `
                        <tr>
                            <td>${gear.name}</td>
                            <td>${gear.count}Í∞ú</td>
                            <td>${gear.effect}</td>
                        </tr>
                    `;
                });
                
                gearHtml += '</table>';
            }
            
            inventoryContent.innerHTML = seedHtml + '<br>' + harvestedHtml + '<br>' + gearHtml;
        }

        // Ïî®Ïïó Ïã¨Í∏∞
        function plantSeed(plantId) {
            if (gameState.usedSlots >= gameState.totalSlots) {
                showNotification('‚ùå Îçî Ïù¥ÏÉÅ Ïã¨ÏùÑ Ïä¨Î°ØÏù¥ ÏóÜÏäµÎãàÎã§!');
                return;
            }
            
            const plantIndex = gameState.inventory.indexOf(plantId);
            if (plantIndex === -1) {
                showNotification('‚ùå Ìï¥Îãπ Ïî®ÏïóÏù¥ Ïù∏Î≤§ÌÜ†Î¶¨Ïóê ÏóÜÏäµÎãàÎã§!');
                return;
            }
            
            gameState.inventory.splice(plantIndex, 1);
            gameState.plantedCrops.push({
                plantId: plantId,
                plantTime: Date.now()
            });
            gameState.usedSlots++;
            
            const plant = plants.find(p => p.id === plantId);
            showNotification(`üå± ${plant.name}ÏùÑ(Î•º) Ïã¨ÏóàÏäµÎãàÎã§!`);
            
            updateDisplay();
            renderPlantSlots();
            
            // Ï¶âÏãú ÌòÑÏû¨ ÌôîÎ©¥ ÏóÖÎç∞Ïù¥Ìä∏ (ÌòÑÏû¨ ÌôîÎ©¥Ïóê ÎßûÍ≤å Í∞ïÏ†ú ÏóÖÎç∞Ïù¥Ìä∏)
            const currentContent = document.getElementById('content-area').innerHTML;
            
            // ÌòÑÏû¨ ÌôîÎ©¥Ïù¥ Ïù∏Î≤§ÌÜ†Î¶¨Ïù∏ Í≤ΩÏö∞
            if (currentContent.includes('üì¶ Ïù∏Î≤§ÌÜ†Î¶¨')) {
                renderInventory();
            }
            // ÌòÑÏû¨ ÌôîÎ©¥Ïù¥ ÏãùÎ¨º Ïã¨Í∏∞Ïù∏ Í≤ΩÏö∞
            else if (currentContent.includes('ÏãùÎ¨º Ïã¨Í∏∞')) {
                renderPlantInventory();
            }
            // Îëò Îã§ ÏóÖÎç∞Ïù¥Ìä∏ (ÏïàÏ†ÑÏû•Ïπò)
            else {
                renderInventory();
                renderPlantInventory();
            }
            
            saveGameState();
        }

        // ÏÉÅÏ†ê Î©îÎâ¥ ÌëúÏãú
        function showShop() {
            const contentArea = document.getElementById('content-area');
            contentArea.innerHTML = `
                <button class="back-button" onclick="showMainMenu()">‚Üê Îí§Î°ú Í∞ÄÍ∏∞</button>
                <h2>üõí ÎßàÎ≤ï ÏÉÅÏ†ê</h2>
                <p>Ïñ¥Îñ§ ÏÉÅÏ†êÏùÑ Î∞©Î¨∏ÌïòÏãúÍ≤†ÏäµÎãàÍπå?</p>
                <div class="shop-menu">
                    <div class="menu-card" onclick="showSeedShop()">
                        <span class="menu-card-icon">üå∏</span>
                        <div class="menu-card-title">Ïî®Ïïó ÏÉÅÏ†ê</div>
                        <div class="menu-card-description">Îã§ÏñëÌïú ÎßàÎ≤ï Ïî®ÏïóÏùÑ Íµ¨Îß§ÌïòÏÑ∏Ïöî</div>
                    </div>
                    <div class="menu-card" onclick="showGearShop()">
                        <span class="menu-card-icon">‚öôÔ∏è</span>
                        <div class="menu-card-title">Í∏∞Ïñ¥ ÏÉÅÏ†ê</div>
                        <div class="menu-card-description">ÏÑ±Ïû•ÏùÑ Í∞ÄÏÜçÌôîÌïòÎäî Í∏∞Ïñ¥Î•º Íµ¨Îß§ÌïòÏÑ∏Ïöî</div>
                    </div>
                    <div class="menu-card" onclick="showSlotShop()">
                        <span class="menu-card-icon">üè°</span>
                        <div class="menu-card-title">Ïò®Ïã§ ÌôïÏû•</div>
                        <div class="menu-card-description">Ïò®Ïã§ Ïä¨Î°ØÏùÑ Ï∂îÍ∞ÄÎ°ú Íµ¨Îß§ÌïòÏÑ∏Ïöî</div>
                    </div>
                </div>
            `;
        }

        // Ïî®Ïïó ÏÉÅÏ†ê ÌëúÏãú
        function showSeedShop() {
            const contentArea = document.getElementById('content-area');
            contentArea.innerHTML = `
                <button class="back-button" onclick="showShop()">‚Üê Îí§Î°ú Í∞ÄÍ∏∞</button>
                <h2>üå∏ Ïî®Ïïó ÏÉÅÏ†ê</h2>
                <p>Ïò§ÎäòÏùò Ïî®Ïïó Í∞ÄÍ≤©ÏûÖÎãàÎã§. Í∞ÄÍ≤©ÏùÄ Îß§Ïùº Î≥ÄÎèôÎê©ÎãàÎã§.</p>
                <div id="shop-items"></div>
            `;
            
            renderSeedShop();
        }

        // Ïî®Ïïó ÏÉÅÏ†ê Î†åÎçîÎßÅ
        function renderSeedShop() {
            const shopItems = document.getElementById('shop-items');
            let html = `
                <table>
                    <tr>
                        <th>üå∏ ÏãùÎ¨º Ïù¥Î¶Ñ</th>
                        <th>‚è≥ ÏÑ±Ïû• ÏãúÍ∞Ñ</th>
                        <th>üíé Íµ¨Îß§ Í∞ÄÍ≤©</th>
                        <th>üíé ÌåêÎß§ Í∞ÄÍ≤©</th>
                        <th>üì¶ Ïû¨Í≥†</th>
                        <th>üîé ÏÑ§Î™Ö</th>
                        <th>üìà Í∞ÄÍ≤© Î≥ÄÌôî</th>
                        <th>üõí Íµ¨Îß§</th>
                    </tr>
            `;
            
            plants.forEach(plant => {
                const currentBuyPrice = getCurrentBuyPrice(plant);
                const currentSellPrice = getCurrentSellPrice(plant);
                const currentStock = getCurrentStock(plant);
                const trend = getPriceTrend(plant.id);
                const trendEmoji = trend > 0 ? 'üìà' : trend < 0 ? 'üìâ' : '‚ûñ';
                const trendClass = trend > 0 ? 'trend-up' : trend < 0 ? 'trend-down' : 'trend-neutral';
                
                // Ïñ¥Ï†ú Íµ¨Îß§Í∞ÄÍ≤©Í≥º ÎπÑÍµê
                const yesterday = gameState.day - 1;
                const yesterdayPrice = dailyPrices[yesterday] ? dailyPrices[yesterday][plant.id + '_buy'] : null;
                let priceChangeText = '';
                
                if (yesterdayPrice) {
                    const change = currentBuyPrice - yesterdayPrice;
                    const changePercent = Math.round((change / yesterdayPrice) * 100);
                    if (change > 0) {
                        priceChangeText = `<span style="color: #27ae60; font-weight: bold;">+${change} (+${changePercent}%) üìà</span>`;
                    } else if (change < 0) {
                        priceChangeText = `<span style="color: #e74c3c; font-weight: bold;">${change} (${changePercent}%) üìâ</span>`;
                    } else {
                        priceChangeText = `<span style="color: #f39c12; font-weight: bold;">Î≥ÄÌôî ÏóÜÏùå ‚ûñ</span>`;
                    }
                } else {
                    priceChangeText = `<span style="color: #f39c12; font-weight: bold;">ÏÉàÎ°úÏö¥ Í∞ÄÍ≤© ‚ûñ</span>`;
                }
                
                // Ïû¨Í≥† ÏÉÅÌÉú ÌëúÏãú
                let stockText = '';
                if (currentStock === 0) {
                    stockText = '<span style="color: #e74c3c; font-weight: bold;">ÌíàÏ†à</span>';
                } else if (currentStock <= 3) {
                    stockText = `<span style="color: #f39c12; font-weight: bold;">${currentStock}Í∞ú (Î∂ÄÏ°±)</span>`;
                } else {
                    stockText = `${currentStock}Í∞ú`;
                }
                
                html += `
                    <tr>
                        <td><span style="cursor: pointer; text-decoration: underline;" onclick="showPriceGraph('${plant.id}')">${plant.name}</span></td>
                        <td>${formatTime(plant.growTime)}</td>
                        <td>üíé ${currentBuyPrice}</td>
                        <td>üíé ${currentSellPrice}</td>
                        <td>${stockText}</td>
                        <td>${plant.description}</td>
                        <td class="${trendClass}">${priceChangeText}</td>
                        <td><button onclick="buySeed('${plant.id}')" ${gameState.gold < currentBuyPrice || currentStock === 0 ? 'disabled' : ''}>${currentStock === 0 ? 'ÌíàÏ†à' : 'Íµ¨Îß§'}</button></td>
                    </tr>
                `;
            });
            
            html += '</table>';
            shopItems.innerHTML = html;
        }

        // ÌòÑÏû¨ Íµ¨Îß§Í∞ÄÍ≤© Í≥ÑÏÇ∞
        function getCurrentBuyPrice(plant) {
            // Ïò§Îäò ÎÇ†ÏßúÎ•º ÌÇ§Î°ú ÏÇ¨Ïö©
            const today = gameState.day;
            
            // Ïù¥ÎØ∏ Í≥ÑÏÇ∞Îêú Íµ¨Îß§Í∞ÄÍ≤©Ïù¥ ÏûàÏúºÎ©¥ Î∞òÌôò
            if (dailyPrices[today] && dailyPrices[today][plant.id + '_buy']) {
                return dailyPrices[today][plant.id + '_buy'];
            }
            
            // ÏÉàÎ°úÏö¥ Íµ¨Îß§Í∞ÄÍ≤© Í≥ÑÏÇ∞ (Íµ¨Îß§Í∞Ä Î≤îÏúÑ ÎÇ¥ÏóêÏÑú)
            const minPrice = plant.priceRange[0];
            const maxPrice = plant.priceRange[1];
            const price = Math.floor(minPrice + Math.random() * (maxPrice - minPrice + 1));
            
            // Íµ¨Îß§Í∞ÄÍ≤© Ï†ÄÏû•
            if (!dailyPrices[today]) {
                dailyPrices[today] = {};
            }
            dailyPrices[today][plant.id + '_buy'] = price;
            
            return price;
        }

        // ÌòÑÏû¨ ÌåêÎß§Í∞ÄÍ≤© Í≥ÑÏÇ∞
        function getCurrentSellPrice(plant) {
            // Ïò§Îäò ÎÇ†ÏßúÎ•º ÌÇ§Î°ú ÏÇ¨Ïö©
            const today = gameState.day;
            
            // Ïù¥ÎØ∏ Í≥ÑÏÇ∞Îêú ÌåêÎß§Í∞ÄÍ≤©Ïù¥ ÏûàÏúºÎ©¥ Î∞òÌôò
            if (dailyPrices[today] && dailyPrices[today][plant.id + '_sell']) {
                return dailyPrices[today][plant.id + '_sell'];
            }
            
            // ÏÉàÎ°úÏö¥ ÌåêÎß§Í∞ÄÍ≤© Í≥ÑÏÇ∞ (ÌåêÎß§Í∞Ä Î≤îÏúÑ ÎÇ¥ÏóêÏÑú)
            const minPrice = plant.sellRange[0];
            const maxPrice = plant.sellRange[1];
            const price = Math.floor(minPrice + Math.random() * (maxPrice - minPrice + 1));
            
            // ÌåêÎß§Í∞ÄÍ≤© Ï†ÄÏû•
            if (!dailyPrices[today]) {
                dailyPrices[today] = {};
            }
            dailyPrices[today][plant.id + '_sell'] = price;
            
            return price;
        }

        // ÌòÑÏû¨ Í∞ÄÍ≤© Í≥ÑÏÇ∞ (Í∏∞Ï°¥ Ìò∏ÌôòÏÑ±ÏùÑ ÏúÑÌï¥)
        function getCurrentPrice(plant) {
            return getCurrentBuyPrice(plant);
        }

        // ÌòÑÏû¨ Ïû¨Í≥†Îüâ Í≥ÑÏÇ∞
        function getCurrentStock(plant) {
            const today = gameState.day;
            
            // Ïù¥ÎØ∏ Í≥ÑÏÇ∞Îêú Ïû¨Í≥†Í∞Ä ÏûàÏúºÎ©¥ Î∞òÌôò
            if (dailyStock[today] && dailyStock[today][plant.id] !== undefined) {
                return dailyStock[today][plant.id];
            }
            
            // Ïù¥Î≤§Ìä∏ ÏòÅÌñ• ÌôïÏù∏
            let stockMultiplier = 1.0;
            gameState.activeEvents.forEach(event => {
                if (event.affectedPlants.includes(plant.id)) {
                    stockMultiplier = 0.3; // Ïù¥Î≤§Ìä∏ Î∞úÏÉù Ïãú Ïû¨Í≥† 30%Î°ú Í∞êÏÜå
                }
            });
            
            // Ìù¨Í∑ÄÎèÑÏóê Îî∞Î•∏ Ïû¨Í≥† Í∞êÏÜå
            const rarityMultiplier = {
                'common': 1.0,
                'uncommon': 0.8,
                'rare': 0.6,
                'epic': 0.4,
                'legendary': 0.3,
                'mythic': 0.2
            };
            
            // ÌíàÏ†à ÌôïÎ•† (Ìù¨Í∑ÄÌïú ÏãùÎ¨ºÏùºÏàòÎ°ù ÎÜíÏùå) - ÎÇÆÏ∂§
            const soldOutChance = {
                'common': 0.02, // 2%
                'uncommon': 0.05, // 5%
                'rare': 0.08, // 8%
                'epic': 0.12, // 12%
                'legendary': 0.15, // 15%
                'mythic': 0.18 // 18%
            };
            
            // ÌíàÏ†à Ï≤¥ÌÅ¨
            if (Math.random() < soldOutChance[plant.rarity]) {
                if (!dailyStock[today]) {
                    dailyStock[today] = {};
                }
                dailyStock[today][plant.id] = 0;
                return 0;
            }
            
            // Í∏∞Î≥∏ Ïû¨Í≥†Îüâ Í≥ÑÏÇ∞ (ÎûúÎç§ Î≥ÄÎèô)
            const baseStock = plant.baseStock;
            const variation = Math.random() * 0.4 + 0.8; // 80~120% Î≥ÄÎèô
            const rarityMultiplierValue = rarityMultiplier[plant.rarity] || 1.0;
            const stock = Math.floor(baseStock * variation * stockMultiplier * rarityMultiplierValue);
            
            // Ïû¨Í≥† Ï†ÄÏû•
            if (!dailyStock[today]) {
                dailyStock[today] = {};
            }
            dailyStock[today][plant.id] = Math.max(0, stock);
            
            return Math.max(0, stock);
        }

        // Ïû¨Í≥† Í∞êÏÜå
        function decreaseStock(plantId) {
            const today = gameState.day;
            if (dailyStock[today] && dailyStock[today][plantId] > 0) {
                dailyStock[today][plantId]--;
                return true;
            }
            return false;
        }

        // Í∞ÄÍ≤© Ìä∏Î†åÎìú Í≥ÑÏÇ∞
        function getPriceTrend(plantId) {
            const today = gameState.day;
            const yesterday = today - 1;
            
            // Ïñ¥Ï†ú Íµ¨Îß§Í∞ÄÍ≤©Ïù¥ ÏóÜÏúºÎ©¥ ÎûúÎç§ Ìä∏Î†åÎìú Î∞òÌôò
            if (!dailyPrices[yesterday] || !dailyPrices[yesterday][plantId + '_buy']) {
                return Math.random() > 0.5 ? 1 : Math.random() > 0.5 ? -1 : 0;
            }
            
            const todayPrice = dailyPrices[today] ? dailyPrices[today][plantId + '_buy'] : getCurrentBuyPrice(plants.find(p => p.id === plantId));
            const yesterdayPrice = dailyPrices[yesterday][plantId + '_buy'];
            
            if (todayPrice > yesterdayPrice) return 1;
            if (todayPrice < yesterdayPrice) return -1;
            return 0;
        }

        // Í∞ÄÍ≤© Í∑∏ÎûòÌîÑ ÌëúÏãú
        function showPriceGraph(plantId) {
            const plant = plants.find(p => p.id === plantId);
            const currentBuyPrice = getCurrentBuyPrice(plant);
            const currentSellPrice = getCurrentSellPrice(plant);
            
            // ÏµúÍ∑º 7ÏùºÍ∞ÑÏùò Í∞ÄÍ≤© Îç∞Ïù¥ÌÑ∞ ÏàòÏßë
            const priceData = [];
            for (let day = Math.max(1, gameState.day - 6); day <= gameState.day; day++) {
                const buyPrice = dailyPrices[day] ? dailyPrices[day][plantId + '_buy'] : null;
                const sellPrice = dailyPrices[day] ? dailyPrices[day][plantId + '_sell'] : null;
                
                if (buyPrice && sellPrice) {
                    priceData.push({
                        day: day,
                        buyPrice: buyPrice,
                        sellPrice: sellPrice
                    });
                }
            }
            
            // Í∑∏ÎûòÌîÑ HTML ÏÉùÏÑ±
            let graphHtml = `
                <div style="background: rgba(255, 255, 255, 0.9); padding: 20px; border-radius: 10px; margin: 10px 0;">
                    <h3>üìä ${plant.name} Í∞ÄÍ≤© Î≥ÄÎèô Í∑∏ÎûòÌîÑ</h3>
                    <p><strong>ÌòÑÏû¨ Íµ¨Îß§Í∞Ä:</strong> üíé ${currentBuyPrice} | <strong>ÌòÑÏû¨ ÌåêÎß§Í∞Ä:</strong> üíé ${currentSellPrice}</p>
                    <div style="margin: 20px 0;">
            `;
            
            if (priceData.length > 1) {
                // ÏµúÍ≥†/ÏµúÏ†Ä Í∞ÄÍ≤© Ï∞æÍ∏∞
                const allPrices = priceData.flatMap(d => [d.buyPrice, d.sellPrice]);
                const minPrice = Math.min(...allPrices);
                const maxPrice = Math.max(...allPrices);
                const priceRange = maxPrice - minPrice;
                
                // SVG ÏÑ†Í∑∏ÎûòÌîÑ ÏÉùÏÑ±
                const svgWidth = 600;
                const svgHeight = 300;
                const padding = 40;
                const chartWidth = svgWidth - 2 * padding;
                const chartHeight = svgHeight - 2 * padding;
                
                graphHtml += `
                    <div style="margin: 20px 0;">
                        <svg width="${svgWidth}" height="${svgHeight}" style="border: 1px solid #ccc; background: white;">
                            <!-- YÏ∂ï Í∑∏Î¶¨Îìú -->
                            ${(() => {
                                let gridLines = '';
                                for (let i = 0; i <= 5; i++) {
                                    const y = padding + (i * chartHeight / 5);
                                    const price = maxPrice - (i * priceRange / 5);
                                    gridLines += `<line x1="${padding}" y1="${y}" x2="${svgWidth - padding}" y2="${y}" stroke="#eee" stroke-width="1"/>`;
                                    gridLines += `<text x="${padding - 5}" y="${y + 3}" text-anchor="end" font-size="10" fill="#666">üíé ${Math.round(price)}</text>`;
                                }
                                return gridLines;
                            })()}
                            
                            <!-- XÏ∂ï -->
                            <line x1="${padding}" y1="${svgHeight - padding}" x2="${svgWidth - padding}" y2="${svgHeight - padding}" stroke="#333" stroke-width="2"/>
                            
                            <!-- YÏ∂ï -->
                            <line x1="${padding}" y1="${padding}" x2="${padding}" y2="${svgHeight - padding}" stroke="#333" stroke-width="2"/>
                            
                            <!-- Íµ¨Îß§Í∞Ä ÏÑ†Í∑∏ÎûòÌîÑ -->
                            <polyline points="${priceData.map((data, index) => {
                                const x = padding + (index * chartWidth / (priceData.length - 1));
                                const y = padding + ((maxPrice - data.buyPrice) / priceRange) * chartHeight;
                                return `${x},${y}`;
                            }).join(' ')}" fill="none" stroke="#3498db" stroke-width="3"/>
                            
                            <!-- ÌåêÎß§Í∞Ä ÏÑ†Í∑∏ÎûòÌîÑ -->
                            <polyline points="${priceData.map((data, index) => {
                                const x = padding + (index * chartWidth / (priceData.length - 1));
                                const y = padding + ((maxPrice - data.sellPrice) / priceRange) * chartHeight;
                                return `${x},${y}`;
                            }).join(' ')}" fill="none" stroke="#e74c3c" stroke-width="3"/>
                            
                            <!-- Îç∞Ïù¥ÌÑ∞ Ìè¨Ïù∏Ìä∏ -->
                            ${priceData.map((data, index) => {
                                const x = padding + (index * chartWidth / (priceData.length - 1));
                                const buyY = padding + ((maxPrice - data.buyPrice) / priceRange) * chartHeight;
                                const sellY = padding + ((maxPrice - data.sellPrice) / priceRange) * chartHeight;
                                return `
                                    <circle cx="${x}" cy="${buyY}" r="4" fill="#3498db" stroke="white" stroke-width="2"/>
                                    <circle cx="${x}" cy="${sellY}" r="4" fill="#e74c3c" stroke="white" stroke-width="2"/>
                                    <text x="${x}" y="${svgHeight - padding + 15}" text-anchor="middle" font-size="10" fill="#666">Day ${data.day}</text>
                                `;
                            }).join('')}
                        </svg>
                    </div>
                    <div style="margin-top: 10px; font-size: 12px;">
                        <span style="color: #3498db;">‚óè</span> Íµ¨Îß§Í∞Ä | <span style="color: #e74c3c;">‚óè</span> ÌåêÎß§Í∞Ä
                    </div>
                    <div style="margin-top: 10px;">
                        <strong>ÏµúÍ≥†Í∞Ä:</strong> üíé ${maxPrice} | <strong>ÏµúÏ†ÄÍ∞Ä:</strong> üíé ${minPrice} | <strong>Í∞ÄÍ≤© Î≤îÏúÑ:</strong> üíé ${priceRange}
                    </div>
                `;
            } else {
                graphHtml += `
                    <p style="color: #666;">ÏïÑÏßÅ Ï∂©Î∂ÑÌïú Í∞ÄÍ≤© Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏäµÎãàÎã§. Îçî ÎßéÏùÄ ÎÇ†Ïù¥ ÏßÄÎÇòÎ©¥ Í∑∏ÎûòÌîÑÍ∞Ä ÌëúÏãúÎê©ÎãàÎã§.</p>
                `;
            }
            
            graphHtml += `
                    </div>
                    <button onclick="closePriceGraph()" style="margin-top: 10px;">Îã´Í∏∞</button>
                </div>
            `;
            
            // Î™®Îã¨ ÌòïÌÉúÎ°ú ÌëúÏãú
            const modal = document.createElement('div');
            modal.id = 'price-graph-modal';
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.7);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 1000;
            `;
            
            const modalContent = document.createElement('div');
            modalContent.style.cssText = `
                background: white;
                padding: 20px;
                border-radius: 10px;
                max-width: 90%;
                max-height: 90%;
                overflow-y: auto;
            `;
            modalContent.innerHTML = graphHtml;
            
            modal.appendChild(modalContent);
            document.body.appendChild(modal);
            
            // Î∞∞Í≤Ω ÌÅ¥Î¶≠ Ïãú Îã´Í∏∞
            modal.onclick = function(e) {
                if (e.target === modal) {
                    closePriceGraph();
                }
            };
        }

        // Í∞ÄÍ≤© Í∑∏ÎûòÌîÑ Îã´Í∏∞
        function closePriceGraph() {
            const modal = document.getElementById('price-graph-modal');
            if (modal) {
                modal.remove();
            }
        }

        // Í≤åÏûÑ Îç∞Ïù¥ÌÑ∞ Ï¥àÍ∏∞Ìôî
        function clearGameData() {
            const userInput = prompt(`‚ö†Ô∏è Ï†ïÎßêÎ°ú Î™®Îì† Í≤åÏûÑ Îç∞Ïù¥ÌÑ∞Î•º ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?\n\n` +
                                   `‚Ä¢ Î™®Îì† ÏßÑÌñâ ÏÉÅÌô©Ïù¥ ÏÇ¨ÎùºÏßëÎãàÎã§\n` +
                                   `‚Ä¢ Í≥®Îìú, ÏãùÎ¨º, Í∏∞Ïñ¥ Îì±Ïù¥ Î™®Îëê Ï¥àÍ∏∞ÌôîÎê©ÎãàÎã§\n` +
                                   `‚Ä¢ Î≥µÍµ¨Ìï† Ïàò ÏóÜÏäµÎãàÎã§\n\n` +
                                   `Í≥ÑÏÜçÌïòÏãúÎ†§Î©¥ "ÏÇ≠Ï†ú"ÎùºÍ≥† Ï†ïÌôïÌûà ÏûÖÎ†•ÌïòÏÑ∏Ïöî.`);
            
            if (userInput === 'ÏÇ≠Ï†ú') {
                // Î™®Îì† Ï†ÄÏû•Îêú Îç∞Ïù¥ÌÑ∞ ÏÇ≠Ï†ú
                localStorage.removeItem('magicalGreenhouse');
                localStorage.removeItem('magicalGreenhouse_backup');
                
                // Í≤åÏûÑ ÏÉÅÌÉú Ï¥àÍ∏∞Ìôî
                gameState = {
                    day: 1,
                    time: '6:00 AM',
                    gold: 100,
                    usedSlots: 0,
                    totalSlots: 2,
                    emptySlots: 0,
                    weather: '‚òÄÔ∏è',
                    weatherName: 'Sunny',
                    inventory: [],
                    harvestedPlants: [],
                    plantedCrops: [],
                    gears: [],
                    lastSave: Date.now(),
                    nextDayCost: 10,
                    slotCost: 10,
                    activeEvents: [],
                                lastAutoProgress: Date.now(),
            autoProgressEnabled: true
                };
                
                // Í∞ÄÍ≤©/Ïû¨Í≥† Îç∞Ïù¥ÌÑ∞ Ï¥àÍ∏∞Ìôî
                dailyPrices = {};
                dailyStock = {};
                
                showNotification('üóëÔ∏è Î™®Îì† Í≤åÏûÑ Îç∞Ïù¥ÌÑ∞Í∞Ä Ï¥àÍ∏∞ÌôîÎêòÏóàÏäµÎãàÎã§!');
                
                // ÌôîÎ©¥ ÏÉàÎ°úÍ≥†Ïπ®
                location.reload();
            } else if (userInput !== null) {
                showNotification('‚ùå "ÏÇ≠Ï†ú"ÎùºÍ≥† Ï†ïÌôïÌûà ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.');
            }
        }

        // Ïî®Ïïó Íµ¨Îß§
        function buySeed(plantId) {
            const plant = plants.find(p => p.id === plantId);
            const currentBuyPrice = getCurrentBuyPrice(plant);
            const currentStock = getCurrentStock(plant);
            
            if (gameState.gold < currentBuyPrice) {
                showNotification('‚ùå Í≥®ÎìúÍ∞Ä Î∂ÄÏ°±Ìï©ÎãàÎã§!');
                return;
            }
            
            if (currentStock === 0) {
                showNotification('‚ùå Ìï¥Îãπ Ïî®ÏïóÏù¥ ÌíàÏ†àÎêòÏóàÏäµÎãàÎã§!');
                return;
            }
            
            // Ïû¨Í≥† Í∞êÏÜå
            if (!decreaseStock(plantId)) {
                showNotification('‚ùå Ïû¨Í≥†Í∞Ä Î∂ÄÏ°±Ìï©ÎãàÎã§!');
                return;
            }
            
            gameState.gold -= currentBuyPrice;
            gameState.inventory.push(plantId);
            
            showNotification(`üõí ${plant.name} Ïî®ÏïóÏùÑ Íµ¨Îß§ÌñàÏäµÎãàÎã§! -${currentBuyPrice} Í≥®Îìú (Ïû¨Í≥†: ${currentStock - 1}Í∞ú)`);
            
            updateDisplay();
            
            // ÌòÑÏû¨ ÌôîÎ©¥Ïóê Îî∞Îùº Ï¶âÏãú ÏóÖÎç∞Ïù¥Ìä∏
            const currentContent = document.getElementById('content-area').innerHTML;
            if (currentContent.includes('Ïî®Ïïó ÏÉÅÏ†ê')) {
                renderSeedShop();
            }
            
            saveGameState();
        }

        // Í∏∞Ïñ¥ ÏÉÅÏ†ê ÌëúÏãú
        function showGearShop() {
            const contentArea = document.getElementById('content-area');
            contentArea.innerHTML = `
                <button class="back-button" onclick="showShop()">‚Üê Îí§Î°ú Í∞ÄÍ∏∞</button>
                <h2>‚öôÔ∏è Í∏∞Ïñ¥ ÏÉÅÏ†ê</h2>
                <p>Ïò®Ïã§ ÏÉùÏÇ∞ÏÑ±ÏùÑ ÎÜíÏù¥Îäî Í∏∞Ïñ¥Îì§ÏùÑ Íµ¨Îß§ÌïòÏÑ∏Ïöî.</p>
                <div id="gear-items"></div>
            `;
            
            renderGearShop();
        }

        // Í∏∞Ïñ¥ ÏÉÅÏ†ê Î†åÎçîÎßÅ
        function renderGearShop() {
            const gearItems = document.getElementById('gear-items');
            const gears = [
                { id: 'water_sprinkler', name: 'üíß Î¨º Î∂ÑÎ¨¥Í∏∞', price: 50, effect: 'ÏÑ±Ïû• ÏÜçÎèÑ +10%' },
                { id: 'sunlight_lamp', name: '‚òÄÔ∏è ÌñáÎπõ Îû®ÌîÑ', price: 100, effect: 'ÏÑ±Ïû• ÏÜçÎèÑ +20%' },
                { id: 'magic_fertilizer', name: 'üå± ÎßàÎ≤ï ÎπÑÎ£å', price: 200, effect: 'ÏÑ±Ïû• ÏÜçÎèÑ +30%' },
                { id: 'time_accelerator', name: '‚è∞ ÏãúÍ∞Ñ Í∞ÄÏÜçÍ∏∞', price: 500, effect: 'ÏÑ±Ïû• ÏÜçÎèÑ +50%' }
            ];
            
            let html = `
                <table>
                    <tr>
                        <th>‚öôÔ∏è Í∏∞Ïñ¥ Ïù¥Î¶Ñ</th>
                        <th>üíé Í∞ÄÍ≤©</th>
                        <th>üîß Ìö®Í≥º</th>
                        <th>üõí Íµ¨Îß§</th>
                    </tr>
            `;
            
            gears.forEach(gear => {
                html += `
                    <tr>
                        <td>${gear.name}</td>
                        <td>üíé ${gear.price}</td>
                        <td>${gear.effect}</td>
                        <td><button onclick="buyGear('${gear.id}')" ${gameState.gold < gear.price ? 'disabled' : ''}>Íµ¨Îß§</button></td>
                    </tr>
                `;
            });
            
            html += '</table>';
            gearItems.innerHTML = html;
        }

        // Í∏∞Ïñ¥ Íµ¨Îß§
        function buyGear(gearId) {
            const gears = [
                { id: 'water_sprinkler', name: 'üíß Î¨º Î∂ÑÎ¨¥Í∏∞', price: 50, effect: 'ÏÑ±Ïû• ÏÜçÎèÑ +10%' },
                { id: 'sunlight_lamp', name: '‚òÄÔ∏è ÌñáÎπõ Îû®ÌîÑ', price: 100, effect: 'ÏÑ±Ïû• ÏÜçÎèÑ +20%' },
                { id: 'magic_fertilizer', name: 'üå± ÎßàÎ≤ï ÎπÑÎ£å', price: 200, effect: 'ÏÑ±Ïû• ÏÜçÎèÑ +30%' },
                { id: 'time_accelerator', name: '‚è∞ ÏãúÍ∞Ñ Í∞ÄÏÜçÍ∏∞', price: 500, effect: 'ÏÑ±Ïû• ÏÜçÎèÑ +50%' }
            ];
            
            const gear = gears.find(g => g.id === gearId);
            
            if (gameState.gold < gear.price) {
                showNotification('‚ùå Í≥®ÎìúÍ∞Ä Î∂ÄÏ°±Ìï©ÎãàÎã§!');
                return;
            }
            
            gameState.gold -= gear.price;
            
            // Í∏∞Ïñ¥Î•º Ïù∏Î≤§ÌÜ†Î¶¨Ïóê Ï∂îÍ∞Ä
            const existingGear = gameState.gears.find(g => g.id === gearId);
            if (existingGear) {
                existingGear.count++;
            } else {
                gameState.gears.push({
                    id: gearId,
                    name: gear.name,
                    effect: gear.effect,
                    count: 1
                });
            }
            
            showNotification(`‚öôÔ∏è ${gear.name}ÏùÑ(Î•º) Íµ¨Îß§ÌñàÏäµÎãàÎã§! -${gear.price} Í≥®Îìú`);
            
            updateDisplay();
            saveGameState();
        }

        // Ïä¨Î°Ø ÏÉÅÏ†ê ÌëúÏãú
        function showSlotShop() {
            const contentArea = document.getElementById('content-area');
            contentArea.innerHTML = `
                <button class="back-button" onclick="showShop()">‚Üê Îí§Î°ú Í∞ÄÍ∏∞</button>
                <h2>üè° Ïò®Ïã§ ÌôïÏû•</h2>
                <p>Îçî ÎßéÏùÄ ÏãùÎ¨ºÏùÑ Ïã¨ÏùÑ Ïàò ÏûàÎèÑÎ°ù Ïò®Ïã§ÏùÑ ÌôïÏû•ÌïòÏÑ∏Ïöî.</p>
                <div id="slot-items"></div>
            `;
            
            renderSlotShop();
        }

        // Ïä¨Î°Ø ÏÉÅÏ†ê Î†åÎçîÎßÅ
        function renderSlotShop() {
            const slotItems = document.getElementById('slot-items');
            const nextSlotCost = gameState.slotCost;
            
            let html = `
                <div class="slot-info">
                    <h3>ÌòÑÏû¨ Ïò®Ïã§ ÏÉÅÌÉú</h3>
                    <p>Ï¥ù Ïä¨Î°Ø: ${gameState.totalSlots}Í∞ú</p>
                    <p>ÏÇ¨Ïö© Ï§ë: ${gameState.usedSlots}Í∞ú</p>
                    <p>Îπà Ïä¨Î°Ø: ${gameState.emptySlots}Í∞ú</p>
                </div>
                <div class="slot-purchase">
                    <h3>Ïä¨Î°Ø Íµ¨Îß§</h3>
                    <p>Ï∂îÍ∞Ä Ïä¨Î°Ø 1Í∞ú: üíé ${nextSlotCost}</p>
                    <button onclick="buySlot()" ${gameState.gold < nextSlotCost ? 'disabled' : ''}>Ïä¨Î°Ø Íµ¨Îß§</button>
                </div>
            `;
            
            slotItems.innerHTML = html;
        }

        // Ïä¨Î°Ø Íµ¨Îß§
        function buySlot() {
            const cost = gameState.slotCost;
            
            if (gameState.gold < cost) {
                showNotification('‚ùå Í≥®ÎìúÍ∞Ä Î∂ÄÏ°±Ìï©ÎãàÎã§!');
                return;
            }
            
            gameState.gold -= cost;
            gameState.totalSlots++;
            gameState.slotCost += 10; // Îã§Ïùå Ïä¨Î°Ø ÎπÑÏö© Ï¶ùÍ∞Ä
            
            showNotification(`üè° Ïò®Ïã§ Ïä¨Î°ØÏùÑ Íµ¨Îß§ÌñàÏäµÎãàÎã§! +1 Ïä¨Î°Ø, -${cost} Í≥®Îìú`);
            
            updateDisplay();
            renderPlantSlots();
            saveGameState();
        }

        // ÏãúÏÑ∏ ÌôïÏù∏ ÌëúÏãú
        function showMarketPrices() {
            const contentArea = document.getElementById('content-area');
            contentArea.innerHTML = `
                <button class="back-button" onclick="showShop()">‚Üê Îí§Î°ú Í∞ÄÍ∏∞</button>
                <h2>üìä ÏãúÏÑ∏ ÌôïÏù∏</h2>
                <p>ÌòÑÏû¨ ÏãùÎ¨º ÌåêÎß§ ÏãúÏÑ∏Î•º ÌôïÏù∏ÌïòÏÑ∏Ïöî.</p>
                <div id="market-prices"></div>
            `;
            
            renderMarketPrices();
        }

        // ÏãúÏÑ∏ Î†åÎçîÎßÅ
        function renderMarketPrices() {
            const marketPrices = document.getElementById('market-prices');
            let html = `
                <table>
                    <tr>
                        <th>üå∏ ÏãùÎ¨º Ïù¥Î¶Ñ</th>
                        <th>üíé ÌòÑÏû¨ Í∞ÄÍ≤©</th>
                        <th>üìà Í∞ÄÍ≤© Î≥ÄÌôî</th>
                        <th>üìä ÎÇ¥ Î≥¥Ïú†Îüâ</th>
                        <th>üí∞ ÌåêÎß§</th>
                    </tr>
            `;
            
            // Î≥¥Ïú†Ìïú ÏãùÎ¨ºÎì§Ïùò ÏàòÎüâÍ≥º ÌíàÏßàÎ≥Ñ Î∂ÑÎ•ò
            const plantDetails = {};
            gameState.harvestedPlants.forEach(plant => {
                if (!plantDetails[plant.plantId]) {
                    plantDetails[plant.plantId] = { normal: 0, good: 0, perfect: 0 };
                }
                plantDetails[plant.plantId][plant.quality]++;
            });
            
            plants.forEach(plant => {
                const currentSellPrice = getCurrentSellPrice(plant);
                const eventPrice = getEventPrice(currentSellPrice, plant.id);
                const trend = getPriceTrend(plant.id);
                const trendEmoji = trend > 0 ? 'üìà' : trend < 0 ? 'üìâ' : '‚ûñ';
                const trendClass = trend > 0 ? 'trend-up' : trend < 0 ? 'trend-down' : 'trend-neutral';
                const plantDetail = plantDetails[plant.id] || { normal: 0, good: 0, perfect: 0 };
                const totalOwned = plantDetail.normal + plantDetail.good + plantDetail.perfect;
                
                // Ïñ¥Ï†ú ÌåêÎß§Í∞ÄÍ≤©Í≥º ÎπÑÍµê
                const yesterday = gameState.day - 1;
                const yesterdayPrice = dailyPrices[yesterday] ? dailyPrices[yesterday][plant.id + '_sell'] : null;
                let priceChangeText = '';
                
                if (yesterdayPrice) {
                    const change = currentSellPrice - yesterdayPrice;
                    const changePercent = Math.round((change / yesterdayPrice) * 100);
                    if (change > 0) {
                        priceChangeText = `<span style="color: #27ae60; font-weight: bold;">+${change} (+${changePercent}%) üìà</span>`;
                    } else if (change < 0) {
                        priceChangeText = `<span style="color: #e74c3c; font-weight: bold;">${change} (${changePercent}%) üìâ</span>`;
                    } else {
                        priceChangeText = `<span style="color: #f39c12; font-weight: bold;">Î≥ÄÌôî ÏóÜÏùå ‚ûñ</span>`;
                    }
                } else {
                    priceChangeText = `<span style="color: #f39c12; font-weight: bold;">ÏÉàÎ°úÏö¥ Í∞ÄÍ≤© ‚ûñ</span>`;
                }
                
                // Î≥¥Ïú†Îüâ ÌëúÏãú
                let ownedText = '';
                if (totalOwned > 0) {
                    ownedText = `${totalOwned}Í∞ú (`;
                    if (plantDetail.perfect > 0) ownedText += `‚ú®${plantDetail.perfect} `;
                    if (plantDetail.good > 0) ownedText += `‚≠ê${plantDetail.good} `;
                    if (plantDetail.normal > 0) ownedText += `üå±${plantDetail.normal}`;
                    ownedText += ')';
                } else {
                    ownedText = '0Í∞ú';
                }
                
                // Ïù¥Î≤§Ìä∏ Î≥¥ÎÑàÏä§ ÌëúÏãú
                let eventBonusText = '';
                if (eventPrice > currentSellPrice) {
                    eventBonusText = `<br><small style="color: #FF6B6B; font-weight: bold;">üéâ Ïù¥Î≤§Ìä∏ Î≥¥ÎÑàÏä§: +${eventPrice - currentSellPrice}</small>`;
                }
                
                html += `
                    <tr>
                        <td>${plant.name}</td>
                        <td>üíé ${eventPrice}${eventBonusText}</td>
                        <td class="${trendClass}">${priceChangeText}</td>
                        <td>${ownedText}</td>
                        <td><button onclick="sellPlant('${plant.id}')" ${totalOwned === 0 ? 'disabled' : ''}>ÌåêÎß§</button></td>
                    </tr>
                `;
            });
            
            html += '</table>';
            marketPrices.innerHTML = html;
        }

        // ÌíàÏßàÎ≥Ñ Í∞ÄÍ≤© Í≥ÑÏÇ∞ (ÌäπÎ≥Ñ Ìö®Í≥º Ìè¨Ìï®)
        function getQualityPrice(basePrice, quality, specialEffect = '') {
            let finalPrice = basePrice;
            
            // ÌíàÏßàÎ≥Ñ Í∞ÄÍ≤© ÏÑ§Ï†ï
            switch(quality) {
                case 'perfect':
                    // ÏôÑÎ≤Ω ÌíàÏßà: ÌòÑÏû¨ ÏãúÏÑ∏Î≥¥Îã§ ÎÜíÏùÄ Í≥†Ï†ï Í∞ÄÍ≤©
                    finalPrice = Math.floor(basePrice * 1.8); // 80% Î≥¥ÎÑàÏä§
                    break;
                case 'good':
                    // Ï¢ãÏùå ÌíàÏßà: ÌòÑÏû¨ ÏãúÏÑ∏Î≥¥Îã§ ÎÜíÏùÄ Í≥†Ï†ï Í∞ÄÍ≤©
                    finalPrice = Math.floor(basePrice * 1.4); // 40% Î≥¥ÎÑàÏä§
                    break;
                case 'normal':
                default:
                    // Î≥¥ÌÜµ ÌíàÏßà: ÌòÑÏû¨ ÏãúÏÑ∏ Ï†ÅÏö©
                    finalPrice = basePrice; // Í∏∞Î≥∏ Í∞ÄÍ≤© (ÏãúÏÑ∏ Ï†ÅÏö©)
            }
            
            // ÌäπÎ≥Ñ Ìö®Í≥º Ï†ÅÏö©
            if (specialEffect.includes('Îã¨Îπõ Ìö®Í≥º')) {
                finalPrice = Math.floor(finalPrice * 2); // 2Î∞∞
            } else if (specialEffect.includes('Î≤àÍ∞ú Ï∂©Ï†Ñ')) {
                finalPrice = Math.floor(finalPrice * 3); // 3Î∞∞
            } else if (specialEffect.includes('Î¨¥ÏßÄÍ∞ú Ìö®Í≥º')) {
                finalPrice = Math.floor(finalPrice * 1.4); // 40% Î≥¥ÎÑàÏä§
            }
            
            return finalPrice;
        }

        // Ïù¥Î≤§Ìä∏ Í∞ÄÍ≤© Í≥ÑÏÇ∞
        function getEventPrice(basePrice, plantId) {
            let eventMultiplier = 1.0;
            
            // ÌôúÏÑ± Ïù¥Î≤§Ìä∏ ÌôïÏù∏
            gameState.activeEvents.forEach(event => {
                if (event.affectedPlants.includes(plantId)) {
                    eventMultiplier *= event.priceMultiplier;
                }
            });
            
            return Math.floor(basePrice * eventMultiplier);
        }

        // ÏãùÎ¨º ÌåêÎß§ (ÌíàÏßà ÏÑ†ÌÉù Í∞ÄÎä•)
        function sellPlant(plantId) {
            const plant = plants.find(p => p.id === plantId);
            const currentSellPrice = getCurrentSellPrice(plant);
            
            // Ìï¥Îãπ ÏãùÎ¨ºÎì§Ïùò ÌíàÏßàÎ≥Ñ Î∂ÑÎ•ò
            const availablePlants = gameState.harvestedPlants.filter(p => p.plantId === plantId);
            
            if (availablePlants.length === 0) {
                showNotification('‚ùå ÌåêÎß§Ìï† ÏãùÎ¨ºÏù¥ ÏóÜÏäµÎãàÎã§!');
                return;
            }
            
            // ÌíàÏßàÎ≥ÑÎ°ú Î∂ÑÎ•ò
            const qualityGroups = {
                perfect: availablePlants.filter(p => p.quality === 'perfect'),
                good: availablePlants.filter(p => p.quality === 'good'),
                normal: availablePlants.filter(p => p.quality === 'normal')
            };
            
            // Í∞ÄÏû• ÎÜíÏùÄ ÌíàÏßàÏùò ÏãùÎ¨ºÏùÑ Ïö∞ÏÑ† ÌåêÎß§
            let plantToSell = null;
            if (qualityGroups.perfect.length > 0) {
                plantToSell = qualityGroups.perfect[0];
            } else if (qualityGroups.good.length > 0) {
                plantToSell = qualityGroups.good[0];
            } else {
                plantToSell = qualityGroups.normal[0];
            }
            
            const qualityPrice = getQualityPrice(currentSellPrice, plantToSell.quality, plantToSell.specialEffect || '');
            const eventPrice = getEventPrice(qualityPrice, plantId);
            
            // Ìï¥Îãπ ÏãùÎ¨º Ï†úÍ±∞
            const plantIndex = gameState.harvestedPlants.findIndex(p => 
                p.plantId === plantId && p.quality === plantToSell.quality
            );
            gameState.harvestedPlants.splice(plantIndex, 1);
            gameState.gold += eventPrice;
            
            const qualityEmoji = plantToSell.quality === 'perfect' ? '‚ú®' : plantToSell.quality === 'good' ? '‚≠ê' : 'üå±';
            const qualityText = plantToSell.quality === 'perfect' ? 'ÏôÑÎ≤Ω' : plantToSell.quality === 'good' ? 'Ï¢ãÏùå' : 'Î≥¥ÌÜµ';
            
            let eventText = '';
            if (eventPrice > qualityPrice) {
                eventText = ` (Ïù¥Î≤§Ìä∏ Î≥¥ÎÑàÏä§: +${eventPrice - qualityPrice})`;
            }
            showNotification(`üí∞ ${plant.name} (${qualityEmoji} ${qualityText})ÏùÑ(Î•º) ÌåêÎß§ÌñàÏäµÎãàÎã§! +${eventPrice} Í≥®Îìú${eventText}`);
            
            updateDisplay();
            
            // Ï¶âÏãú ÌòÑÏû¨ ÌôîÎ©¥ ÏóÖÎç∞Ïù¥Ìä∏
            setTimeout(() => {
                const currentContent = document.getElementById('content-area').innerHTML;
                if (currentContent.includes('Ïù∏Î≤§ÌÜ†Î¶¨') || currentContent.includes('Ïî®Ïïó Ïù∏Î≤§ÌÜ†Î¶¨')) {
                    renderInventory();
                } else if (currentContent.includes('ÏãúÏÑ∏ ÌôïÏù∏')) {
                    renderMarketPrices();
                } else if (currentContent.includes('ÏãùÎ¨º Ïã¨Í∏∞') || currentContent.includes('plant-inventory')) {
                    renderPlantInventory();
                }
            }, 50);
            
            saveGameState();
        }

        // Îã§ÏùåÎÇ† Í∏∞Îã§Î¶¨Í∏∞ ÌôïÏù∏
        function waitNextDay() {
            const cost = gameState.nextDayCost;
            const confirmMessage = `üåÖ Day ${gameState.day}ÏóêÏÑú Day ${gameState.day + 1}Î°ú ÏßÑÌñâÌïòÏãúÍ≤†ÏäµÎãàÍπå?\n\n` +
                                 `‚Ä¢ ÏÉàÎ°úÏö¥ ÎÇ†Ïî®Í∞Ä ÏÑ§Ï†ïÎê©ÎãàÎã§\n` +
                                 `‚Ä¢ Ïî®Ïïó Í∞ÄÍ≤©Ïù¥ Î≥ÄÎèôÎê©ÎãàÎã§\n` +
                                 `‚Ä¢ Ïã¨Ïñ¥ÏßÑ ÏãùÎ¨ºÎì§Ïù¥ ÏÑ±Ïû•Ìï©ÎãàÎã§\n` +
                                 `‚Ä¢ ÎπÑÏö©: üíé ${cost} Í≥®Îìú`;
            
            if (confirm(confirmMessage)) {
                if (gameState.gold >= cost) {
                    proceedToNextDay();
                } else {
                    showNotification('‚ùå Í≥®ÎìúÍ∞Ä Î∂ÄÏ°±Ìï©ÎãàÎã§! Îã§ÏùåÎÇ†Î°ú ÏßÑÌñâÌïòÎ†§Î©¥ üíé ' + cost + ' Í≥®ÎìúÍ∞Ä ÌïÑÏöîÌï©ÎãàÎã§.');
                }
            }
        }

        // ÌôïÎ•† Í∏∞Î∞ò ÎÇ†Ïî® ÏÑ†ÌÉù
        function selectWeatherByProbability() {
            const random = Math.random() * 100;
            let cumulativeProbability = 0;
            
            for (const weather of weathers) {
                cumulativeProbability += weather.probability;
                if (random <= cumulativeProbability) {
                    return weather;
                }
            }
            
            // Í∏∞Î≥∏Í∞í (ÎßëÏùå)
            return weathers[0];
        }

        // ÎÇ†Ïî® Ìö®Í≥º Ï†ÅÏö©
        function applyWeatherEffects() {
            const currentWeather = weathers.find(w => w.emoji === gameState.weather);
            if (!currentWeather) return;
            
            let effectMessage = '';
            
            switch (currentWeather.effect) {
                case 'growth_boost': // ÎπÑ
                    if (Math.random() < 0.3) {
                        effectMessage = 'üåßÔ∏è ÎπÑÎ°ú Ïù∏Ìï¥ ÏÑ±Ïû• ÏÜçÎèÑÍ∞Ä 50% Ï¶ùÍ∞ÄÌñàÏäµÎãàÎã§!';
                    }
                    break;
                    
                case 'moonlight_bonus': // Îã¨Îπõ
                    if (Math.random() < 0.2) {
                        effectMessage = 'üåô Îã¨Îπõ Ìö®Í≥ºÎ°ú ÌåêÎß§Í∞ÄÍ∞Ä 2Î∞∞Í∞Ä Îê† Ïàò ÏûàÏäµÎãàÎã§!';
                    }
                    break;
                    
                case 'electric_charge': // Î≤àÍ∞ú
                    if (Math.random() < 0.15) {
                        effectMessage = 'üå©Ô∏è Î≤àÍ∞ú Ï∂©Ï†ÑÏúºÎ°ú ÌåêÎß§Í∞ÄÍ∞Ä 3Î∞∞Í∞Ä Îê† Ïàò ÏûàÏäµÎãàÎã§!';
                    }
                    break;
                    
                case 'unstable_price': // ÏïàÍ∞ú
                    if (Math.random() < 0.2) {
                        effectMessage = 'üå´Ô∏è ÏïàÍ∞úÎ°ú Ïù∏Ìï¥ ÏàòÌôïÍ∞ÄÍ∞Ä Î∂àÏïàÏ†ïÌï¥ÏßëÎãàÎã§ (50~150%)';
                    }
                    break;
                    
                case 'wind_damage': // Í∞ïÌíç
                    if (Math.random() < 0.25) {
                        effectMessage = 'üå™Ô∏è Í∞ïÌíçÏúºÎ°ú ÏùºÎ∂Ä ÏûëÎ¨ºÏù¥ ÏãúÎì§Í±∞ÎÇò ÎÇ†ÏïÑÍ∞à Ïàò ÏûàÏäµÎãàÎã§!';
                    } else {
                        effectMessage = 'üå™Ô∏è Í∞ïÌíçÏúºÎ°ú ÌåêÎß§Í∞ÄÍ∞Ä 10% Ï¶ùÍ∞ÄÌï©ÎãàÎã§!';
                    }
                    break;
                    
                case 'frost_delay': // ÏÑúÎ¶¨
                    if (Math.random() < 0.3) {
                        effectMessage = '‚ùÑÔ∏è ÏÑúÎ¶¨Î°ú ÏÑ±Ïû•Ïù¥ Ï†ïÏßÄÎêòÍ≥† Î≥¥Ï°¥ Í∏∞Í∞ÑÏù¥ 1Ïùº Ï¶ùÍ∞ÄÌï©ÎãàÎã§!';
                    }
                    break;
                    
                case 'heat_growth': // Ïó¥Í∏∞
                    effectMessage = 'üî• Ïó¥Í∏∞Î°ú ÏÑ±Ïû• ÏÜçÎèÑÍ∞Ä 2Î∞∞ Ï¶ùÍ∞ÄÌïòÏßÄÎßå ÏãúÎì§ ÏúÑÌóòÏù¥ ÏûàÏäµÎãàÎã§!';
                    break;
                    
                case 'rainbow_rare': // Î¨¥ÏßÄÍ∞ú
                    effectMessage = 'üåà Î¨¥ÏßÄÍ∞ú Ìö®Í≥ºÎ°ú Ìù¨Í∑ÄÏÑ±Ïù¥ Î∂ÄÏó¨Îê©ÎãàÎã§ (ÌåêÎß§Í∞Ä+40%, ÏÑ±Ïû•+20%)!';
                    break;
                    
                case 'dark_cloud': // ÏïîÏö¥
                    effectMessage = 'üåò ÏïîÏö¥ÏúºÎ°ú ÏùºÎ∂Ä ÏûëÎ¨ºÏóê Î∂ÄÏ†ï Ìö®Í≥ºÍ∞Ä ÏûàÏßÄÎßå Îã§Î•∏ ÏûëÎ¨ºÏùÄ Í∞ïÌôîÎê©ÎãàÎã§!';
                    break;
            }
            
            if (effectMessage) {
                showNotification(effectMessage);
            }
        }

        // Ïù¥Î≤§Ìä∏ Ï≤¥ÌÅ¨ Î∞è ÏÉùÏÑ±
        function checkAndCreateEvents() {
            const newEvents = [];
            
            events.forEach(event => {
                if (Math.random() < event.probability) {
                    newEvents.push({
                        ...event,
                        startDay: gameState.day,
                        endDay: gameState.day + event.duration
                    });
                }
            });
            
            return newEvents;
        }

        // Ïù¥Î≤§Ìä∏ ÏóÖÎç∞Ïù¥Ìä∏ (ÎßåÎ£åÎêú Ïù¥Î≤§Ìä∏ Ï†úÍ±∞)
        function updateEvents() {
            gameState.activeEvents = gameState.activeEvents.filter(event => 
                gameState.day <= event.endDay
            );
        }

        // Îã§ÏùåÎÇ†Î°ú ÏßÑÌñâ
        function proceedToNextDay() {
            const cost = gameState.nextDayCost;
            gameState.gold -= cost;
            gameState.day++;
            gameState.time = '6:00 AM';
            
            // Îã§ÏùåÎÇ† ÎπÑÏö© Ï¶ùÍ∞Ä (Î¨¥Ìïú Ï¶ùÍ∞Ä)
            gameState.nextDayCost += 2;
            
            // Ïù¥Î≤§Ìä∏ ÏóÖÎç∞Ïù¥Ìä∏
            updateEvents();
            
            // ÏÉàÎ°úÏö¥ Ïù¥Î≤§Ìä∏ Ï≤¥ÌÅ¨
            const newEvents = checkAndCreateEvents();
            gameState.activeEvents.push(...newEvents);
            
            // ÌôïÎ•† Í∏∞Î∞ò ÎÇ†Ïî® ÏÑ†ÌÉù
            const newWeather = selectWeatherByProbability();
            gameState.weather = newWeather.emoji;
            gameState.weatherName = newWeather.name;
            
            // Î∞∞Í≤Ω Î≥ÄÍ≤Ω
            document.body.className = newWeather.class;
            
            showNotification(`üåÖ ÏÉàÎ°úÏö¥ ÌïòÎ£®Í∞Ä ÏãúÏûëÎêòÏóàÏäµÎãàÎã§! (Day ${gameState.day})`);
            showNotification(`üå§Ô∏è Ïò§ÎäòÏùò ÎÇ†Ïî®: ${newWeather.emoji} ${newWeather.name}`);
            showNotification(`üí∞ Ïî®Ïïó Í∞ÄÍ≤©Ïù¥ Î≥ÄÎèôÎêòÏóàÏäµÎãàÎã§!`);
            showNotification(`üí∏ Îã§ÏùåÎÇ† ÏßÑÌñâ ÎπÑÏö©: -${cost} Í≥®Îìú`);
            
            // ÏÉàÎ°úÏö¥ Ïù¥Î≤§Ìä∏ ÏïåÎ¶º
            newEvents.forEach(event => {
                showNotification(`üéâ ${event.name}Ïù¥(Í∞Ä) ÏãúÏûëÎêòÏóàÏäµÎãàÎã§! ${event.description}`);
                showNotification(`üìà Ìï¥Îãπ ÏãùÎ¨ºÎì§Ïùò ÌåêÎß§Í∞ÄÍ∞Ä ${event.priceMultiplier}Î∞∞Î°ú Ï¶ùÍ∞ÄÌï©ÎãàÎã§!`);
                showNotification(`üì¶ Ïù¥Î≤§Ìä∏ Í∏∞Í∞Ñ Ï§ë Ìï¥Îãπ ÏãùÎ¨ºÎì§Ïùò Ïû¨Í≥†Í∞Ä 30%Î°ú Í∞êÏÜåÌï©ÎãàÎã§!`);
            });
            
            // ÎÇ†Ïî® Ìö®Í≥º Ï†ÅÏö© Î∞è ÏïåÎ¶º
            applyWeatherEffects();
            
            // ÏûêÎèô ÏßÑÌñâ ÌÉÄÏù¥Î®∏ Î¶¨ÏÖã
            gameState.lastAutoProgress = Date.now();
            
            // Ï†ÑÏ≤¥ ÌôîÎ©¥ ÏÉàÎ°úÍ≥†Ïπ®
            updateDisplay();
            refreshAllScreens();
            saveGameState();
        }

        // Î™®Îì† ÌôîÎ©¥ ÏÉàÎ°úÍ≥†Ïπ®
        function refreshAllScreens() {
            // ÌòÑÏû¨ ÌôîÎ©¥ ÏÉÅÌÉú Ï†ÄÏû•
            const currentContent = document.getElementById('content-area').innerHTML;
            
            // ÌòÑÏû¨ ÌôîÎ©¥Ïóê Îî∞Îùº Ìï¥Îãπ Î†åÎçîÎßÅ Ìï®ÏàòÎßå Ìò∏Ï∂ú
            if (currentContent.includes('üå∏ Ïî®Ïïó ÏÉÅÏ†ê')) {
                renderSeedShop();
            } else if (currentContent.includes('üìä ÏãúÏÑ∏ ÌôïÏù∏')) {
                renderMarketPrices();
            } else if (currentContent.includes('üì¶ Ïù∏Î≤§ÌÜ†Î¶¨')) {
                renderInventory();
            } else if (currentContent.includes('üå± ÏãùÎ¨º Ïã¨Í∏∞')) {
                renderPlantInventory();
            }
            // Îã§Î•∏ ÌôîÎ©¥Îì§ÏùÄ Îç∞Ïù¥ÌÑ∞Îßå ÏóÖÎç∞Ïù¥Ìä∏ÌïòÍ≥† ÌôîÎ©¥ÏùÄ Î≥ÄÍ≤ΩÌïòÏßÄ ÏïäÏùå
        }

        // ÏÑ±Ïû• ÏÉÅÌÉú Î≥¥Í∏∞
        function showGrowthStatus() {
            const contentArea = document.getElementById('content-area');
            contentArea.innerHTML = `
                <button class="back-button" onclick="showMainMenu()">‚Üê Îí§Î°ú Í∞ÄÍ∏∞</button>
                <h2>üìà ÏÑ±Ïû• ÏÉÅÌÉú</h2>
                <div id="growth-status"></div>
            `;
            
            renderGrowthStatus();
        }

        // ÏÑ±Ïû• ÏÉÅÌÉú Î†åÎçîÎßÅ
        function renderGrowthStatus() {
            const growthStatus = document.getElementById('growth-status');
            
            if (gameState.plantedCrops.length === 0) {
                growthStatus.innerHTML = '<p>ÌòÑÏû¨ Ïã¨Ïñ¥ÏßÑ ÏãùÎ¨ºÏù¥ ÏóÜÏäµÎãàÎã§.</p>';
                return;
            }
            
            let html = '<table><tr><th>ÏãùÎ¨º</th><th>ÏÑ±Ïû•Î•†</th><th>ÎÇ®ÏùÄ ÏãúÍ∞Ñ</th><th>ÏÉÅÌÉú</th></tr>';
            
            gameState.plantedCrops.forEach((crop, index) => {
                const plant = plants.find(p => p.id === crop.plantId);
                const progress = (Date.now() - crop.plantTime) / (plant.growTime * 1000);
                const remainingTime = Math.max(0, plant.growTime - (Date.now() - crop.plantTime) / 1000);
                
                let status = 'üå± ÏÑ±Ïû• Ï§ë';
                if (progress >= 1) {
                    status = '‚ú® ÏàòÌôï Í∞ÄÎä•!';
                }
                
                html += `
                    <tr>
                        <td>${plant.name}</td>
                        <td>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${Math.min(100, progress * 100)}%"></div>
                            </div>
                            ${Math.round(progress * 100)}%
                        </td>
                        <td>${formatTime(Math.ceil(remainingTime))}</td>
                        <td>${status}</td>
                    </tr>
                `;
            });
            
            html += '</table>';
            growthStatus.innerHTML = html;
        }

        // Î©îÏù∏ Î©îÎâ¥ ÌëúÏãú
        function showMainMenu() {
            const contentArea = document.getElementById('content-area');
            contentArea.innerHTML = `
                <h2>üåø Ïò®Ïã§Ïóê Ïò§Ïã† Í≤ÉÏùÑ ÌôòÏòÅÌï©ÎãàÎã§!</h2>
                <div id="plant-slots"></div>
            `;
            renderPlantSlots();
        }

        // ÏïåÎ¶º ÌëúÏãú
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // ÏïåÎ¶º Í∂åÌïú ÏÉÅÌÉú ÌôïÏù∏ Î∞è ÌëúÏãú
        function checkNotificationPermission() {
            if ('Notification' in window) {
                if (Notification.permission === 'granted') {
                    showNotification('üîî ÏïåÎ¶ºÏù¥ ÌôúÏÑ±ÌôîÎêòÏóàÏäµÎãàÎã§!');
                } else if (Notification.permission === 'denied') {
                    showNotification('üîï ÏïåÎ¶ºÏù¥ ÎπÑÌôúÏÑ±ÌôîÎêòÏóàÏäµÎãàÎã§. Î∏åÎùºÏö∞Ï†Ä ÏÑ§Ï†ïÏóêÏÑú ÌóàÏö©Ìï¥Ï£ºÏÑ∏Ïöî.');
                }
            }
        }

        // ÏûêÎèô ÏßÑÌñâ Ï≤¥ÌÅ¨
        function checkAutoProgress() {
            if (!gameState.autoProgressEnabled) return;
            
            const now = Date.now();
            const timeSinceLastProgress = now - gameState.lastAutoProgress;
            const fiveMinutes = 5 * 60 * 1000; // 5Î∂ÑÏùÑ Î∞ÄÎ¶¨Ï¥àÎ°ú
            
            if (timeSinceLastProgress >= fiveMinutes) {
                // ÏûêÎèôÏúºÎ°ú Îã§ÏùåÎÇ† ÏßÑÌñâ
                proceedToNextDay();
                gameState.lastAutoProgress = now;
                showNotification('‚è∞ 5Î∂ÑÏù¥ ÏßÄÎÇò ÏûêÎèôÏúºÎ°ú Îã§ÏùåÎÇ†Î°ú ÏßÑÌñâÎêòÏóàÏäµÎãàÎã§!');
                
                // ÌÉÄÏù¥Î®∏ Î¶¨ÏÖã
                updateTimer();
            }
        }

        // ÌÉÄÏù¥Î®∏ ÏóÖÎç∞Ïù¥Ìä∏
        function updateTimer() {
            const now = Date.now();
            const timeSinceLastProgress = now - gameState.lastAutoProgress;
            const fiveMinutes = 5 * 60 * 1000; // 5Î∂ÑÏùÑ Î∞ÄÎ¶¨Ï¥àÎ°ú
            const remainingTime = Math.max(0, fiveMinutes - timeSinceLastProgress);
            
            const minutes = Math.floor(remainingTime / (60 * 1000));
            const seconds = Math.floor((remainingTime % (60 * 1000)) / 1000);
            
            // Î©îÎâ¥ Ïπ¥ÎìúÏùò ÌÉÄÏù¥Î®∏ ÌëúÏãú ÏóÖÎç∞Ïù¥Ìä∏
            const timerDisplay = document.getElementById('timer-display');
            if (timerDisplay) {
                timerDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                
                // 1Î∂Ñ Ïù¥ÌïòÏùº Îïå ÌéÑÏä§ Ìö®Í≥º Ï∂îÍ∞Ä
                const timerMenuCard = document.getElementById('timer-menu-card');
                if (remainingTime <= 60000) {
                    timerMenuCard.classList.add('timer-pulse');
                } else {
                    timerMenuCard.classList.remove('timer-pulse');
                }
            }
            
            // ÏÇ¨Ïù¥ÎìúÎ∞î ÌÉÄÏù¥Î®∏ÎèÑ ÏóÖÎç∞Ïù¥Ìä∏ (Í∏∞Ï°¥ Í∏∞Îä• Ïú†ÏßÄ)
            const sidebarTimer = document.getElementById('sidebar-timer');
            if (sidebarTimer) {
                const sidebarTimerDisplay = document.getElementById('next-day-timer');
                if (sidebarTimerDisplay) {
                    sidebarTimerDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                    
                    if (remainingTime <= 60000) {
                        sidebarTimer.classList.add('timer-pulse');
                    } else {
                        sidebarTimer.classList.remove('timer-pulse');
                    }
                }
            }
        }

        // ÏûêÎèô ÏßÑÌñâ ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
        function updateAutoProgressStatus() {
            const statusElement = document.getElementById('auto-progress-status');
            if (statusElement) {
                // Ìï≠ÏÉÅ ÌôúÏÑ±Ìôî ÏÉÅÌÉúÎ°ú ÌëúÏãú
                statusElement.textContent = '‚è∞ ÏûêÎèô ÏßÑÌñâ ÌôúÏÑ±Ìôî';
                statusElement.style.color = '#4CAF50';
            }
        }

        // ÎÇ†Ïî®Ïóê Îî∞Î•∏ ÌÉÄÏù¥Î®∏ ÏÉâÏÉÅ ÏóÖÎç∞Ïù¥Ìä∏
        function updateTimerWeatherStyle() {
            const sidebarTimer = document.getElementById('sidebar-timer');
            if (!sidebarTimer) return;
            
            // ÎÇ†Ïî®Ïóê Îî∞Î•∏ Ï∂îÍ∞Ä Ïä§ÌÉÄÏùº Ï†ÅÏö©
            const weather = gameState.weather;
            switch (weather) {
                case '‚òÄÔ∏è': // ÎßëÏùå
                    sidebarTimer.style.borderColor = '#FFD700';
                    break;
                case 'üåßÔ∏è': // ÎπÑ
                    sidebarTimer.style.borderColor = '#3498db';
                    break;
                case 'üåô': // Îã¨Îπõ
                    sidebarTimer.style.borderColor = '#34495e';
                    break;
                case 'üå©Ô∏è': // Î≤àÍ∞ú
                    sidebarTimer.style.borderColor = '#8e44ad';
                    break;
                case 'üå´Ô∏è': // ÏïàÍ∞ú
                    sidebarTimer.style.borderColor = '#95a5a6';
                    break;
                case 'üå™Ô∏è': // Í∞ïÌíç
                    sidebarTimer.style.borderColor = '#8e44ad';
                    break;
                case '‚ùÑÔ∏è': // ÏÑúÎ¶¨
                    sidebarTimer.style.borderColor = '#bdc3c7';
                    break;
                case 'üî•': // Ïó¥Í∏∞
                    sidebarTimer.style.borderColor = '#e74c3c';
                    break;
                case 'üåà': // Î¨¥ÏßÄÍ∞ú
                    sidebarTimer.style.borderColor = '#ff6b6b';
                    break;
                case 'üåò': // ÏïîÏö¥
                    sidebarTimer.style.borderColor = '#34495e';
                    break;
            }
        }

        // ÏûêÎèô ÏßÑÌñâ ÌÜ†Í∏Ä (Ï†úÍ±∞Îê® - Ìï≠ÏÉÅ ÌôúÏÑ±Ìôî)
        function toggleAutoProgress() {
            // Ïù¥ Ìï®ÏàòÎäî Îçî Ïù¥ÏÉÅ ÏÇ¨Ïö©ÎêòÏßÄ ÏïäÏäµÎãàÎã§
            // ÏûêÎèô ÏßÑÌñâÏùÄ Ìï≠ÏÉÅ ÌôúÏÑ±ÌôîÎêòÏñ¥ ÏûàÏäµÎãàÎã§
        }

        // Í≤åÏûÑ Î£®ÌîÑ
        function startGameLoop() {
            setInterval(() => {
                // ÏûêÎèô ÏßÑÌñâ Ï≤¥ÌÅ¨
                checkAutoProgress();
                
                // ÏÑ±Ïû• ÏôÑÎ£åÎêú ÏãùÎ¨º ÌôïÏù∏
                gameState.plantedCrops.forEach((crop, index) => {
                    const plant = plants.find(p => p.id === crop.plantId);
                    const progress = (Date.now() - crop.plantTime) / (plant.growTime * 1000);
                    
                    if (progress >= 1 && !crop.notified) {
                        showNotification(`‚ú® ${plant.name}Ïù¥(Í∞Ä) ÏÑ±Ïû• ÏôÑÎ£åÎêòÏóàÏäµÎãàÎã§!`);
                        
                        // Ïõπ ÏïåÎ¶º ÌëúÏãú
                        showWebNotification(
                            'üåø ÎßàÎ≤ï Ïò®Ïã§ - ÏàòÌôï ÏãúÍ∞Ñ!',
                            `${plant.name}Ïù¥(Í∞Ä) ÏôÑÏÑ±ÎêòÏóàÏäµÎãàÎã§! ÏàòÌôïÌïòÎü¨ Ïò§ÏÑ∏Ïöî!`
                        );
                        
                        crop.notified = true;
                    }
                });
                
                // ÌÉÄÏù¥Î®∏ Ïã§ÏãúÍ∞Ñ ÏóÖÎç∞Ïù¥Ìä∏
                updateTimer();
                
                renderPlantSlots();
            }, 1000);
        }

        // Í≤åÏûÑ ÏãúÏûë
        initGame();
    </script>
</body>
</html>
