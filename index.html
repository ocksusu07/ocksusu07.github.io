<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸŒ¿ ë§ˆë²• ì˜¨ì‹¤ ê´€ë¦¬ì</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', monospace;
            min-height: 100vh;
            padding: 20px;
            transition: all 0.5s ease;
        }

        /* ë‚ ì”¨ë³„ ë°°ê²½ ìŠ¤íƒ€ì¼ */
        body.weather-sunny {
            background: linear-gradient(135deg, #87CEEB, #FFD700);
            color: #2c3e50;
        }

        body.weather-rainy {
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: #ecf0f1;
        }

        body.weather-foggy {
            background: linear-gradient(135deg, #7f8c8d, #95a5a6);
            color: #2c3e50;
        }

        body.weather-snowy {
            background: linear-gradient(135deg, #bdc3c7, #ecf0f1);
            color: #2c3e50;
        }

        body.weather-storm {
            background: linear-gradient(135deg, #2c3e50, #8e44ad);
            color: #ecf0f1;
        }

        body.weather-rainbow {
            background: linear-gradient(135deg, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4, #feca57, #ff9ff3, #54a0ff);
            background-size: 400% 400%;
            animation: rainbow 3s ease infinite;
            color: #2c3e50;
        }

        body.weather-hot {
            background: linear-gradient(135deg, #e74c3c, #f39c12);
            color: #2c3e50;
        }

        body.weather-night {
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: #ecf0f1;
        }

        @keyframes rainbow {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            border-radius: 20px;
            padding: 30px;
            background: rgba(255, 255, 255, 0.25);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
            transition: all 0.5s ease;
        }

        /* ë‚ ì”¨ë³„ ì»¨í…Œì´ë„ˆ ìŠ¤íƒ€ì¼ */
        body.weather-sunny .container {
            background: rgba(255, 255, 255, 0.3);
            border: 2px solid rgba(255, 215, 0, 0.4);
            box-shadow: 0 8px 32px rgba(255, 215, 0, 0.25);
        }

        body.weather-rainy .container {
            background: rgba(52, 73, 94, 0.3);
            border: 2px solid rgba(52, 152, 219, 0.4);
            box-shadow: 0 8px 32px rgba(52, 152, 219, 0.25);
        }

        body.weather-foggy .container {
            background: rgba(149, 165, 166, 0.3);
            border: 2px solid rgba(149, 165, 166, 0.4);
            box-shadow: 0 8px 32px rgba(149, 165, 166, 0.25);
        }

        body.weather-snowy .container {
            background: rgba(236, 240, 241, 0.3);
            border: 2px solid rgba(189, 195, 199, 0.4);
            box-shadow: 0 8px 32px rgba(189, 195, 199, 0.25);
        }

        body.weather-storm .container {
            background: rgba(44, 62, 80, 0.3);
            border: 2px solid rgba(142, 68, 173, 0.4);
            box-shadow: 0 8px 32px rgba(142, 68, 173, 0.25);
        }

        body.weather-rainbow .container {
            background: rgba(255, 255, 255, 0.3);
            border: 2px solid rgba(255, 107, 107, 0.4);
            box-shadow: 0 8px 32px rgba(255, 107, 107, 0.25);
        }

        body.weather-hot .container {
            background: rgba(255, 255, 255, 0.3);
            border: 2px solid rgba(231, 76, 60, 0.4);
            box-shadow: 0 8px 32px rgba(231, 76, 60, 0.25);
        }

        body.weather-night .container {
            background: rgba(44, 62, 80, 0.3);
            border: 2px solid rgba(52, 73, 94, 0.4);
            box-shadow: 0 8px 32px rgba(52, 73, 94, 0.25);
        }

        /* ê¸°ì¡´ ë‚ ì”¨ë³„ ì»¨í…Œì´ë„ˆ ìŠ¤íƒ€ì¼ ì œê±° - ìœ„ì—ì„œ ìƒˆë¡œìš´ ìŠ¤íƒ€ì¼ë¡œ ëŒ€ì²´ë¨ */

        .header {
            text-align: center;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 25px;
            transition: all 0.5s ease;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        /* ë‚ ì”¨ë³„ í—¤ë” ìŠ¤íƒ€ì¼ */
        body.weather-sunny .header {
            border: 2px solid #FFD700;
            background: rgba(255, 215, 0, 0.1);
        }

        body.weather-rainy .header {
            border: 2px solid #3498db;
            background: rgba(52, 152, 219, 0.1);
        }

        body.weather-foggy .header {
            border: 2px solid #95a5a6;
            background: rgba(149, 165, 166, 0.1);
        }

        body.weather-snowy .header {
            border: 2px solid #bdc3c7;
            background: rgba(189, 195, 199, 0.1);
        }

        body.weather-storm .header {
            border: 2px solid #8e44ad;
            background: rgba(142, 68, 173, 0.1);
        }

        body.weather-rainbow .header {
            border: 2px solid #ff6b6b;
            background: rgba(255, 107, 107, 0.1);
        }

        body.weather-hot .header {
            border: 2px solid #e74c3c;
            background: rgba(231, 76, 60, 0.1);
        }

        body.weather-night .header {
            border: 2px solid #34495e;
            background: rgba(52, 73, 94, 0.1);
        }

        .status-bar {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-bottom: 20px;
        }

        .sidebar-timer {
            position: fixed;
            top: 50%;
            right: 20px;
            transform: translateY(-50%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            z-index: 1000;
            width: 140px;
            height: 120px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            transition: all 0.3s ease;
            font-family: 'Orbitron', 'Courier New', monospace;
        }

        .sidebar-timer:hover {
            transform: translateY(-50%) scale(1.05);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.4);
        }

        .timer-display {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 8px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            font-family: 'Orbitron', 'Courier New', monospace;
            letter-spacing: 2px;
            width: 100%;
            text-align: center;
            min-height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .timer-label {
            font-size: 12px;
            opacity: 0.9;
            margin-bottom: 10px;
            font-weight: 500;
        }

        .auto-progress-status {
            font-size: 10px;
            opacity: 0.8;
            margin-top: 8px;
            padding: 4px 8px;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.1);
        }

        .timer-pulse {
            animation: timerPulse 2s infinite;
        }

        /* ë‚ ì”¨ë³„ íƒ€ì´ë¨¸ ìŠ¤íƒ€ì¼ */
        body.weather-sunny .sidebar-timer {
            background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
            border: 2px solid #FFD700;
        }

        body.weather-rainy .sidebar-timer {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            border: 2px solid #3498db;
        }

        body.weather-foggy .sidebar-timer {
            background: linear-gradient(135deg, #95a5a6 0%, #7f8c8d 100%);
            border: 2px solid #95a5a6;
        }

        body.weather-snowy .sidebar-timer {
            background: linear-gradient(135deg, #bdc3c7 0%, #ecf0f1 100%);
            border: 2px solid #bdc3c7;
            color: #2c3e50;
        }

        body.weather-storm .sidebar-timer {
            background: linear-gradient(135deg, #8e44ad 0%, #9b59b6 100%);
            border: 2px solid #8e44ad;
        }

        body.weather-rainbow .sidebar-timer {
            background: linear-gradient(135deg, #ff6b6b 0%, #4ecdc4 50%, #45b7d1 100%);
            background-size: 200% 200%;
            animation: rainbowGradient 3s ease infinite;
            border: 2px solid #ff6b6b;
        }

        body.weather-hot .sidebar-timer {
            background: linear-gradient(135deg, #e74c3c 0%, #f39c12 100%);
            border: 2px solid #e74c3c;
        }

        body.weather-night .sidebar-timer {
            background: linear-gradient(135deg, #34495e 0%, #2c3e50 100%);
            border: 2px solid #34495e;
        }

        @keyframes rainbowGradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        @keyframes timerPulse {
            0% { box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3); }
            50% { box-shadow: 0 8px 32px rgba(255, 255, 255, 0.3); }
            100% { box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3); }
        }

        /* ë©”ë‰´ ì¹´ë“œ íƒ€ì´ë¨¸ í„ìŠ¤ íš¨ê³¼ */
        .menu-card.timer-pulse {
            animation: menuCardPulse 2s infinite;
        }

        @keyframes menuCardPulse {
            0% { 
                box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
                transform: scale(1);
            }
            50% { 
                box-shadow: 0 4px 16px rgba(255, 255, 255, 0.3);
                transform: scale(1.02);
            }
            100% { 
                box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
                transform: scale(1);
            }
        }

        /* ëª¨ë°”ì¼ ë°˜ì‘í˜• */
        @media (max-width: 768px) {
            .sidebar-timer {
                position: fixed;
                top: 10px;
                right: 10px;
                transform: none;
                width: 120px;
                height: 100px;
                padding: 15px;
            }
            
            .sidebar-timer:hover {
                transform: none;
            }
            
            .left-sidebar, .right-sidebar {
                position: fixed;
                top: auto;
                bottom: 20px;
                transform: none;
                width: calc(50% - 30px);
                flex-direction: row;
                flex-wrap: wrap;
                gap: 10px;
            }
            
            .left-sidebar {
                left: 20px;
            }
            
            .right-sidebar {
                right: 20px;
            }
            
            .menu-card {
                width: calc(50% - 5px);
                min-width: 120px;
                padding: 15px;
            }
            
            .menu-card-icon {
                font-size: 1.5em;
            }
            
            .menu-card-title {
                font-size: 12px;
            }
            
            .menu-card-description {
                font-size: 10px;
            }
        }

        .status-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid #4CAF50;
        }

        .menu {
            display: none; /* ê¸°ì¡´ ë©”ë‰´ ìˆ¨ê¸°ê¸° */
        }

        .left-sidebar, .right-sidebar {
            position: fixed;
            top: 50%;
            transform: translateY(-50%);
            display: flex;
            flex-direction: column;
            gap: 10px;
            width: 140px;
            z-index: 1000;
        }

        .left-sidebar {
            left: 15px;
        }

        .right-sidebar {
            right: 15px;
        }

        .menu-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 12px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.2);
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
            width: 100%;
        }

        .menu-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            padding: 25px;
            text-align: center;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .menu-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.4s;
        }

        .menu-card:hover::before {
            left: 100%;
        }

        .menu-card:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
        }

        .menu-card-icon {
            font-size: 1.8em;
            margin-bottom: 8px;
            display: block;
        }

        .menu-card-title {
            font-size: 13px;
            font-weight: 600;
            color: inherit;
            margin-bottom: 4px;
        }

        .menu-card-description {
            font-size: 10px;
            color: rgba(255, 255, 255, 0.7);
            line-height: 1.3;
        }

        /* ë‚ ì”¨ë³„ ë©”ë‰´ ì¹´ë“œ ìŠ¤íƒ€ì¼ */
        body.weather-sunny .menu-card {
            background: rgba(255, 215, 0, 0.15);
            border-color: rgba(255, 215, 0, 0.3);
            color: #2c3e50;
        }

        body.weather-rainy .menu-card {
            background: rgba(52, 152, 219, 0.15);
            border-color: rgba(52, 152, 219, 0.3);
            color: #ecf0f1;
        }

        body.weather-foggy .menu-card {
            background: rgba(149, 165, 166, 0.15);
            border-color: rgba(149, 165, 166, 0.3);
            color: #2c3e50;
        }

        body.weather-snowy .menu-card {
            background: rgba(189, 195, 199, 0.15);
            border-color: rgba(189, 195, 199, 0.3);
            color: #2c3e50;
        }

        body.weather-storm .menu-card {
            background: rgba(142, 68, 173, 0.15);
            border-color: rgba(142, 68, 173, 0.3);
            color: #ecf0f1;
        }

        body.weather-rainbow .menu-card {
            background: rgba(255, 107, 107, 0.15);
            border-color: rgba(255, 107, 107, 0.3);
            color: #2c3e50;
        }

        body.weather-hot .menu-card {
            background: rgba(231, 76, 60, 0.15);
            border-color: rgba(231, 76, 60, 0.3);
            color: #2c3e50;
        }

        body.weather-night .menu-card {
            background: rgba(52, 73, 94, 0.15);
            border-color: rgba(52, 73, 94, 0.3);
            color: #ecf0f1;
        }

        /* ê¸°ì¡´ ìƒ‰ìƒë³„ í´ë˜ìŠ¤ ì œê±° - ë‚ ì”¨ë³„ ìŠ¤íƒ€ì¼ë¡œ ëŒ€ì²´ë¨ */

        .shop-menu {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .slot-info, .slot-purchase {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .slot-info h3, .slot-purchase h3 {
            margin-bottom: 10px;
            color: #4CAF50;
        }

        /* ê¸°ì¡´ menu-item ìŠ¤íƒ€ì¼ ì œê±° - ì¹´ë“œ ìŠ¤íƒ€ì¼ë¡œ ëŒ€ì²´ë¨ */

        .content-area {
            border-radius: 15px;
            padding: 30px;
            min-height: 500px;
            transition: all 0.5s ease;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        /* ë‚ ì”¨ë³„ ì½˜í…ì¸  ì˜ì—­ ìŠ¤íƒ€ì¼ */
        body.weather-sunny .content-area {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid #FFD700;
        }

        body.weather-rainy .content-area {
            background: rgba(52, 73, 94, 0.1);
            border: 1px solid #3498db;
        }

        body.weather-foggy .content-area {
            background: rgba(149, 165, 166, 0.1);
            border: 1px solid #95a5a6;
        }

        body.weather-snowy .content-area {
            background: rgba(236, 240, 241, 0.1);
            border: 1px solid #bdc3c7;
        }

        body.weather-storm .content-area {
            background: rgba(44, 62, 80, 0.1);
            border: 1px solid #8e44ad;
        }

        body.weather-rainbow .content-area {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid #ff6b6b;
        }

        body.weather-hot .content-area {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid #e74c3c;
        }

        body.weather-night .content-area {
            background: rgba(44, 62, 80, 0.1);
            border: 1px solid #34495e;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #4CAF50;
        }

        th {
            font-weight: bold;
            transition: all 0.5s ease;
        }

        /* ë‚ ì”¨ë³„ í…Œì´ë¸” í—¤ë” ìŠ¤íƒ€ì¼ */
        body.weather-sunny th {
            background: rgba(255, 215, 0, 0.3);
        }

        body.weather-rainy th {
            background: rgba(52, 152, 219, 0.3);
        }

        body.weather-foggy th {
            background: rgba(149, 165, 166, 0.3);
        }

        body.weather-snowy th {
            background: rgba(189, 195, 199, 0.3);
        }

        body.weather-storm th {
            background: rgba(142, 68, 173, 0.3);
        }

        body.weather-rainbow th {
            background: rgba(255, 107, 107, 0.3);
        }

        body.weather-hot th {
            background: rgba(231, 76, 60, 0.3);
        }

        body.weather-night th {
            background: rgba(52, 73, 94, 0.3);
        }

        .plant-slot {
            display: inline-block;
            width: 100px;
            height: 100px;
            border-radius: 20px;
            margin: 8px;
            text-align: center;
            line-height: 1.2;
            position: relative;
            transition: all 0.5s ease;
            font-size: 12px;
            padding: 5px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            vertical-align: top;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(5px);
            border: 2px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
            animation: gentleGlow 4s ease-in-out infinite;
        }

        @keyframes gentleGlow {
            0% {
                box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
                transform: scale(1);
            }
            50% {
                box-shadow: 0 6px 20px rgba(255, 255, 255, 0.2);
                transform: scale(1.02);
            }
            100% {
                box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
                transform: scale(1);
            }
        }

        #plant-slots {
            /* ì œëª©ê³¼ ìŠ¬ë¡¯ì„ ë¶„ë¦¬ */
        }

        .slots-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: flex-start;
            align-items: flex-start;
            gap: 8px;
            margin-top: 10px;
        }

        /* ë‚ ì”¨ë³„ ì‹ë¬¼ ìŠ¬ë¡¯ ìŠ¤íƒ€ì¼ */
        body.weather-sunny .plant-slot {
            background: rgba(255, 215, 0, 0.15);
            border-color: rgba(255, 215, 0, 0.4);
            animation: sunnyGlow 4s ease-in-out infinite;
        }

        body.weather-rainy .plant-slot {
            background: rgba(52, 152, 219, 0.15);
            border-color: rgba(52, 152, 219, 0.4);
            animation: rainyGlow 4s ease-in-out infinite;
        }

        body.weather-foggy .plant-slot {
            background: rgba(149, 165, 166, 0.15);
            border-color: rgba(149, 165, 166, 0.4);
            animation: foggyGlow 4s ease-in-out infinite;
        }

        body.weather-snowy .plant-slot {
            background: rgba(189, 195, 199, 0.15);
            border-color: rgba(189, 195, 199, 0.4);
            animation: snowyGlow 4s ease-in-out infinite;
        }

        body.weather-storm .plant-slot {
            background: rgba(142, 68, 173, 0.15);
            border-color: rgba(142, 68, 173, 0.4);
            animation: stormGlow 4s ease-in-out infinite;
        }

        body.weather-rainbow .plant-slot {
            background: rgba(255, 107, 107, 0.15);
            border-color: rgba(255, 107, 107, 0.4);
            animation: rainbowGlow 4s ease-in-out infinite;
        }

        body.weather-hot .plant-slot {
            background: rgba(231, 76, 60, 0.15);
            border-color: rgba(231, 76, 60, 0.4);
            animation: hotGlow 4s ease-in-out infinite;
        }

        body.weather-night .plant-slot {
            background: rgba(52, 73, 94, 0.15);
            border-color: rgba(52, 73, 94, 0.4);
            animation: nightGlow 4s ease-in-out infinite;
        }

        /* ë‚ ì”¨ë³„ ë¶€ë“œëŸ¬ìš´ ê¸€ë¡œìš° ì• ë‹ˆë©”ì´ì…˜ */
        @keyframes sunnyGlow {
            0% {
                box-shadow: 0 4px 16px rgba(255, 215, 0, 0.2);
                transform: scale(1);
            }
            50% {
                box-shadow: 0 6px 20px rgba(255, 215, 0, 0.4);
                transform: scale(1.02);
            }
            100% {
                box-shadow: 0 4px 16px rgba(255, 215, 0, 0.2);
                transform: scale(1);
            }
        }

        @keyframes rainyGlow {
            0% {
                box-shadow: 0 4px 16px rgba(52, 152, 219, 0.2);
                transform: scale(1);
            }
            50% {
                box-shadow: 0 6px 20px rgba(52, 152, 219, 0.4);
                transform: scale(1.02);
            }
            100% {
                box-shadow: 0 4px 16px rgba(52, 152, 219, 0.2);
                transform: scale(1);
            }
        }

        @keyframes foggyGlow {
            0% {
                box-shadow: 0 4px 16px rgba(149, 165, 166, 0.2);
                transform: scale(1);
            }
            50% {
                box-shadow: 0 6px 20px rgba(149, 165, 166, 0.4);
                transform: scale(1.02);
            }
            100% {
                box-shadow: 0 4px 16px rgba(149, 165, 166, 0.2);
                transform: scale(1);
            }
        }

        @keyframes snowyGlow {
            0% {
                box-shadow: 0 4px 16px rgba(189, 195, 199, 0.2);
                transform: scale(1);
            }
            50% {
                box-shadow: 0 6px 20px rgba(189, 195, 199, 0.4);
                transform: scale(1.02);
            }
            100% {
                box-shadow: 0 4px 16px rgba(189, 195, 199, 0.2);
                transform: scale(1);
            }
        }

        @keyframes stormGlow {
            0% {
                box-shadow: 0 4px 16px rgba(142, 68, 173, 0.2);
                transform: scale(1);
            }
            50% {
                box-shadow: 0 6px 20px rgba(142, 68, 173, 0.4);
                transform: scale(1.02);
            }
            100% {
                box-shadow: 0 4px 16px rgba(142, 68, 173, 0.2);
                transform: scale(1);
            }
        }

        @keyframes rainbowGlow {
            0% {
                box-shadow: 0 4px 16px rgba(255, 107, 107, 0.2);
                transform: scale(1);
            }
            50% {
                box-shadow: 0 6px 20px rgba(255, 107, 107, 0.4);
                transform: scale(1.02);
            }
            100% {
                box-shadow: 0 4px 16px rgba(255, 107, 107, 0.2);
                transform: scale(1);
            }
        }

        @keyframes hotGlow {
            0% {
                box-shadow: 0 4px 16px rgba(231, 76, 60, 0.2);
                transform: scale(1);
            }
            50% {
                box-shadow: 0 6px 20px rgba(231, 76, 60, 0.4);
                transform: scale(1.02);
            }
            100% {
                box-shadow: 0 4px 16px rgba(231, 76, 60, 0.2);
                transform: scale(1);
            }
        }

        @keyframes nightGlow {
            0% {
                box-shadow: 0 4px 16px rgba(52, 73, 94, 0.2);
                transform: scale(1);
            }
            50% {
                box-shadow: 0 6px 20px rgba(52, 73, 94, 0.4);
                transform: scale(1.02);
            }
            100% {
                box-shadow: 0 4px 16px rgba(52, 73, 94, 0.2);
                transform: scale(1);
            }
        }

        .plant-slot.growing {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            animation: pulse 2s infinite;
        }

        .plant-slot.ready {
            background: linear-gradient(45deg, #FFD700, #FFA500);
            animation: glow 1s infinite alternate;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @keyframes glow {
            from { box-shadow: 0 0 5px #FFD700; }
            to { box-shadow: 0 0 20px #FFD700; }
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(45deg, #FFD700, #FFA500);
            color: #000;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }

        .back-button {
            background: rgba(255, 255, 255, 0.15);
            color: inherit;
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 10px 20px;
            border-radius: 12px;
            cursor: pointer;
            margin-bottom: 15px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            position: relative;
            overflow: hidden;
        }

        .back-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        .back-button:hover::before {
            left: 100%;
        }

        .back-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
            background: rgba(255, 255, 255, 0.25);
        }

        button {
            background: rgba(255, 255, 255, 0.2);
            color: inherit;
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 8px 16px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(8px);
            position: relative;
            overflow: hidden;
        }

        button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.4s;
        }

        button:hover::before {
            left: 100%;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            background: rgba(255, 255, 255, 0.3);
        }

        button:disabled {
            background: rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.5);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* ë‚ ì”¨ë³„ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        body.weather-sunny button {
            background: rgba(255, 215, 0, 0.2);
            border-color: rgba(255, 215, 0, 0.4);
            color: #2c3e50;
        }

        body.weather-rainy button {
            background: rgba(52, 152, 219, 0.2);
            border-color: rgba(52, 152, 219, 0.4);
            color: #ecf0f1;
        }

        body.weather-foggy button {
            background: rgba(149, 165, 166, 0.2);
            border-color: rgba(149, 165, 166, 0.4);
            color: #2c3e50;
        }

        body.weather-snowy button {
            background: rgba(189, 195, 199, 0.2);
            border-color: rgba(189, 195, 199, 0.4);
            color: #2c3e50;
        }

        body.weather-storm button {
            background: rgba(142, 68, 173, 0.2);
            border-color: rgba(142, 68, 173, 0.4);
            color: #ecf0f1;
        }

        body.weather-rainbow button {
            background: rgba(255, 107, 107, 0.2);
            border-color: rgba(255, 107, 107, 0.4);
            color: #2c3e50;
        }

        body.weather-hot button {
            background: rgba(231, 76, 60, 0.2);
            border-color: rgba(231, 76, 60, 0.4);
            color: #2c3e50;
        }

        body.weather-night button {
            background: rgba(52, 73, 94, 0.2);
            border-color: rgba(52, 73, 94, 0.4);
            color: #ecf0f1;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            overflow: hidden;
            margin-top: 5px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(45deg, #4CAF50, #45a049);
            transition: width 0.3s ease;
        }

        .trend-up { color: #4CAF50; }
        .trend-down { color: #f44336; }
        .trend-neutral { color: #FFD700; }

        /* ë‚ ì”¨ë³„ íŠ¸ë Œë“œ ìƒ‰ìƒ */
        body.weather-sunny .trend-up { color: #FFD700; }
        body.weather-sunny .trend-down { color: #e74c3c; }
        body.weather-sunny .trend-neutral { color: #f39c12; }

        body.weather-rainy .trend-up { color: #3498db; }
        body.weather-rainy .trend-down { color: #e74c3c; }
        body.weather-rainy .trend-neutral { color: #95a5a6; }

        body.weather-foggy .trend-up { color: #95a5a6; }
        body.weather-foggy .trend-down { color: #7f8c8d; }
        body.weather-foggy .trend-neutral { color: #bdc3c7; }

        body.weather-snowy .trend-up { color: #bdc3c7; }
        body.weather-snowy .trend-down { color: #95a5a6; }
        body.weather-snowy .trend-neutral { color: #ecf0f1; }

        body.weather-storm .trend-up { color: #8e44ad; }
        body.weather-storm .trend-down { color: #e74c3c; }
        body.weather-storm .trend-neutral { color: #9b59b6; }

        body.weather-rainbow .trend-up { color: #ff6b6b; }
        body.weather-rainbow .trend-down { color: #4ecdc4; }
        body.weather-rainbow .trend-neutral { color: #feca57; }

        body.weather-hot .trend-up { color: #e74c3c; }
        body.weather-hot .trend-down { color: #f39c12; }
        body.weather-hot .trend-neutral { color: #ff7675; }

        body.weather-night .trend-up { color: #34495e; }
        body.weather-night .trend-down { color: #2c3e50; }
        body.weather-night .trend-neutral { color: #7f8c8d; }

        @media (max-width: 768px) {
            .container {
                max-width: 100vw;
                padding: 10px;
                border-radius: 0;
                margin: 0;
            }
            .header {
                padding: 10px;
                font-size: 1em;
            }
            .content-area {
                padding: 10px;
                min-height: 300px;
                font-size: 0.95em;
            }
            .left-sidebar, .right-sidebar {
                position: fixed;
                top: auto;
                bottom: 0;
                left: 0;
                right: 0;
                width: 100vw;
                flex-direction: row;
                justify-content: flex-start;
                gap: 0;
                transform: none;
                z-index: 1001;
                background: rgba(255,255,255,0.7);
                border-radius: 0;
                box-shadow: 0 -2px 12px rgba(0,0,0,0.08);
                padding: 2px 0;
                height: auto;
                min-height: 48px;
                pointer-events: auto;
                display: flex !important;
                flex-wrap: nowrap;
                overflow-x: auto;
                white-space: nowrap;
            }
            .left-sidebar {
                right: 0;
            }
            .right-sidebar {
                left: 0;
                margin-left: 0;
            }
            body {
                padding-bottom: 56px;
            }
            .menu-card {
                display: inline-block;
                min-width: 38px;
                max-width: 44px;
                width: 11vw;
                flex: 0 0 38px;
                padding: 4px 0 2px 0;
                font-size: 0.75em;
                margin: 0 1px;
                border-radius: 10px;
            }
            .menu-card-icon {
                font-size: 1.1em;
                margin-bottom: 0;
            }
            .menu-card-title {
                font-size: 9px;
                line-height: 1.1;
            }
            .menu-card-description {
                display: none;
            }
        }
        @media (max-width: 768px) {
            .content-area,
            #inventory-content,
            #plant-inventory,
            #shop-items,
            #gear-items,
            #slot-items,
            #market-prices,
            #growth-status {
                overflow-x: auto;
                max-width: 100vw;
                box-sizing: border-box;
                display: block;
            }
            table {
                display: block;
                width: 100%;
                max-width: 100vw;
                overflow-x: auto;
                white-space: nowrap;
                border-spacing: 0;
                border-collapse: separate;
            }
            th, td {
                min-width: 70px;
                box-sizing: border-box;
                padding: 6px 4px;
            }
            .shop-menu {
                display: block;
                overflow-x: auto;
                white-space: nowrap;
                max-width: 100vw;
            }
        }
    </style>
</head>
<body>
    <!-- ì¢Œì¸¡ ì‚¬ì´ë“œë°” -->
    <div class="left-sidebar">
        <div class="menu-card" onclick="showMainMenu()">
            <span class="menu-card-icon">ğŸ </span>
            <div class="menu-card-title">ì˜¨ì‹¤ë¡œ ì´ë™</div>
            <div class="menu-card-description">ë‚˜ì˜ ì˜¨ì‹¤ì„ í™•ì¸í•˜ê³  ê´€ë¦¬í•˜ì„¸ìš”</div>
        </div>
        
        <div class="menu-card" onclick="showPlantMenu()">
            <span class="menu-card-icon">ğŸŒ±</span>
            <div class="menu-card-title">ì‹ë¬¼ ì‹¬ê¸°</div>
            <div class="menu-card-description">ì”¨ì•—ì„ ì‹¬ì–´ ìƒˆë¡œìš´ ì‹ë¬¼ì„ í‚¤ìš°ì„¸ìš”</div>
        </div>
        
        <div class="menu-card" onclick="showShop()">
            <span class="menu-card-icon">ğŸ›’</span>
            <div class="menu-card-title">ìƒì  ë°©ë¬¸</div>
            <div class="menu-card-description">ìƒˆë¡œìš´ ì”¨ì•—ê³¼ ê¸°ì–´ë¥¼ êµ¬ë§¤í•˜ì„¸ìš”</div>
        </div>
        
        <div class="menu-card" onclick="showInventory()">
            <span class="menu-card-icon">ğŸ“¦</span>
            <div class="menu-card-title">ì¸ë²¤í† ë¦¬</div>
            <div class="menu-card-description">ë³´ìœ í•œ ì•„ì´í…œë“¤ì„ í™•ì¸í•˜ì„¸ìš”</div>
        </div>
    </div>

    <!-- ìš°ì¸¡ ì‚¬ì´ë“œë°” -->
    <div class="right-sidebar">
        <div class="menu-card" onclick="showMarketPrices()">
            <span class="menu-card-icon">ğŸ“Š</span>
            <div class="menu-card-title">ì‹œì„¸ í™•ì¸</div>
            <div class="menu-card-description">í˜„ì¬ ì‹œì¥ ê°€ê²©ì„ í™•ì¸í•˜ì„¸ìš”</div>
        </div>
        
        <div class="menu-card" onclick="waitNextDay()">
            <span class="menu-card-icon">â³</span>
            <div class="menu-card-title">ë‹¤ìŒë‚  ê¸°ë‹¤ë¦¬ê¸°</div>
            <div class="menu-card-description">ì‹œê°„ì„ ê±´ë„ˆë›°ì–´ ë‹¤ìŒë‚ ë¡œ ì§„í–‰í•˜ì„¸ìš”</div>
        </div>
        
        <div class="menu-card" id="timer-menu-card">
            <span class="menu-card-icon">â°</span>
            <div class="menu-card-title">ë‹¤ìŒë‚ ê¹Œì§€</div>
            <div class="menu-card-description" id="timer-display">--:--</div>
        </div>
        
        <div class="menu-card" onclick="checkNotificationPermission()">
            <span class="menu-card-icon">ğŸ””</span>
            <div class="menu-card-title">ì•Œë¦¼ ìƒíƒœ í™•ì¸</div>
            <div class="menu-card-description">ë¸Œë¼ìš°ì € ì•Œë¦¼ ì„¤ì •ì„ í™•ì¸í•˜ì„¸ìš”</div>
        </div>
    </div>

    <div class="container">
        <div class="header">
            <h1>ğŸŒ¿ ë§ˆë²• ì˜¨ì‹¤ ê´€ë¦¬ì</h1>
            <div id="game-status">
                <div>â€” Day <span id="current-day">1</span> / <span id="current-time">6:00 AM</span> â€”</div>
                <div>Gold: ğŸ’ <span id="player-gold">100</span></div>
                <div>Slots: <span id="used-slots">0</span>/<span id="total-slots">2</span> (Empty slots: <span id="empty-slots">0</span>)</div>
                <div>Weather: <span id="current-weather">â˜€ï¸</span> <span id="weather-name">Sunny</span></div>
                <div id="weather-effect">â˜€ï¸ ë§‘ìŒ: ì¢‹ì€ í’ˆì§ˆ í™•ë¥  ì¦ê°€</div>
                <div>Next Day Cost: ğŸ’ <span id="next-day-cost">10</span></div>
                <div id="active-events"></div>
            </div>
        </div>

        <div class="content-area" id="content-area">
            <h2>ğŸŒ¿ ì˜¨ì‹¤ì— ì˜¤ì‹  ê²ƒì„ í™˜ì˜í•©ë‹ˆë‹¤!</h2>
            <br>
            <div id="plant-slots"></div>
        </div>
    </div>



    <!-- ë°ì´í„° ì´ˆê¸°í™” ë²„íŠ¼ (êµ¬ì„ì— ì‘ê²Œ ë°°ì¹˜) -->
    <div style="position: fixed; bottom: 20px; right: 20px; z-index: 1000;">
        <button onclick="clearGameData()" style="
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 8px 12px;
            font-size: 12px;
            cursor: pointer;
            opacity: 0.7;
            transition: opacity 0.3s ease;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
        " onmouseover="this.style.opacity='1'" onmouseout="this.style.opacity='0.7'">
            ğŸ—‘ï¸ ì´ˆê¸°í™”
        </button>
    </div>

    <script>
        // ê²Œì„ ìƒíƒœ
        let gameState = {
            day: 1,
            time: '6:00 AM',
            gold: 100,
            usedSlots: 0,
            totalSlots: 2,
            emptySlots: 0,
            weather: 'â˜€ï¸',
            weatherName: 'Sunny',
            inventory: [], // ì”¨ì•— ì¸ë²¤í† ë¦¬
            harvestedPlants: [], // ìˆ˜í™•í•œ ì‹ë¬¼ ì¸ë²¤í† ë¦¬
            plantedCrops: [],
            gears: [], // ê¸°ì–´ ì¸ë²¤í† ë¦¬
            lastSave: Date.now(),
            nextDayCost: 10, // ë‹¤ìŒë‚ ë¡œ ë„˜ì–´ê°€ëŠ” ë¹„ìš©
            slotCost: 10, // ìŠ¬ë¡¯ êµ¬ë§¤ ë¹„ìš©
            activeEvents: [], // í™œì„± ì´ë²¤íŠ¸ ëª©ë¡
            lastAutoProgress: Date.now(), // ìë™ ì§„í–‰ ì‹œê°„ ì¶”ì 
            autoProgressEnabled: true // ìë™ ì§„í–‰ í™œì„±í™” ì—¬ë¶€ (í•­ìƒ í™œì„±í™”)
        };

        // ë§ˆë²• ì‹ë¬¼ ë°ì´í„°
        const plants = [
            {
                id: 'herb_sprout',
                name: 'ğŸŒ± Herb Sprout',
                growTime: 10, // 10ì´ˆ
                priceRange: [10, 15],
                sellRange: [12, 18],
                description: 'ê¸°ë³¸ í—ˆë¸Œ ìƒˆì‹¹',
                rarity: 'common',
                unlockLevel: 0,
                baseStock: 8, // ê¸°ë³¸ ì¬ê³ 
                maxStock: 12 // ìµœëŒ€ ì¬ê³ 
            },
            {
                id: 'starglow_herb',
                name: 'ğŸŒŸ Starglow Herb',
                growTime: 30, // 30ì´ˆ
                priceRange: [25, 35],
                sellRange: [30, 42],
                description: 'ë³„ë¹›ì´ ê¹ƒë“  í—ˆë¸Œ',
                rarity: 'common',
                unlockLevel: 0,
                baseStock: 6,
                maxStock: 10
            },
            {
                id: 'moonflower',
                name: 'ğŸŒ™ Moonflower',
                growTime: 60, // 1ë¶„
                priceRange: [50, 70],
                sellRange: [60, 84],
                description: 'ë‹¬ë¹›ì„ í¡ìˆ˜í•˜ëŠ” ê½ƒ',
                rarity: 'uncommon',
                unlockLevel: 0,
                baseStock: 5,
                maxStock: 8
            },
            {
                id: 'crystal_rose',
                name: 'ğŸ’ Crystal Rose',
                growTime: 120, // 2ë¶„
                priceRange: [100, 130],
                sellRange: [120, 156],
                description: 'ìˆ˜ì •ì²˜ëŸ¼ ë¹›ë‚˜ëŠ” ì¥ë¯¸',
                rarity: 'uncommon',
                unlockLevel: 5,
                baseStock: 4,
                maxStock: 6
            },
            {
                id: 'phoenix_plant',
                name: 'ğŸ”¥ Phoenix Plant',
                growTime: 300, // 5ë¶„
                priceRange: [200, 250],
                sellRange: [240, 300],
                description: 'ë¶ˆì‚¬ì¡°ì˜ ë¶ˆê½ƒì„ ë‹´ì€ ì‹ë¬¼',
                rarity: 'rare',
                unlockLevel: 10,
                baseStock: 3,
                maxStock: 5
            },
            {
                id: 'dragon_fruit',
                name: 'ğŸ‰ Dragon Fruit',
                growTime: 600, // 10ë¶„
                priceRange: [400, 500],
                sellRange: [480, 600],
                description: 'ìš©ì˜ í˜ì„ ë‹´ì€ ê³¼ì¼',
                rarity: 'epic',
                unlockLevel: 20,
                baseStock: 4,
                maxStock: 6
            },
            {
                id: 'golden_tree',
                name: 'ğŸŒ³ Golden Tree',
                growTime: 1800, // 30ë¶„
                priceRange: [800, 1000],
                sellRange: [960, 1200],
                description: 'í™©ê¸ˆë¹› ì—´ë§¤ë¥¼ ë§ºëŠ” ë‚˜ë¬´',
                rarity: 'legendary',
                unlockLevel: 35,
                baseStock: 3,
                maxStock: 5
            },
            {
                id: 'eternal_bloom',
                name: 'ğŸŒ¸ Eternal Bloom',
                growTime: 3600, // 1ì‹œê°„
                priceRange: [1500, 2000],
                sellRange: [1800, 2400],
                description: 'ì˜ì›íˆ í”¼ì–´ìˆëŠ” ì‹ ë¹„í•œ ê½ƒ',
                rarity: 'mythic',
                unlockLevel: 50,
                baseStock: 2,
                maxStock: 4
            }
        ];

        // ë‚ ì”¨ ì‹œìŠ¤í…œ
        const weathers = [
            { emoji: 'â˜€ï¸', name: 'ë§‘ìŒ', effect: 'normal', class: 'weather-sunny', probability: 25 },
            { emoji: 'ğŸŒ§ï¸', name: 'ë¹„', effect: 'growth_boost', class: 'weather-rainy', probability: 20 },
            { emoji: 'ğŸŒ™', name: 'ë‹¬ë¹›', effect: 'moonlight_bonus', class: 'weather-night', probability: 15 },
            { emoji: 'ğŸŒ©ï¸', name: 'ë²ˆê°œ', effect: 'electric_charge', class: 'weather-storm', probability: 10 },
            { emoji: 'ğŸŒ«ï¸', name: 'ì•ˆê°œ', effect: 'unstable_price', class: 'weather-foggy', probability: 5 },
            { emoji: 'ğŸŒªï¸', name: 'ê°•í’', effect: 'wind_damage', class: 'weather-storm', probability: 5 },
            { emoji: 'â„ï¸', name: 'ì„œë¦¬', effect: 'frost_delay', class: 'weather-snowy', probability: 5 },
            { emoji: 'ğŸ”¥', name: 'ì—´ê¸°', effect: 'heat_growth', class: 'weather-hot', probability: 5 },
            { emoji: 'ğŸŒˆ', name: 'ë¬´ì§€ê°œ', effect: 'rainbow_rare', class: 'weather-rainbow', probability: 5 },
            { emoji: 'ğŸŒ˜', name: 'ì•”ìš´', effect: 'dark_cloud', class: 'weather-night', probability: 5 }
        ];

        // ê°€ê²© ë³€ë™ ì‹œìŠ¤í…œ
        let priceHistory = {};
        let dailyPrices = {}; // ë§¤ì¼ì˜ ì”¨ì•— ê°€ê²©
        let dailyStock = {}; // ë§¤ì¼ì˜ ì¬ê³ ëŸ‰

        // ì´ë²¤íŠ¸ ì‹œìŠ¤í…œ
        const events = [
            {
                id: 'herb_festival',
                name: 'ğŸŒ¿ í—ˆë¸Œ ì¶•ì œ',
                description: 'í—ˆë¸Œë¥˜ ì‹ë¬¼ë“¤ì˜ ìˆ˜ìš”ê°€ ê¸‰ì¦í–ˆìŠµë‹ˆë‹¤!',
                affectedPlants: ['herb_sprout', 'starglow_herb'],
                priceMultiplier: 3.0,
                duration: 1,
                probability: 0.05
            },
            {
                id: 'crystal_craze',
                name: 'ğŸ’ ìˆ˜ì • ì—´í’',
                description: 'ìˆ˜ì • ì¥ë¯¸ì˜ ì•„ë¦„ë‹¤ì›€ì´ í™”ì œê°€ ë˜ì—ˆìŠµë‹ˆë‹¤!',
                affectedPlants: ['crystal_rose'],
                priceMultiplier: 4.0,
                duration: 1,
                probability: 0.03
            },
            {
                id: 'phoenix_mania',
                name: 'ğŸ”¥ ë¶ˆì‚¬ì¡° ì—´í’',
                description: 'ë¶ˆì‚¬ì¡° ì‹ë¬¼ì˜ í¬ê·€ì„±ì´ ì£¼ëª©ë°›ê³  ìˆìŠµë‹ˆë‹¤!',
                affectedPlants: ['phoenix_plant'],
                priceMultiplier: 5.0,
                duration: 1,
                probability: 0.02
            },
            {
                id: 'dragon_fever',
                name: 'ğŸ‰ ìš©ì˜ í˜ ì—´í’',
                description: 'ìš©ê³¼ì¼ì˜ ê°•ë ¥í•œ íš¨ê³¼ê°€ í™”ì œê°€ ë˜ì—ˆìŠµë‹ˆë‹¤!',
                affectedPlants: ['dragon_fruit'],
                priceMultiplier: 4.5,
                duration: 1,
                probability: 0.02
            },
            {
                id: 'golden_boom',
                name: 'ğŸŒ³ í™©ê¸ˆ ë‚˜ë¬´ ì—´í’',
                description: 'í™©ê¸ˆ ë‚˜ë¬´ì˜ ê°€ì¹˜ê°€ ê¸‰ë“±í–ˆìŠµë‹ˆë‹¤!',
                affectedPlants: ['golden_tree'],
                priceMultiplier: 6.0,
                duration: 1,
                probability: 0.01
            },
            {
                id: 'eternal_hype',
                name: 'ğŸŒ¸ ì˜ì›ì˜ ê½ƒ ì—´í’',
                description: 'ì˜ì›ì˜ ê½ƒì˜ ì‹ ë¹„ë¡œì›€ì´ ì „ ì„¸ê³„ì— ì•Œë ¤ì¡ŒìŠµë‹ˆë‹¤!',
                affectedPlants: ['eternal_bloom'],
                priceMultiplier: 8.0,
                duration: 1,
                probability: 0.005
            },
            {
                id: 'moonlight_madness',
                name: 'ğŸŒ™ ë‹¬ë¹› ì‹ë¬¼ ì—´í’',
                description: 'ë‹¬ë¹›ì„ ë°›ëŠ” ì‹ë¬¼ë“¤ì´ íŠ¹ë³„í•œ ê°€ì¹˜ë¥¼ ì¸ì •ë°›ê³  ìˆìŠµë‹ˆë‹¤!',
                affectedPlants: ['moonflower', 'crystal_rose'],
                priceMultiplier: 2.5,
                duration: 1,
                probability: 0.04
            },
            {
                id: 'rare_plant_boom',
                name: 'ğŸŒŸ í¬ê·€ ì‹ë¬¼ ì—´í’',
                description: 'ëª¨ë“  í¬ê·€ ì‹ë¬¼ë“¤ì˜ ê°€ì¹˜ê°€ ìƒìŠ¹í–ˆìŠµë‹ˆë‹¤!',
                affectedPlants: ['crystal_rose', 'phoenix_plant', 'dragon_fruit', 'golden_tree', 'eternal_bloom'],
                priceMultiplier: 2.0,
                duration: 1,
                probability: 0.03
            }
        ];

        // ì•Œë¦¼ ê¶Œí•œ ìš”ì²­
        function requestNotificationPermission() {
            if ('Notification' in window) {
                if (Notification.permission === 'default') {
                    Notification.requestPermission().then(permission => {
                        if (permission === 'granted') {
                            showNotification('ğŸ”” ì•Œë¦¼ì´ í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤!');
                        } else if (permission === 'denied') {
                            showNotification('ğŸ”• ì•Œë¦¼ì´ ê±°ë¶€ë˜ì—ˆìŠµë‹ˆë‹¤. ë¸Œë¼ìš°ì € ì„¤ì •ì—ì„œ í—ˆìš©í•´ì£¼ì„¸ìš”.');
                        }
                    });
                } else if (Notification.permission === 'granted') {
                    showNotification('ğŸ”” ì•Œë¦¼ì´ í™œì„±í™”ë˜ì–´ ìˆìŠµë‹ˆë‹¤!');
                } else if (Notification.permission === 'denied') {
                    showNotification('ğŸ”• ì•Œë¦¼ì´ ë¹„í™œì„±í™”ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ë¸Œë¼ìš°ì € ì„¤ì •ì—ì„œ í—ˆìš©í•´ì£¼ì„¸ìš”.');
                }
            }
        }

        // ì›¹ ì•Œë¦¼ í‘œì‹œ
        function showWebNotification(title, message) {
            if ('Notification' in window && Notification.permission === 'granted') {
                const notification = new Notification(title, {
                    body: message,
                    icon: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjQiIGhlaWdodD0iNjQiIHZpZXdCb3g9IjAgMCA2NCA2NCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTMyIDhDNDAuODM2NiA4IDQ4IDE1LjE2MzQgNDggMjRWMzJINjRWMjRDNjQgMTAuNzQ1MiA1My4yNTQ4IDAgNDAgMEMyNi43NDUyIDAgMTYgMTAuNzQ1MiAxNiAyNFYzMkgyNFYyNEMyNCAxNS4xNjM0IDMxLjE2MzQgOCA0MCA4WiIgZmlsbD0iIzRDRkY1MCIvPgo8cGF0aCBkPSJNNDAgNTZDNjIuMDkxNCA1NiA4MCAzOC4wOTE0IDgwIDE2SDQ4VjU2WiIgZmlsbD0iIzRDRkY1MCIvPgo8L3N2Zz4K',
                    badge: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTEyIDJMMTMuMDkgOC4yNkwyMCA5TDEzLjA5IDkuNzRMMTIgMTZMMTAuOTEgOS43NEw0IDlMMTAuOTEgOC4yNkwxMiAyWiIgZmlsbD0iI0ZGRDcwMCIvPgo8L3N2Zz4K',
                    tag: 'plant-harvest',
                    requireInteraction: true,
                    silent: false,
                    vibrate: [200, 100, 200] // ì§„ë™ ì•Œë¦¼ (ëª¨ë°”ì¼)
                });

                // ì•Œë¦¼ í´ë¦­ ì‹œ ê²Œì„ íƒ­ìœ¼ë¡œ í¬ì»¤ìŠ¤
                notification.onclick = function() {
                    window.focus();
                    this.close();
                };

                // 10ì´ˆ í›„ ìë™ìœ¼ë¡œ ì•Œë¦¼ ë‹«ê¸°
                setTimeout(() => {
                    notification.close();
                }, 10000);
            }
        }

        // ê²Œì„ ì´ˆê¸°í™”
        function initGame() {
            const isLoaded = loadGameState();
            
            // ì €ì¥ëœ ë‚ ì”¨ê°€ ì—†ìœ¼ë©´ ê¸°ë³¸ ë‚ ì”¨ ì„¤ì •
            if (!gameState.weather || !gameState.weatherName) {
                const defaultWeather = weathers.find(w => w.emoji === 'â˜€ï¸');
                gameState.weather = defaultWeather.emoji;
                gameState.weatherName = defaultWeather.name;
            }
            
            // ì €ì¥ëœ ë‚ ì”¨ì— ë”°ë¼ ë°°ê²½ ì„¤ì •
            const currentWeather = weathers.find(w => w.emoji === gameState.weather);
            if (currentWeather) {
                document.body.className = currentWeather.class;
            } else {
                // ê¸°ë³¸ ë‚ ì”¨ ì„¤ì •
                document.body.className = 'weather-sunny';
            }
            
            updateDisplay();
            renderPlantSlots();
            startGameLoop();
            startAutoSave(); // ìë™ ì €ì¥ ì‹œì‘
            
            // ì•Œë¦¼ ê¶Œí•œ ìš”ì²­
            requestNotificationPermission();
            
            // ì´ˆê¸° ì €ì¥
            saveGameState();
        }

        // ê²Œì„ ìƒíƒœ ì €ì¥ (ê°•í™”ëœ ë²„ì „)
        function saveGameState() {
            const saveData = {
                ...gameState,
                dailyPrices: dailyPrices,
                dailyStock: dailyStock,
                lastSave: Date.now(),
                saveVersion: '1.0' // ë°ì´í„° ë²„ì „ ê´€ë¦¬
            };
            
            try {
                // ë©”ì¸ ì €ì¥
                localStorage.setItem('magicalGreenhouse', JSON.stringify(saveData));
                
                // ë°±ì—… ì €ì¥ (1ë¶„ ì „ ë°ì´í„°)
                const backupData = {
                    ...saveData,
                    isBackup: true,
                    backupTime: Date.now()
                };
                localStorage.setItem('magicalGreenhouse_backup', JSON.stringify(backupData));
                
                // ì €ì¥ ì„±ê³µ ë¡œê·¸
                console.log('ê²Œì„ ë°ì´í„° ì €ì¥ ì™„ë£Œ:', new Date().toLocaleString());
                
            } catch (error) {
                console.error('ì €ì¥ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
                showNotification('âš ï¸ ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë¸Œë¼ìš°ì € ì €ì¥ ê³µê°„ì„ í™•ì¸í•´ì£¼ì„¸ìš”.');
            }
        }

        // ìë™ ì €ì¥ ì‹œìŠ¤í…œ
        function startAutoSave() {
            // 30ì´ˆë§ˆë‹¤ ìë™ ì €ì¥
            setInterval(() => {
                saveGameState();
            }, 30000);
            
            // ë¸Œë¼ìš°ì € ì¢…ë£Œ ì‹œ ì €ì¥
            window.addEventListener('beforeunload', () => {
                saveGameState();
            });
            
            // í˜ì´ì§€ ìˆ¨ê¹€ ì‹œ ì €ì¥
            document.addEventListener('visibilitychange', () => {
                if (document.hidden) {
                    saveGameState();
                }
            });
        }

        // ê²Œì„ ìƒíƒœ ë¡œë“œ (ê°•í™”ëœ ë²„ì „)
        function loadGameState() {
            try {
                // ë©”ì¸ ë°ì´í„° ë¡œë“œ ì‹œë„
                const saved = localStorage.getItem('magicalGreenhouse');
                if (saved) {
                    const savedState = JSON.parse(saved);
                    
                    // ë°ì´í„° ë²„ì „ í™•ì¸
                    if (savedState.saveVersion === '1.0') {
                        gameState = { ...gameState, ...savedState };
                        
                        // ì €ì¥ëœ ê°€ê²© ë°ì´í„° ë¡œë“œ
                        if (savedState.dailyPrices) {
                            dailyPrices = savedState.dailyPrices;
                        }
                        
                        // ì €ì¥ëœ ì¬ê³  ë°ì´í„° ë¡œë“œ
                        if (savedState.dailyStock) {
                            dailyStock = savedState.dailyStock;
                        }
                        
                        console.log('ê²Œì„ ë°ì´í„° ë¡œë“œ ì™„ë£Œ:', new Date().toLocaleString());
                        showNotification('âœ… ê²Œì„ ë°ì´í„°ë¥¼ ì„±ê³µì ìœ¼ë¡œ ë¡œë“œí–ˆìŠµë‹ˆë‹¤!');
                        return true;
                    }
                }
                
                // ë°±ì—… ë°ì´í„° ë¡œë“œ ì‹œë„
                const backup = localStorage.getItem('magicalGreenhouse_backup');
                if (backup) {
                    const backupState = JSON.parse(backup);
                    gameState = { ...gameState, ...backupState };
                    
                    if (backupState.dailyPrices) {
                        dailyPrices = backupState.dailyPrices;
                    }
                    
                    if (backupState.dailyStock) {
                        dailyStock = backupState.dailyStock;
                    }
                    
                    console.log('ë°±ì—… ë°ì´í„° ë¡œë“œ ì™„ë£Œ:', new Date().toLocaleString());
                    showNotification('âš ï¸ ë°±ì—… ë°ì´í„°ë¥¼ ë¡œë“œí–ˆìŠµë‹ˆë‹¤. ì¼ë¶€ ì§„í–‰ ìƒí™©ì´ ì†ì‹¤ë˜ì—ˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
                    return true;
                }
                
                // ìƒˆ ê²Œì„ ì‹œì‘
                console.log('ìƒˆ ê²Œì„ ì‹œì‘:', new Date().toLocaleString());
                showNotification('ğŸŒ± ìƒˆë¡œìš´ ì˜¨ì‹¤ì„ ì‹œì‘í•©ë‹ˆë‹¤!');
                return false;
                
            } catch (error) {
                console.error('ë°ì´í„° ë¡œë“œ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
                showNotification('âŒ ë°ì´í„° ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ìƒˆ ê²Œì„ì„ ì‹œì‘í•©ë‹ˆë‹¤.');
                return false;
            }
        }

        // ë‚ ì”¨ íš¨ê³¼ ì„¤ëª… ê°€ì ¸ì˜¤ê¸°
        function getWeatherEffectDescription(weatherEmoji) {
            const weatherEffects = {
                'â˜€ï¸': 'ì¢‹ì€ í’ˆì§ˆ í™•ë¥  ì¦ê°€ (+10%)',
                'ğŸŒ§ï¸': 'ì„±ì¥ ì†ë„ 50% ì¦ê°€, ì¢‹ì€ í’ˆì§ˆ í™•ë¥  ì¦ê°€ (+15%)',
                'ğŸŒ™': 'íŒë§¤ê°€ 2ë°° íš¨ê³¼ (20% í™•ë¥ ), ì¢‹ì€ í’ˆì§ˆ í™•ë¥  ì¦ê°€ (+20%)',
                'ğŸŒ©ï¸': 'íŒë§¤ê°€ 3ë°° íš¨ê³¼ (15% í™•ë¥ ), ì¢‹ì€ í’ˆì§ˆ í™•ë¥  ì¦ê°€ (+25%)',
                'ğŸŒ«ï¸': 'ìˆ˜í™•ê°€ ë¶ˆì•ˆì • (50~150%), í’ˆì§ˆ í™•ë¥  ê°ì†Œ (-10%)',
                'ğŸŒªï¸': 'ì‘ë¬¼ ì†ì‹¤ ìœ„í—˜ (25% í™•ë¥ ), í’ˆì§ˆ í™•ë¥  ê°ì†Œ (-15%)',
                'â„ï¸': 'ì„±ì¥ ì •ì§€, ë³´ì¡´ ê¸°ê°„ 1ì¼ ì¦ê°€, í’ˆì§ˆ í™•ë¥  ê°ì†Œ (-5%)',
                'ğŸ”¥': 'ì„±ì¥ ì†ë„ 2ë°°, ì‹œë“¤ ìœ„í—˜, ì¢‹ì€ í’ˆì§ˆ í™•ë¥  ì¦ê°€ (+15%)',
                'ğŸŒˆ': 'í¬ê·€ì„± ë¶€ì—¬ (íŒë§¤ê°€+40%, ì„±ì¥+20%), ì¢‹ì€ í’ˆì§ˆ í™•ë¥  ì¦ê°€ (+30%)',
                'ğŸŒ˜': 'ë³µí•© íš¨ê³¼, ì¢‹ì€ í’ˆì§ˆ í™•ë¥  ì¦ê°€ (+5%)'
            };
            return weatherEffects[weatherEmoji] || 'íš¨ê³¼ ì—†ìŒ';
        }

        // í™”ë©´ ì—…ë°ì´íŠ¸
        function updateDisplay() {
            document.getElementById('current-day').textContent = gameState.day;
            document.getElementById('current-time').textContent = gameState.time;
            document.getElementById('player-gold').textContent = gameState.gold;
            document.getElementById('used-slots').textContent = gameState.usedSlots;
            document.getElementById('total-slots').textContent = gameState.totalSlots;
            document.getElementById('empty-slots').textContent = gameState.emptySlots;
            document.getElementById('current-weather').textContent = gameState.weather;
            document.getElementById('weather-name').textContent = gameState.weatherName;
            document.getElementById('next-day-cost').textContent = gameState.nextDayCost;
            
            // ë‚ ì”¨ íš¨ê³¼ í‘œì‹œ
            const weatherEffect = getWeatherEffectDescription(gameState.weather);
            document.getElementById('weather-effect').textContent = `${gameState.weather} ${gameState.weatherName}: ${weatherEffect}`;
            
            // í™œì„± ì´ë²¤íŠ¸ í‘œì‹œ
            const activeEventsDiv = document.getElementById('active-events');
            if (gameState.activeEvents.length > 0) {
                let eventsHtml = '<div style="margin-top: 10px; padding: 8px; background: rgba(255, 107, 107, 0.2); border-radius: 5px; border: 1px solid #FF6B6B;">';
                eventsHtml += '<strong>ğŸ‰ í™œì„± ì´ë²¤íŠ¸:</strong><br>';
                gameState.activeEvents.forEach(event => {
                    const remainingDays = event.endDay - gameState.day;
                    eventsHtml += `â€¢ ${event.name} (${remainingDays}ì¼ ë‚¨ìŒ)<br>`;
                });
                eventsHtml += '</div>';
                activeEventsDiv.innerHTML = eventsHtml;
            } else {
                activeEventsDiv.innerHTML = '';
            }
            
            // íƒ€ì´ë¨¸ ì—…ë°ì´íŠ¸
            updateTimer();
            
            // ìë™ ì§„í–‰ ìƒíƒœ ì—…ë°ì´íŠ¸
            updateAutoProgressStatus();
            
            // íƒ€ì´ë¨¸ ë‚ ì”¨ ìŠ¤íƒ€ì¼ ì—…ë°ì´íŠ¸
            updateTimerWeatherStyle();
        }

        // ì‹œê°„ í¬ë§·íŒ… í•¨ìˆ˜
        function formatTime(seconds) {
            if (seconds < 60) {
                return `${seconds}ì´ˆ`;
            } else if (seconds < 3600) {
                const minutes = Math.floor(seconds / 60);
                const remainingSeconds = seconds % 60;
                return remainingSeconds > 0 ? `${minutes}ë¶„ ${remainingSeconds}ì´ˆ` : `${minutes}ë¶„`;
            } else {
                const hours = Math.floor(seconds / 3600);
                const remainingMinutes = Math.floor((seconds % 3600) / 60);
                return remainingMinutes > 0 ? `${hours}ì‹œê°„ ${remainingMinutes}ë¶„` : `${hours}ì‹œê°„`;
            }
        }

        // ì‹ë¬¼ ìŠ¬ë¡¯ ë Œë”ë§
        function renderPlantSlots() {
            const slotsContainer = document.getElementById('plant-slots');
            slotsContainer.innerHTML = '<h3>ğŸŒ± ë‚˜ì˜ ì˜¨ì‹¤:</h3><div class="slots-container"></div>';
            
            const slotsInnerContainer = slotsContainer.querySelector('.slots-container');
            
            for (let i = 0; i < gameState.totalSlots; i++) {
                const slot = document.createElement('div');
                slot.className = 'plant-slot';
                
                const plantedCrop = gameState.plantedCrops[i];
                if (plantedCrop) {
                    const plant = plants.find(p => p.id === plantedCrop.plantId);
                    const progress = (Date.now() - plantedCrop.plantTime) / (plant.growTime * 1000);
                    
                    if (progress >= 1) {
                        slot.className = 'plant-slot ready';
                        slot.innerHTML = `${plant.name}<br><small>ìˆ˜í™• ê°€ëŠ¥!</small>`;
                    } else {
                        slot.className = 'plant-slot growing';
                        const remainingTime = Math.max(0, plant.growTime - (Date.now() - plantedCrop.plantTime) / 1000);
                        slot.innerHTML = `${plant.name}<br><small>${Math.round(progress * 100)}% â€¢ ${formatTime(Math.ceil(remainingTime))}</small>`;
                    }
                } else {
                    slot.innerHTML = 'ğŸŒ±<br><small>ë¹ˆ ìŠ¬ë¡¯</small>';
                }
                
                slot.onclick = () => handleSlotClick(i);
                slotsInnerContainer.appendChild(slot);
            }
        }

        // ìŠ¬ë¡¯ í´ë¦­ ì²˜ë¦¬
        function handleSlotClick(slotIndex) {
            const plantedCrop = gameState.plantedCrops[slotIndex];
            if (plantedCrop) {
                const plant = plants.find(p => p.id === plantedCrop.plantId);
                const progress = (Date.now() - plantedCrop.plantTime) / (plant.growTime * 1000);
                
                if (progress >= 1) {
                    harvestPlant(slotIndex);
                } else {
                    // ê¸°ì–´ ì‚¬ìš© ë©”ë‰´ í‘œì‹œ
                    showGearMenu(slotIndex, plantedCrop, plant);
                }
            } else {
                showPlantMenu();
            }
        }

        // ê¸°ì–´ ì‚¬ìš© ë©”ë‰´
        function showGearMenu(slotIndex, plantedCrop, plant) {
            const remainingTime = Math.max(0, plant.growTime - (Date.now() - plantedCrop.plantTime) / 1000);
            const progress = (Date.now() - plantedCrop.plantTime) / (plant.growTime * 1000);
            
            const contentArea = document.getElementById('content-area');
            contentArea.innerHTML = `
                <button class="back-button" onclick="showMainMenu()">â† ë’¤ë¡œ ê°€ê¸°</button>
                <h2>ğŸŒ± ${plant.name} ê´€ë¦¬</h2>
                <p>ì„±ì¥ë¥ : ${Math.round(progress * 100)}% (${formatTime(Math.ceil(remainingTime))} ë‚¨ìŒ)</p>
                <div id="gear-menu"></div>
            `;
            
            renderGearMenu(slotIndex, plantedCrop, plant);
        }

        // ê¸°ì–´ ë©”ë‰´ ë Œë”ë§
        function renderGearMenu(slotIndex, plantedCrop, plant) {
            const gearMenu = document.getElementById('gear-menu');
            
            if (gameState.gears.length === 0) {
                gearMenu.innerHTML = `
                    <p>ë³´ìœ í•œ ê¸°ì–´ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
                    <p>ìƒì ì—ì„œ ê¸°ì–´ë¥¼ êµ¬ë§¤í•˜ì—¬ ì„±ì¥ì„ ê°€ì†í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!</p>
                `;
                return;
            }
            
            let html = '<h3>âš™ï¸ ì‚¬ìš© ê°€ëŠ¥í•œ ê¸°ì–´</h3><table><tr><th>ê¸°ì–´</th><th>ìˆ˜ëŸ‰</th><th>íš¨ê³¼</th><th>ì•¡ì…˜</th></tr>';
            
            gameState.gears.forEach(gear => {
                html += `
                    <tr>
                        <td>${gear.name}</td>
                        <td>${gear.count}ê°œ</td>
                        <td>${gear.effect}</td>
                        <td><button onclick="useGear('${gear.id}', ${slotIndex})" ${gear.count <= 0 ? 'disabled' : ''}>ì‚¬ìš©</button></td>
                    </tr>
                `;
            });
            
            html += '</table>';
            gearMenu.innerHTML = html;
        }

        // ê¸°ì–´ ì‚¬ìš©
        function useGear(gearId, slotIndex) {
            const gear = gameState.gears.find(g => g.id === gearId);
            const plantedCrop = gameState.plantedCrops[slotIndex];
            const plant = plants.find(p => p.id === plantedCrop.plantId);
            
            if (!gear || gear.count <= 0) {
                showNotification('âŒ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ê¸°ì–´ê°€ ì—†ìŠµë‹ˆë‹¤!');
                return;
            }
            
            // ê¸°ì–´ íš¨ê³¼ ì ìš©
            let growthBoost = 0;
            switch (gearId) {
                case 'water_sprinkler':
                    growthBoost = 0.1; // 10% ì„±ì¥ ê°€ì†
                    break;
                case 'sunlight_lamp':
                    growthBoost = 0.2; // 20% ì„±ì¥ ê°€ì†
                    break;
                case 'magic_fertilizer':
                    growthBoost = 0.3; // 30% ì„±ì¥ ê°€ì†
                    break;
                case 'time_accelerator':
                    growthBoost = 0.5; // 50% ì„±ì¥ ê°€ì†
                    break;
            }
            
            // ì„±ì¥ ì‹œê°„ ë‹¨ì¶•
            const timeReduction = plant.growTime * growthBoost;
            plantedCrop.plantTime -= timeReduction * 1000; // ë°€ë¦¬ì´ˆ ë‹¨ìœ„ë¡œ ë³€í™˜
            
            // ê¸°ì–´ ì‚¬ìš©
            gear.count--;
            if (gear.count <= 0) {
                gameState.gears = gameState.gears.filter(g => g.id !== gearId);
            }
            
            const remainingTime = Math.max(0, plant.growTime - (Date.now() - plantedCrop.plantTime) / 1000);
            showNotification(`âš™ï¸ ${gear.name}ì„(ë¥¼) ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤! ${plant.name}ì˜ ì„±ì¥ì´ ê°€ì†í™”ë˜ì—ˆìŠµë‹ˆë‹¤! (${formatTime(Math.ceil(remainingTime))} ë‚¨ìŒ)`);
            
            updateDisplay();
            renderPlantSlots();
            saveGameState();
        }

        // ì‹ë¬¼ ìˆ˜í™•
        function harvestPlant(slotIndex) {
            const plantedCrop = gameState.plantedCrops[slotIndex];
            const plant = plants.find(p => p.id === plantedCrop.plantId);
            
            // í’ˆì§ˆ ê³„ì‚° (ë‚ ì”¨ì™€ ì‹œê°„ì— ë”°ë¥¸ í’ˆì§ˆ ë³€í™”)
            let quality = 'normal';
            const random = Math.random();
            
            // ë‚ ì”¨ì— ë”°ë¥¸ í’ˆì§ˆ ë³´ë„ˆìŠ¤ (ìƒˆë¡œìš´ ì‹œìŠ¤í…œ)
            const weatherBonus = {
                'â˜€ï¸': 0.1, // ë§‘ìŒ - ì¢‹ì€ í’ˆì§ˆ í™•ë¥  ì¦ê°€
                'ğŸŒ§ï¸': 0.15, // ë¹„ - ì„±ì¥ ì†ë„ +50% íš¨ê³¼
                'ğŸŒ™': 0.2, // ë‹¬ë¹› - íŒë§¤ê°€ 2ë°° íš¨ê³¼
                'ğŸŒ©ï¸': 0.25, // ë²ˆê°œ - íŒë§¤ê°€ 3ë°° íš¨ê³¼
                'ğŸŒ«ï¸': -0.1, // ì•ˆê°œ - ìˆ˜í™•ê°€ ë¶ˆì•ˆì •
                'ğŸŒªï¸': -0.15, // ê°•í’ - ì‘ë¬¼ ì†ì‹¤ ìœ„í—˜
                'â„ï¸': -0.05, // ì„œë¦¬ - ì„±ì¥ ì •ì§€
                'ğŸ”¥': 0.15, // ì—´ê¸° - ì„±ì¥ ì†ë„ 2ë°°
                'ğŸŒˆ': 0.3, // ë¬´ì§€ê°œ - í¬ê·€ì„± ë¶€ì—¬
                'ğŸŒ˜': 0.05 // ì•”ìš´ - ë³µí•© íš¨ê³¼
            };
            
            const currentWeather = gameState.weather;
            const weatherModifier = weatherBonus[currentWeather] || 0;
            
            // ìˆ˜ì •ëœ í™•ë¥ ë¡œ í’ˆì§ˆ ê²°ì • (ë³´í†µ í’ˆì§ˆ ë¹„ì¤‘ ì¦ê°€)
            const adjustedRandom = random + weatherModifier;
            
            if (adjustedRandom > 0.9) {
                quality = 'perfect';
            } else if (adjustedRandom > 0.75) {
                quality = 'good';
            } else {
                quality = 'normal';
            }
            
            // íŠ¹ë³„ íš¨ê³¼ ì ìš©
            let specialEffect = '';
            switch (currentWeather) {
                case 'ğŸŒ™': // ë‹¬ë¹›
                    if (Math.random() < 0.2) {
                        specialEffect = ' (ë‹¬ë¹› íš¨ê³¼: íŒë§¤ê°€ 2ë°°)';
                    }
                    break;
                case 'ğŸŒ©ï¸': // ë²ˆê°œ
                    if (Math.random() < 0.15) {
                        specialEffect = ' (ë²ˆê°œ ì¶©ì „: íŒë§¤ê°€ 3ë°°)';
                    }
                    break;
                case 'ğŸŒˆ': // ë¬´ì§€ê°œ
                    specialEffect = ' (ë¬´ì§€ê°œ íš¨ê³¼: í¬ê·€ì„± ë¶€ì—¬)';
                    break;
            }
            
            // ìˆ˜í™•í•œ ì‹ë¬¼ì„ ì¸ë²¤í† ë¦¬ì— ì¶”ê°€
            gameState.harvestedPlants.push({
                plantId: plantedCrop.plantId,
                harvestTime: Date.now(),
                quality: quality,
                specialEffect: specialEffect
            });
            
            gameState.plantedCrops.splice(slotIndex, 1);
            gameState.usedSlots--;
            
            const qualityEmoji = quality === 'perfect' ? 'âœ¨' : quality === 'good' ? 'â­' : 'ğŸŒ±';
            const qualityText = quality === 'perfect' ? 'ì™„ë²½' : quality === 'good' ? 'ì¢‹ìŒ' : 'ë³´í†µ';
            
            showNotification(`ğŸŒ± ${plant.name} (${qualityEmoji} ${qualityText})ì„(ë¥¼) ìˆ˜í™•í–ˆìŠµë‹ˆë‹¤!${specialEffect} ì¸ë²¤í† ë¦¬ì— ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.`);
            updateDisplay();
            renderPlantSlots();
            saveGameState();
        }

        // ì‹ë¬¼ ì‹¬ê¸° ë©”ë‰´
        function showPlantMenu() {
            const contentArea = document.getElementById('content-area');
            contentArea.innerHTML = `
                <button class="back-button" onclick="showMainMenu()">â† ë’¤ë¡œ ê°€ê¸°</button>
                <h2>ğŸŒ± ì‹ë¬¼ ì‹¬ê¸°</h2>
                <p>ì¸ë²¤í† ë¦¬ì—ì„œ ì‹¬ì„ ì‹ë¬¼ì„ ì„ íƒí•˜ì„¸ìš”.</p>
                <div id="plant-inventory"></div>
            `;
            
            renderPlantInventory();
        }

        // ì‹¬ê¸°ìš© ì¸ë²¤í† ë¦¬ ë Œë”ë§
        function renderPlantInventory() {
            const plantInventory = document.getElementById('plant-inventory');
            if (gameState.inventory.length === 0) {
                plantInventory.innerHTML = '<p>ì”¨ì•—ì´ ì—†ìŠµë‹ˆë‹¤. ìƒì ì—ì„œ ì”¨ì•—ì„ êµ¬ë§¤í•˜ì„¸ìš”!</p>';
                return;
            }
            
            let html = '<table><tr><th>ì‹ë¬¼</th><th>ìˆ˜ëŸ‰</th><th>ì•¡ì…˜</th></tr>';
            
            const inventoryCount = {};
            gameState.inventory.forEach(item => {
                inventoryCount[item] = (inventoryCount[item] || 0) + 1;
            });
            
            Object.entries(inventoryCount).forEach(([plantId, count]) => {
                const plant = plants.find(p => p.id === plantId);
                html += `
                    <tr>
                        <td>${plant.name}</td>
                        <td>${count}</td>
                        <td><button onclick="plantSeed('${plantId}')" ${gameState.usedSlots >= gameState.totalSlots ? 'disabled' : ''}>ì‹¬ê¸°</button></td>
                    </tr>
                `;
            });
            
            html += '</table>';
            plantInventory.innerHTML = html;
        }

        // ì¸ë²¤í† ë¦¬ í‘œì‹œ
        function showInventory() {
            const contentArea = document.getElementById('content-area');
            contentArea.innerHTML = `
                <button class="back-button" onclick="showMainMenu()">â† ë’¤ë¡œ ê°€ê¸°</button>
                <h2>ğŸ“¦ ì¸ë²¤í† ë¦¬</h2>
                <br>
                <div id="inventory-content"></div>
            `;
            
            renderInventory();
        }

        // ì¸ë²¤í† ë¦¬ ë Œë”ë§
        function renderInventory() {
            const inventoryContent = document.getElementById('inventory-content');
            
            // ì”¨ì•— ì¸ë²¤í† ë¦¬
            let seedHtml = '<h3>ğŸŒ± ì”¨ì•— ì¸ë²¤í† ë¦¬</h3>';
            if (gameState.inventory.length === 0) {
                seedHtml += '<p>ì”¨ì•—ì´ ì—†ìŠµë‹ˆë‹¤. ìƒì ì—ì„œ ì”¨ì•—ì„ êµ¬ë§¤í•˜ì„¸ìš”!</p>';
            } else {
                seedHtml += '<table><tr><th>ì‹ë¬¼</th><th>ìˆ˜ëŸ‰</th><th>ì•¡ì…˜</th></tr>';
                
                const inventoryCount = {};
                gameState.inventory.forEach(item => {
                    inventoryCount[item] = (inventoryCount[item] || 0) + 1;
                });
                
                Object.entries(inventoryCount).forEach(([plantId, count]) => {
                    const plant = plants.find(p => p.id === plantId);
                    seedHtml += `
                        <tr>
                            <td>${plant.name}</td>
                            <td>${count}</td>
                            <td><button onclick="plantSeed('${plantId}')" ${gameState.usedSlots >= gameState.totalSlots ? 'disabled' : ''}>ì‹¬ê¸°</button></td>
                        </tr>
                    `;
                });
                
                seedHtml += '</table>';
            }
            
            // ìˆ˜í™•í•œ ì‹ë¬¼ ì¸ë²¤í† ë¦¬
            let harvestedHtml = '<h3>ğŸŒ¸ ìˆ˜í™•í•œ ì‹ë¬¼</h3>';
            if (gameState.harvestedPlants.length === 0) {
                harvestedHtml += '<p>ìˆ˜í™•í•œ ì‹ë¬¼ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
            } else {
                harvestedHtml += '<table><tr><th>ì‹ë¬¼</th><th>ìˆ˜ëŸ‰</th><th>í’ˆì§ˆ</th><th>í˜„ì¬ íŒë§¤ê°€</th><th>êµ¬ë§¤ê°€</th><th>ì•¡ì…˜</th></tr>';
                
                const harvestedCount = {};
                gameState.harvestedPlants.forEach(plant => {
                    if (!harvestedCount[plant.plantId]) {
                        harvestedCount[plant.plantId] = { count: 0, quality: plant.quality };
                    }
                    harvestedCount[plant.plantId].count++;
                });
                
                Object.entries(harvestedCount).forEach(([plantId, data]) => {
                    const plant = plants.find(p => p.id === plantId);
                    const qualityEmoji = data.quality === 'perfect' ? 'âœ¨' : data.quality === 'good' ? 'â­' : 'ğŸŒ±';
                    const qualityText = data.quality === 'perfect' ? 'ì™„ë²½' : data.quality === 'good' ? 'ì¢‹ìŒ' : 'ë³´í†µ';
                    const currentSellPrice = getCurrentSellPrice(plant);
                    const qualityPrice = getQualityPrice(currentSellPrice, data.quality, data.specialEffect || '');
                    const eventPrice = getEventPrice(qualityPrice, plantId);
                    const buyPrice = (plant.priceRange[0] + plant.priceRange[1]) / 2; // í‰ê·  êµ¬ë§¤ê°€
                    
                    let effectText = '';
                    if (data.specialEffect) {
                        effectText = `<br><small style="color: #FFD700;">${data.specialEffect}</small>`;
                    }
                    
                    // ì´ë²¤íŠ¸ ë³´ë„ˆìŠ¤ í‘œì‹œ
                    let eventBonusText = '';
                    if (eventPrice > qualityPrice) {
                        eventBonusText = `<br><small style="color: #FF6B6B; font-weight: bold;">ğŸ‰ ì´ë²¤íŠ¸ ë³´ë„ˆìŠ¤: +${eventPrice - qualityPrice}</small>`;
                    }
                    
                    harvestedHtml += `
                        <tr>
                            <td>${plant.name}${effectText}</td>
                            <td>${data.count}</td>
                            <td>${qualityEmoji} ${qualityText}</td>
                            <td>ğŸ’ ${eventPrice}${eventBonusText}</td>
                            <td>ğŸ’ ${Math.floor(buyPrice)}</td>
                            <td><button onclick="sellPlant('${plantId}')">íŒë§¤</button></td>
                        </tr>
                    `;
                });
                
                harvestedHtml += '</table>';
            }
            
            // ê¸°ì–´ ì¸ë²¤í† ë¦¬
            let gearHtml = '<h3>âš™ï¸ ê¸°ì–´</h3>';
            if (gameState.gears.length === 0) {
                gearHtml += '<p>ë³´ìœ í•œ ê¸°ì–´ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
            } else {
                gearHtml += '<table><tr><th>ê¸°ì–´</th><th>ìˆ˜ëŸ‰</th><th>íš¨ê³¼</th></tr>';
                
                gameState.gears.forEach(gear => {
                    gearHtml += `
                        <tr>
                            <td>${gear.name}</td>
                            <td>${gear.count}ê°œ</td>
                            <td>${gear.effect}</td>
                        </tr>
                    `;
                });
                
                gearHtml += '</table>';
            }
            
            inventoryContent.innerHTML = seedHtml + '<br>' + harvestedHtml + '<br>' + gearHtml;
        }

        // ì”¨ì•— ì‹¬ê¸°
        function plantSeed(plantId) {
            if (gameState.usedSlots >= gameState.totalSlots) {
                showNotification('âŒ ë” ì´ìƒ ì‹¬ì„ ìŠ¬ë¡¯ì´ ì—†ìŠµë‹ˆë‹¤!');
                return;
            }
            
            const plantIndex = gameState.inventory.indexOf(plantId);
            if (plantIndex === -1) {
                showNotification('âŒ í•´ë‹¹ ì”¨ì•—ì´ ì¸ë²¤í† ë¦¬ì— ì—†ìŠµë‹ˆë‹¤!');
                return;
            }
            
            gameState.inventory.splice(plantIndex, 1);
            gameState.plantedCrops.push({
                plantId: plantId,
                plantTime: Date.now()
            });
            gameState.usedSlots++;
            
            const plant = plants.find(p => p.id === plantId);
            showNotification(`ğŸŒ± ${plant.name}ì„(ë¥¼) ì‹¬ì—ˆìŠµë‹ˆë‹¤!`);
            
            updateDisplay();
            renderPlantSlots();
            
            // ì¦‰ì‹œ í˜„ì¬ í™”ë©´ ì—…ë°ì´íŠ¸ (í˜„ì¬ í™”ë©´ì— ë§ê²Œ ê°•ì œ ì—…ë°ì´íŠ¸)
            const currentContent = document.getElementById('content-area').innerHTML;
            
            // í˜„ì¬ í™”ë©´ì´ ì¸ë²¤í† ë¦¬ì¸ ê²½ìš°
            if (currentContent.includes('ğŸ“¦ ì¸ë²¤í† ë¦¬')) {
                renderInventory();
            }
            // í˜„ì¬ í™”ë©´ì´ ì‹ë¬¼ ì‹¬ê¸°ì¸ ê²½ìš°
            else if (currentContent.includes('ì‹ë¬¼ ì‹¬ê¸°')) {
                renderPlantInventory();
            }
            // ë‘˜ ë‹¤ ì—…ë°ì´íŠ¸ (ì•ˆì „ì¥ì¹˜)
            else {
                renderInventory();
                renderPlantInventory();
            }
            
            saveGameState();
        }

        // ìƒì  ë©”ë‰´ í‘œì‹œ
        function showShop() {
            const contentArea = document.getElementById('content-area');
            contentArea.innerHTML = `
                <button class="back-button" onclick="showMainMenu()">â† ë’¤ë¡œ ê°€ê¸°</button>
                <h2>ğŸ›’ ë§ˆë²• ìƒì </h2>
                <p>ì–´ë–¤ ìƒì ì„ ë°©ë¬¸í•˜ì‹œê² ìŠµë‹ˆê¹Œ?</p>
                <div class="shop-menu">
                    <div class="menu-card" onclick="showSeedShop()">
                        <span class="menu-card-icon">ğŸŒ¸</span>
                        <div class="menu-card-title">ì”¨ì•— ìƒì </div>
                        <div class="menu-card-description">ë‹¤ì–‘í•œ ë§ˆë²• ì”¨ì•—ì„ êµ¬ë§¤í•˜ì„¸ìš”</div>
                    </div>
                    <div class="menu-card" onclick="showGearShop()">
                        <span class="menu-card-icon">âš™ï¸</span>
                        <div class="menu-card-title">ê¸°ì–´ ìƒì </div>
                        <div class="menu-card-description">ì„±ì¥ì„ ê°€ì†í™”í•˜ëŠ” ê¸°ì–´ë¥¼ êµ¬ë§¤í•˜ì„¸ìš”</div>
                    </div>
                    <div class="menu-card" onclick="showSlotShop()">
                        <span class="menu-card-icon">ğŸ¡</span>
                        <div class="menu-card-title">ì˜¨ì‹¤ í™•ì¥</div>
                        <div class="menu-card-description">ì˜¨ì‹¤ ìŠ¬ë¡¯ì„ ì¶”ê°€ë¡œ êµ¬ë§¤í•˜ì„¸ìš”</div>
                    </div>
                </div>
            `;
        }

        // ì”¨ì•— ìƒì  í‘œì‹œ
        function showSeedShop() {
            const contentArea = document.getElementById('content-area');
            contentArea.innerHTML = `
                <button class="back-button" onclick="showShop()">â† ë’¤ë¡œ ê°€ê¸°</button>
                <h2>ğŸŒ¸ ì”¨ì•— ìƒì </h2>
                <p>ì˜¤ëŠ˜ì˜ ì”¨ì•— ê°€ê²©ì…ë‹ˆë‹¤. ê°€ê²©ì€ ë§¤ì¼ ë³€ë™ë©ë‹ˆë‹¤.</p>
                <div id="shop-items"></div>
            `;
            
            renderSeedShop();
        }

        // ì”¨ì•— ìƒì  ë Œë”ë§
        function renderSeedShop() {
            const shopItems = document.getElementById('shop-items');
            let html = `
                <table>
                    <tr>
                        <th>ğŸŒ¸ ì‹ë¬¼ ì´ë¦„</th>
                        <th>â³ ì„±ì¥ ì‹œê°„</th>
                        <th>ğŸ’ êµ¬ë§¤ ê°€ê²©</th>
                        <th>ğŸ’ íŒë§¤ ê°€ê²©</th>
                        <th>ğŸ“¦ ì¬ê³ </th>
                        <th>ğŸ” ì„¤ëª…</th>
                        <th>ğŸ“ˆ ê°€ê²© ë³€í™”</th>
                        <th>ğŸ›’ êµ¬ë§¤</th>
                    </tr>
            `;
            
            plants.forEach(plant => {
                const currentBuyPrice = getCurrentBuyPrice(plant);
                const currentSellPrice = getCurrentSellPrice(plant);
                const currentStock = getCurrentStock(plant);
                const trend = getPriceTrend(plant.id);
                const trendEmoji = trend > 0 ? 'ğŸ“ˆ' : trend < 0 ? 'ğŸ“‰' : 'â–';
                const trendClass = trend > 0 ? 'trend-up' : trend < 0 ? 'trend-down' : 'trend-neutral';
                
                // ì–´ì œ êµ¬ë§¤ê°€ê²©ê³¼ ë¹„êµ
                const yesterday = gameState.day - 1;
                const yesterdayPrice = dailyPrices[yesterday] ? dailyPrices[yesterday][plant.id + '_buy'] : null;
                let priceChangeText = '';
                
                if (yesterdayPrice) {
                    const change = currentBuyPrice - yesterdayPrice;
                    const changePercent = Math.round((change / yesterdayPrice) * 100);
                    if (change > 0) {
                        priceChangeText = `<span style="color: #27ae60; font-weight: bold;">+${change} (+${changePercent}%) ğŸ“ˆ</span>`;
                    } else if (change < 0) {
                        priceChangeText = `<span style="color: #e74c3c; font-weight: bold;">${change} (${changePercent}%) ğŸ“‰</span>`;
                    } else {
                        priceChangeText = `<span style="color: #f39c12; font-weight: bold;">ë³€í™” ì—†ìŒ â–</span>`;
                    }
                } else {
                    priceChangeText = `<span style="color: #f39c12; font-weight: bold;">ìƒˆë¡œìš´ ê°€ê²© â–</span>`;
                }
                
                // ì¬ê³  ìƒíƒœ í‘œì‹œ
                let stockText = '';
                if (currentStock === 0) {
                    stockText = '<span style="color: #e74c3c; font-weight: bold;">í’ˆì ˆ</span>';
                } else if (currentStock <= 3) {
                    stockText = `<span style="color: #f39c12; font-weight: bold;">${currentStock}ê°œ (ë¶€ì¡±)</span>`;
                } else {
                    stockText = `${currentStock}ê°œ`;
                }
                
                html += `
                    <tr>
                        <td><span style="cursor: pointer; text-decoration: underline;" onclick="showPriceGraph('${plant.id}')">${plant.name}</span></td>
                        <td>${formatTime(plant.growTime)}</td>
                        <td>ğŸ’ ${currentBuyPrice}</td>
                        <td>ğŸ’ ${currentSellPrice}</td>
                        <td>${stockText}</td>
                        <td>${plant.description}</td>
                        <td class="${trendClass}">${priceChangeText}</td>
                        <td><button onclick="buySeed('${plant.id}')" ${gameState.gold < currentBuyPrice || currentStock === 0 ? 'disabled' : ''}>${currentStock === 0 ? 'í’ˆì ˆ' : 'êµ¬ë§¤'}</button></td>
                    </tr>
                `;
            });
            
            html += '</table>';
            shopItems.innerHTML = html;
        }

        // í˜„ì¬ êµ¬ë§¤ê°€ê²© ê³„ì‚°
        function getCurrentBuyPrice(plant) {
            // ì˜¤ëŠ˜ ë‚ ì§œë¥¼ í‚¤ë¡œ ì‚¬ìš©
            const today = gameState.day;
            
            // ì´ë¯¸ ê³„ì‚°ëœ êµ¬ë§¤ê°€ê²©ì´ ìˆìœ¼ë©´ ë°˜í™˜
            if (dailyPrices[today] && dailyPrices[today][plant.id + '_buy']) {
                return dailyPrices[today][plant.id + '_buy'];
            }
            
            // ìƒˆë¡œìš´ êµ¬ë§¤ê°€ê²© ê³„ì‚° (êµ¬ë§¤ê°€ ë²”ìœ„ ë‚´ì—ì„œ)
            const minPrice = plant.priceRange[0];
            const maxPrice = plant.priceRange[1];
            const price = Math.floor(minPrice + Math.random() * (maxPrice - minPrice + 1));
            
            // êµ¬ë§¤ê°€ê²© ì €ì¥
            if (!dailyPrices[today]) {
                dailyPrices[today] = {};
            }
            dailyPrices[today][plant.id + '_buy'] = price;
            
            return price;
        }

        // í˜„ì¬ íŒë§¤ê°€ê²© ê³„ì‚°
        function getCurrentSellPrice(plant) {
            // ì˜¤ëŠ˜ ë‚ ì§œë¥¼ í‚¤ë¡œ ì‚¬ìš©
            const today = gameState.day;
            
            // ì´ë¯¸ ê³„ì‚°ëœ íŒë§¤ê°€ê²©ì´ ìˆìœ¼ë©´ ë°˜í™˜
            if (dailyPrices[today] && dailyPrices[today][plant.id + '_sell']) {
                return dailyPrices[today][plant.id + '_sell'];
            }
            
            // ìƒˆë¡œìš´ íŒë§¤ê°€ê²© ê³„ì‚° (íŒë§¤ê°€ ë²”ìœ„ ë‚´ì—ì„œ)
            const minPrice = plant.sellRange[0];
            const maxPrice = plant.sellRange[1];
            const price = Math.floor(minPrice + Math.random() * (maxPrice - minPrice + 1));
            
            // íŒë§¤ê°€ê²© ì €ì¥
            if (!dailyPrices[today]) {
                dailyPrices[today] = {};
            }
            dailyPrices[today][plant.id + '_sell'] = price;
            
            return price;
        }

        // í˜„ì¬ ê°€ê²© ê³„ì‚° (ê¸°ì¡´ í˜¸í™˜ì„±ì„ ìœ„í•´)
        function getCurrentPrice(plant) {
            return getCurrentBuyPrice(plant);
        }

        // í˜„ì¬ ì¬ê³ ëŸ‰ ê³„ì‚°
        function getCurrentStock(plant) {
            const today = gameState.day;
            
            // ì´ë¯¸ ê³„ì‚°ëœ ì¬ê³ ê°€ ìˆìœ¼ë©´ ë°˜í™˜
            if (dailyStock[today] && dailyStock[today][plant.id] !== undefined) {
                return dailyStock[today][plant.id];
            }
            
            // ì´ë²¤íŠ¸ ì˜í–¥ í™•ì¸
            let stockMultiplier = 1.0;
            gameState.activeEvents.forEach(event => {
                if (event.affectedPlants.includes(plant.id)) {
                    stockMultiplier = 0.3; // ì´ë²¤íŠ¸ ë°œìƒ ì‹œ ì¬ê³  30%ë¡œ ê°ì†Œ
                }
            });
            
            // í¬ê·€ë„ì— ë”°ë¥¸ ì¬ê³  ê°ì†Œ
            const rarityMultiplier = {
                'common': 1.0,
                'uncommon': 0.8,
                'rare': 0.6,
                'epic': 0.4,
                'legendary': 0.3,
                'mythic': 0.2
            };
            
            // í’ˆì ˆ í™•ë¥  (í¬ê·€í•œ ì‹ë¬¼ì¼ìˆ˜ë¡ ë†’ìŒ) - ë‚®ì¶¤
            const soldOutChance = {
                'common': 0.02, // 2%
                'uncommon': 0.05, // 5%
                'rare': 0.08, // 8%
                'epic': 0.12, // 12%
                'legendary': 0.15, // 15%
                'mythic': 0.18 // 18%
            };
            
            // í’ˆì ˆ ì²´í¬
            if (Math.random() < soldOutChance[plant.rarity]) {
                if (!dailyStock[today]) {
                    dailyStock[today] = {};
                }
                dailyStock[today][plant.id] = 0;
                return 0;
            }
            
            // ê¸°ë³¸ ì¬ê³ ëŸ‰ ê³„ì‚° (ëœë¤ ë³€ë™)
            const baseStock = plant.baseStock;
            const variation = Math.random() * 0.4 + 0.8; // 80~120% ë³€ë™
            const rarityMultiplierValue = rarityMultiplier[plant.rarity] || 1.0;
            const stock = Math.floor(baseStock * variation * stockMultiplier * rarityMultiplierValue);
            
            // ì¬ê³  ì €ì¥
            if (!dailyStock[today]) {
                dailyStock[today] = {};
            }
            dailyStock[today][plant.id] = Math.max(0, stock);
            
            return Math.max(0, stock);
        }

        // ì¬ê³  ê°ì†Œ
        function decreaseStock(plantId) {
            const today = gameState.day;
            if (dailyStock[today] && dailyStock[today][plantId] > 0) {
                dailyStock[today][plantId]--;
                return true;
            }
            return false;
        }

        // ê°€ê²© íŠ¸ë Œë“œ ê³„ì‚°
        function getPriceTrend(plantId) {
            const today = gameState.day;
            const yesterday = today - 1;
            
            // ì–´ì œ êµ¬ë§¤ê°€ê²©ì´ ì—†ìœ¼ë©´ ëœë¤ íŠ¸ë Œë“œ ë°˜í™˜
            if (!dailyPrices[yesterday] || !dailyPrices[yesterday][plantId + '_buy']) {
                return Math.random() > 0.5 ? 1 : Math.random() > 0.5 ? -1 : 0;
            }
            
            const todayPrice = dailyPrices[today] ? dailyPrices[today][plantId + '_buy'] : getCurrentBuyPrice(plants.find(p => p.id === plantId));
            const yesterdayPrice = dailyPrices[yesterday][plantId + '_buy'];
            
            if (todayPrice > yesterdayPrice) return 1;
            if (todayPrice < yesterdayPrice) return -1;
            return 0;
        }

        // ê°€ê²© ê·¸ë˜í”„ í‘œì‹œ
        function showPriceGraph(plantId) {
            const plant = plants.find(p => p.id === plantId);
            const currentBuyPrice = getCurrentBuyPrice(plant);
            const currentSellPrice = getCurrentSellPrice(plant);
            
            // ìµœê·¼ 7ì¼ê°„ì˜ ê°€ê²© ë°ì´í„° ìˆ˜ì§‘
            const priceData = [];
            for (let day = Math.max(1, gameState.day - 6); day <= gameState.day; day++) {
                const buyPrice = dailyPrices[day] ? dailyPrices[day][plantId + '_buy'] : null;
                const sellPrice = dailyPrices[day] ? dailyPrices[day][plantId + '_sell'] : null;
                
                if (buyPrice && sellPrice) {
                    priceData.push({
                        day: day,
                        buyPrice: buyPrice,
                        sellPrice: sellPrice
                    });
                }
            }
            
            // ê·¸ë˜í”„ HTML ìƒì„±
            let graphHtml = `
                <div style="background: rgba(255, 255, 255, 0.9); padding: 20px; border-radius: 10px; margin: 10px 0;">
                    <h3>ğŸ“Š ${plant.name} ê°€ê²© ë³€ë™ ê·¸ë˜í”„</h3>
                    <p><strong>í˜„ì¬ êµ¬ë§¤ê°€:</strong> ğŸ’ ${currentBuyPrice} | <strong>í˜„ì¬ íŒë§¤ê°€:</strong> ğŸ’ ${currentSellPrice}</p>
                    <div style="margin: 20px 0;">
            `;
            
            if (priceData.length > 1) {
                // ìµœê³ /ìµœì € ê°€ê²© ì°¾ê¸°
                const allPrices = priceData.flatMap(d => [d.buyPrice, d.sellPrice]);
                const minPrice = Math.min(...allPrices);
                const maxPrice = Math.max(...allPrices);
                const priceRange = maxPrice - minPrice;
                
                // SVG ì„ ê·¸ë˜í”„ ìƒì„±
                const svgWidth = 600;
                const svgHeight = 300;
                const padding = 40;
                const chartWidth = svgWidth - 2 * padding;
                const chartHeight = svgHeight - 2 * padding;
                
                graphHtml += `
                    <div style="margin: 20px 0;">
                        <svg width="${svgWidth}" height="${svgHeight}" style="border: 1px solid #ccc; background: white;">
                            <!-- Yì¶• ê·¸ë¦¬ë“œ -->
                            ${(() => {
                                let gridLines = '';
                                for (let i = 0; i <= 5; i++) {
                                    const y = padding + (i * chartHeight / 5);
                                    const price = maxPrice - (i * priceRange / 5);
                                    gridLines += `<line x1="${padding}" y1="${y}" x2="${svgWidth - padding}" y2="${y}" stroke="#eee" stroke-width="1"/>`;
                                    gridLines += `<text x="${padding - 5}" y="${y + 3}" text-anchor="end" font-size="10" fill="#666">ğŸ’ ${Math.round(price)}</text>`;
                                }
                                return gridLines;
                            })()}
                            
                            <!-- Xì¶• -->
                            <line x1="${padding}" y1="${svgHeight - padding}" x2="${svgWidth - padding}" y2="${svgHeight - padding}" stroke="#333" stroke-width="2"/>
                            
                            <!-- Yì¶• -->
                            <line x1="${padding}" y1="${padding}" x2="${padding}" y2="${svgHeight - padding}" stroke="#333" stroke-width="2"/>
                            
                            <!-- êµ¬ë§¤ê°€ ì„ ê·¸ë˜í”„ -->
                            <polyline points="${priceData.map((data, index) => {
                                const x = padding + (index * chartWidth / (priceData.length - 1));
                                const y = padding + ((maxPrice - data.buyPrice) / priceRange) * chartHeight;
                                return `${x},${y}`;
                            }).join(' ')}" fill="none" stroke="#3498db" stroke-width="3"/>
                            
                            <!-- íŒë§¤ê°€ ì„ ê·¸ë˜í”„ -->
                            <polyline points="${priceData.map((data, index) => {
                                const x = padding + (index * chartWidth / (priceData.length - 1));
                                const y = padding + ((maxPrice - data.sellPrice) / priceRange) * chartHeight;
                                return `${x},${y}`;
                            }).join(' ')}" fill="none" stroke="#e74c3c" stroke-width="3"/>
                            
                            <!-- ë°ì´í„° í¬ì¸íŠ¸ -->
                            ${priceData.map((data, index) => {
                                const x = padding + (index * chartWidth / (priceData.length - 1));
                                const buyY = padding + ((maxPrice - data.buyPrice) / priceRange) * chartHeight;
                                const sellY = padding + ((maxPrice - data.sellPrice) / priceRange) * chartHeight;
                                return `
                                    <circle cx="${x}" cy="${buyY}" r="4" fill="#3498db" stroke="white" stroke-width="2"/>
                                    <circle cx="${x}" cy="${sellY}" r="4" fill="#e74c3c" stroke="white" stroke-width="2"/>
                                    <text x="${x}" y="${svgHeight - padding + 15}" text-anchor="middle" font-size="10" fill="#666">Day ${data.day}</text>
                                `;
                            }).join('')}
                        </svg>
                    </div>
                    <div style="margin-top: 10px; font-size: 12px;">
                        <span style="color: #3498db;">â—</span> êµ¬ë§¤ê°€ | <span style="color: #e74c3c;">â—</span> íŒë§¤ê°€
                    </div>
                    <div style="margin-top: 10px;">
                        <strong>ìµœê³ ê°€:</strong> ğŸ’ ${maxPrice} | <strong>ìµœì €ê°€:</strong> ğŸ’ ${minPrice} | <strong>ê°€ê²© ë²”ìœ„:</strong> ğŸ’ ${priceRange}
                    </div>
                `;
            } else {
                graphHtml += `
                    <p style="color: #666;">ì•„ì§ ì¶©ë¶„í•œ ê°€ê²© ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤. ë” ë§ì€ ë‚ ì´ ì§€ë‚˜ë©´ ê·¸ë˜í”„ê°€ í‘œì‹œë©ë‹ˆë‹¤.</p>
                `;
            }
            
            graphHtml += `
                    </div>
                    <button onclick="closePriceGraph()" style="margin-top: 10px;">ë‹«ê¸°</button>
                </div>
            `;
            
            // ëª¨ë‹¬ í˜•íƒœë¡œ í‘œì‹œ
            const modal = document.createElement('div');
            modal.id = 'price-graph-modal';
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.7);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 1000;
            `;
            
            const modalContent = document.createElement('div');
            modalContent.style.cssText = `
                background: white;
                padding: 20px;
                border-radius: 10px;
                max-width: 90%;
                max-height: 90%;
                overflow-y: auto;
            `;
            modalContent.innerHTML = graphHtml;
            
            modal.appendChild(modalContent);
            document.body.appendChild(modal);
            
            // ë°°ê²½ í´ë¦­ ì‹œ ë‹«ê¸°
            modal.onclick = function(e) {
                if (e.target === modal) {
                    closePriceGraph();
                }
            };
        }

        // ê°€ê²© ê·¸ë˜í”„ ë‹«ê¸°
        function closePriceGraph() {
            const modal = document.getElementById('price-graph-modal');
            if (modal) {
                modal.remove();
            }
        }

        // ê²Œì„ ë°ì´í„° ì´ˆê¸°í™”
        function clearGameData() {
            const userInput = prompt(`âš ï¸ ì •ë§ë¡œ ëª¨ë“  ê²Œì„ ë°ì´í„°ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\n` +
                                   `â€¢ ëª¨ë“  ì§„í–‰ ìƒí™©ì´ ì‚¬ë¼ì§‘ë‹ˆë‹¤\n` +
                                   `â€¢ ê³¨ë“œ, ì‹ë¬¼, ê¸°ì–´ ë“±ì´ ëª¨ë‘ ì´ˆê¸°í™”ë©ë‹ˆë‹¤\n` +
                                   `â€¢ ë³µêµ¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤\n\n` +
                                   `ê³„ì†í•˜ì‹œë ¤ë©´ "ì‚­ì œ"ë¼ê³  ì •í™•íˆ ì…ë ¥í•˜ì„¸ìš”.`);
            
            if (userInput === 'ì‚­ì œ') {
                // ëª¨ë“  ì €ì¥ëœ ë°ì´í„° ì‚­ì œ
                localStorage.removeItem('magicalGreenhouse');
                localStorage.removeItem('magicalGreenhouse_backup');
                
                // ê²Œì„ ìƒíƒœ ì´ˆê¸°í™”
                gameState = {
                    day: 1,
                    time: '6:00 AM',
                    gold: 100,
                    usedSlots: 0,
                    totalSlots: 2,
                    emptySlots: 0,
                    weather: 'â˜€ï¸',
                    weatherName: 'Sunny',
                    inventory: [],
                    harvestedPlants: [],
                    plantedCrops: [],
                    gears: [],
                    lastSave: Date.now(),
                    nextDayCost: 10,
                    slotCost: 10,
                    activeEvents: [],
                                lastAutoProgress: Date.now(),
            autoProgressEnabled: true
                };
                
                // ê°€ê²©/ì¬ê³  ë°ì´í„° ì´ˆê¸°í™”
                dailyPrices = {};
                dailyStock = {};
                
                showNotification('ğŸ—‘ï¸ ëª¨ë“  ê²Œì„ ë°ì´í„°ê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤!');
                
                // í™”ë©´ ìƒˆë¡œê³ ì¹¨
                location.reload();
            } else if (userInput !== null) {
                showNotification('âŒ "ì‚­ì œ"ë¼ê³  ì •í™•íˆ ì…ë ¥í•´ì£¼ì„¸ìš”.');
            }
        }

        // ì”¨ì•— êµ¬ë§¤
        function buySeed(plantId) {
            const plant = plants.find(p => p.id === plantId);
            const currentBuyPrice = getCurrentBuyPrice(plant);
            const currentStock = getCurrentStock(plant);
            
            if (gameState.gold < currentBuyPrice) {
                showNotification('âŒ ê³¨ë“œê°€ ë¶€ì¡±í•©ë‹ˆë‹¤!');
                return;
            }
            
            if (currentStock === 0) {
                showNotification('âŒ í•´ë‹¹ ì”¨ì•—ì´ í’ˆì ˆë˜ì—ˆìŠµë‹ˆë‹¤!');
                return;
            }
            
            // ì¬ê³  ê°ì†Œ
            if (!decreaseStock(plantId)) {
                showNotification('âŒ ì¬ê³ ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤!');
                return;
            }
            
            gameState.gold -= currentBuyPrice;
            gameState.inventory.push(plantId);
            
            showNotification(`ğŸ›’ ${plant.name} ì”¨ì•—ì„ êµ¬ë§¤í–ˆìŠµë‹ˆë‹¤! -${currentBuyPrice} ê³¨ë“œ (ì¬ê³ : ${currentStock - 1}ê°œ)`);
            
            updateDisplay();
            
            // í˜„ì¬ í™”ë©´ì— ë”°ë¼ ì¦‰ì‹œ ì—…ë°ì´íŠ¸
            const currentContent = document.getElementById('content-area').innerHTML;
            if (currentContent.includes('ì”¨ì•— ìƒì ')) {
                renderSeedShop();
            }
            
            saveGameState();
        }

        // ê¸°ì–´ ìƒì  í‘œì‹œ
        function showGearShop() {
            const contentArea = document.getElementById('content-area');
            contentArea.innerHTML = `
                <button class="back-button" onclick="showShop()">â† ë’¤ë¡œ ê°€ê¸°</button>
                <h2>âš™ï¸ ê¸°ì–´ ìƒì </h2>
                <p>ì˜¨ì‹¤ ìƒì‚°ì„±ì„ ë†’ì´ëŠ” ê¸°ì–´ë“¤ì„ êµ¬ë§¤í•˜ì„¸ìš”.</p>
                <div id="gear-items"></div>
            `;
            
            renderGearShop();
        }

        // ê¸°ì–´ ìƒì  ë Œë”ë§
        function renderGearShop() {
            const gearItems = document.getElementById('gear-items');
            const gears = [
                { id: 'water_sprinkler', name: 'ğŸ’§ ë¬¼ ë¶„ë¬´ê¸°', price: 50, effect: 'ì„±ì¥ ì†ë„ +10%' },
                { id: 'sunlight_lamp', name: 'â˜€ï¸ í–‡ë¹› ë¨í”„', price: 100, effect: 'ì„±ì¥ ì†ë„ +20%' },
                { id: 'magic_fertilizer', name: 'ğŸŒ± ë§ˆë²• ë¹„ë£Œ', price: 200, effect: 'ì„±ì¥ ì†ë„ +30%' },
                { id: 'time_accelerator', name: 'â° ì‹œê°„ ê°€ì†ê¸°', price: 500, effect: 'ì„±ì¥ ì†ë„ +50%' }
            ];
            
            let html = `
                <table>
                    <tr>
                        <th>âš™ï¸ ê¸°ì–´ ì´ë¦„</th>
                        <th>ğŸ’ ê°€ê²©</th>
                        <th>ğŸ”§ íš¨ê³¼</th>
                        <th>ğŸ›’ êµ¬ë§¤</th>
                    </tr>
            `;
            
            gears.forEach(gear => {
                html += `
                    <tr>
                        <td>${gear.name}</td>
                        <td>ğŸ’ ${gear.price}</td>
                        <td>${gear.effect}</td>
                        <td><button onclick="buyGear('${gear.id}')" ${gameState.gold < gear.price ? 'disabled' : ''}>êµ¬ë§¤</button></td>
                    </tr>
                `;
            });
            
            html += '</table>';
            gearItems.innerHTML = html;
        }

        // ê¸°ì–´ êµ¬ë§¤
        function buyGear(gearId) {
            const gears = [
                { id: 'water_sprinkler', name: 'ğŸ’§ ë¬¼ ë¶„ë¬´ê¸°', price: 50, effect: 'ì„±ì¥ ì†ë„ +10%' },
                { id: 'sunlight_lamp', name: 'â˜€ï¸ í–‡ë¹› ë¨í”„', price: 100, effect: 'ì„±ì¥ ì†ë„ +20%' },
                { id: 'magic_fertilizer', name: 'ğŸŒ± ë§ˆë²• ë¹„ë£Œ', price: 200, effect: 'ì„±ì¥ ì†ë„ +30%' },
                { id: 'time_accelerator', name: 'â° ì‹œê°„ ê°€ì†ê¸°', price: 500, effect: 'ì„±ì¥ ì†ë„ +50%' }
            ];
            
            const gear = gears.find(g => g.id === gearId);
            
            if (gameState.gold < gear.price) {
                showNotification('âŒ ê³¨ë“œê°€ ë¶€ì¡±í•©ë‹ˆë‹¤!');
                return;
            }
            
            gameState.gold -= gear.price;
            
            // ê¸°ì–´ë¥¼ ì¸ë²¤í† ë¦¬ì— ì¶”ê°€
            const existingGear = gameState.gears.find(g => g.id === gearId);
            if (existingGear) {
                existingGear.count++;
            } else {
                gameState.gears.push({
                    id: gearId,
                    name: gear.name,
                    effect: gear.effect,
                    count: 1
                });
            }
            
            showNotification(`âš™ï¸ ${gear.name}ì„(ë¥¼) êµ¬ë§¤í–ˆìŠµë‹ˆë‹¤! -${gear.price} ê³¨ë“œ`);
            
            updateDisplay();
            saveGameState();
        }

        // ìŠ¬ë¡¯ ìƒì  í‘œì‹œ
        function showSlotShop() {
            const contentArea = document.getElementById('content-area');
            contentArea.innerHTML = `
                <button class="back-button" onclick="showShop()">â† ë’¤ë¡œ ê°€ê¸°</button>
                <h2>ğŸ¡ ì˜¨ì‹¤ í™•ì¥</h2>
                <p>ë” ë§ì€ ì‹ë¬¼ì„ ì‹¬ì„ ìˆ˜ ìˆë„ë¡ ì˜¨ì‹¤ì„ í™•ì¥í•˜ì„¸ìš”.</p>
                <div id="slot-items"></div>
            `;
            
            renderSlotShop();
        }

        // ìŠ¬ë¡¯ ìƒì  ë Œë”ë§
        function renderSlotShop() {
            const slotItems = document.getElementById('slot-items');
            const nextSlotCost = gameState.slotCost;
            
            let html = `
                <div class="slot-info">
                    <h3>í˜„ì¬ ì˜¨ì‹¤ ìƒíƒœ</h3>
                    <p>ì´ ìŠ¬ë¡¯: ${gameState.totalSlots}ê°œ</p>
                    <p>ì‚¬ìš© ì¤‘: ${gameState.usedSlots}ê°œ</p>
                    <p>ë¹ˆ ìŠ¬ë¡¯: ${gameState.emptySlots}ê°œ</p>
                </div>
                <div class="slot-purchase">
                    <h3>ìŠ¬ë¡¯ êµ¬ë§¤</h3>
                    <p>ì¶”ê°€ ìŠ¬ë¡¯ 1ê°œ: ğŸ’ ${nextSlotCost}</p>
                    <button onclick="buySlot()" ${gameState.gold < nextSlotCost ? 'disabled' : ''}>ìŠ¬ë¡¯ êµ¬ë§¤</button>
                </div>
            `;
            
            slotItems.innerHTML = html;
        }

        // ìŠ¬ë¡¯ êµ¬ë§¤
        function buySlot() {
            const cost = gameState.slotCost;
            
            if (gameState.gold < cost) {
                showNotification('âŒ ê³¨ë“œê°€ ë¶€ì¡±í•©ë‹ˆë‹¤!');
                return;
            }
            
            gameState.gold -= cost;
            gameState.totalSlots++;
            gameState.slotCost += 10; // ë‹¤ìŒ ìŠ¬ë¡¯ ë¹„ìš© ì¦ê°€
            
            showNotification(`ğŸ¡ ì˜¨ì‹¤ ìŠ¬ë¡¯ì„ êµ¬ë§¤í–ˆìŠµë‹ˆë‹¤! +1 ìŠ¬ë¡¯, -${cost} ê³¨ë“œ`);
            
            updateDisplay();
            renderPlantSlots();
            saveGameState();
        }

        // ì‹œì„¸ í™•ì¸ í‘œì‹œ
        function showMarketPrices() {
            const contentArea = document.getElementById('content-area');
            contentArea.innerHTML = `
                <button class="back-button" onclick="showShop()">â† ë’¤ë¡œ ê°€ê¸°</button>
                <h2>ğŸ“Š ì‹œì„¸ í™•ì¸</h2>
                <p>í˜„ì¬ ì‹ë¬¼ íŒë§¤ ì‹œì„¸ë¥¼ í™•ì¸í•˜ì„¸ìš”.</p>
                <div id="market-prices"></div>
            `;
            
            renderMarketPrices();
        }

        // ì‹œì„¸ ë Œë”ë§
        function renderMarketPrices() {
            const marketPrices = document.getElementById('market-prices');
            let html = `
                <table>
                    <tr>
                        <th>ğŸŒ¸ ì‹ë¬¼ ì´ë¦„</th>
                        <th>ğŸ’ í˜„ì¬ ê°€ê²©</th>
                        <th>ğŸ“ˆ ê°€ê²© ë³€í™”</th>
                        <th>ğŸ“Š ë‚´ ë³´ìœ ëŸ‰</th>
                        <th>ğŸ’° íŒë§¤</th>
                    </tr>
            `;
            
            // ë³´ìœ í•œ ì‹ë¬¼ë“¤ì˜ ìˆ˜ëŸ‰ê³¼ í’ˆì§ˆë³„ ë¶„ë¥˜
            const plantDetails = {};
            gameState.harvestedPlants.forEach(plant => {
                if (!plantDetails[plant.plantId]) {
                    plantDetails[plant.plantId] = { normal: 0, good: 0, perfect: 0 };
                }
                plantDetails[plant.plantId][plant.quality]++;
            });
            
            plants.forEach(plant => {
                const currentSellPrice = getCurrentSellPrice(plant);
                const eventPrice = getEventPrice(currentSellPrice, plant.id);
                const trend = getPriceTrend(plant.id);
                const trendEmoji = trend > 0 ? 'ğŸ“ˆ' : trend < 0 ? 'ğŸ“‰' : 'â–';
                const trendClass = trend > 0 ? 'trend-up' : trend < 0 ? 'trend-down' : 'trend-neutral';
                const plantDetail = plantDetails[plant.id] || { normal: 0, good: 0, perfect: 0 };
                const totalOwned = plantDetail.normal + plantDetail.good + plantDetail.perfect;
                
                // ì–´ì œ íŒë§¤ê°€ê²©ê³¼ ë¹„êµ
                const yesterday = gameState.day - 1;
                const yesterdayPrice = dailyPrices[yesterday] ? dailyPrices[yesterday][plant.id + '_sell'] : null;
                let priceChangeText = '';
                
                if (yesterdayPrice) {
                    const change = currentSellPrice - yesterdayPrice;
                    const changePercent = Math.round((change / yesterdayPrice) * 100);
                    if (change > 0) {
                        priceChangeText = `<span style="color: #27ae60; font-weight: bold;">+${change} (+${changePercent}%) ğŸ“ˆ</span>`;
                    } else if (change < 0) {
                        priceChangeText = `<span style="color: #e74c3c; font-weight: bold;">${change} (${changePercent}%) ğŸ“‰</span>`;
                    } else {
                        priceChangeText = `<span style="color: #f39c12; font-weight: bold;">ë³€í™” ì—†ìŒ â–</span>`;
                    }
                } else {
                    priceChangeText = `<span style="color: #f39c12; font-weight: bold;">ìƒˆë¡œìš´ ê°€ê²© â–</span>`;
                }
                
                // ë³´ìœ ëŸ‰ í‘œì‹œ
                let ownedText = '';
                if (totalOwned > 0) {
                    ownedText = `${totalOwned}ê°œ (`;
                    if (plantDetail.perfect > 0) ownedText += `âœ¨${plantDetail.perfect} `;
                    if (plantDetail.good > 0) ownedText += `â­${plantDetail.good} `;
                    if (plantDetail.normal > 0) ownedText += `ğŸŒ±${plantDetail.normal}`;
                    ownedText += ')';
                } else {
                    ownedText = '0ê°œ';
                }
                
                // ì´ë²¤íŠ¸ ë³´ë„ˆìŠ¤ í‘œì‹œ
                let eventBonusText = '';
                if (eventPrice > currentSellPrice) {
                    eventBonusText = `<br><small style="color: #FF6B6B; font-weight: bold;">ğŸ‰ ì´ë²¤íŠ¸ ë³´ë„ˆìŠ¤: +${eventPrice - currentSellPrice}</small>`;
                }
                
                html += `
                    <tr>
                        <td>${plant.name}</td>
                        <td>ğŸ’ ${eventPrice}${eventBonusText}</td>
                        <td class="${trendClass}">${priceChangeText}</td>
                        <td>${ownedText}</td>
                        <td><button onclick="sellPlant('${plant.id}')" ${totalOwned === 0 ? 'disabled' : ''}>íŒë§¤</button></td>
                    </tr>
                `;
            });
            
            html += '</table>';
            marketPrices.innerHTML = html;
        }

        // í’ˆì§ˆë³„ ê°€ê²© ê³„ì‚° (íŠ¹ë³„ íš¨ê³¼ í¬í•¨)
        function getQualityPrice(basePrice, quality, specialEffect = '') {
            let finalPrice = basePrice;
            
            // í’ˆì§ˆë³„ ê°€ê²© ì„¤ì •
            switch(quality) {
                case 'perfect':
                    // ì™„ë²½ í’ˆì§ˆ: í˜„ì¬ ì‹œì„¸ë³´ë‹¤ ë†’ì€ ê³ ì • ê°€ê²©
                    finalPrice = Math.floor(basePrice * 1.8); // 80% ë³´ë„ˆìŠ¤
                    break;
                case 'good':
                    // ì¢‹ìŒ í’ˆì§ˆ: í˜„ì¬ ì‹œì„¸ë³´ë‹¤ ë†’ì€ ê³ ì • ê°€ê²©
                    finalPrice = Math.floor(basePrice * 1.4); // 40% ë³´ë„ˆìŠ¤
                    break;
                case 'normal':
                default:
                    // ë³´í†µ í’ˆì§ˆ: í˜„ì¬ ì‹œì„¸ ì ìš©
                    finalPrice = basePrice; // ê¸°ë³¸ ê°€ê²© (ì‹œì„¸ ì ìš©)
            }
            
            // íŠ¹ë³„ íš¨ê³¼ ì ìš©
            if (specialEffect.includes('ë‹¬ë¹› íš¨ê³¼')) {
                finalPrice = Math.floor(finalPrice * 2); // 2ë°°
            } else if (specialEffect.includes('ë²ˆê°œ ì¶©ì „')) {
                finalPrice = Math.floor(finalPrice * 3); // 3ë°°
            } else if (specialEffect.includes('ë¬´ì§€ê°œ íš¨ê³¼')) {
                finalPrice = Math.floor(finalPrice * 1.4); // 40% ë³´ë„ˆìŠ¤
            }
            
            return finalPrice;
        }

        // ì´ë²¤íŠ¸ ê°€ê²© ê³„ì‚°
        function getEventPrice(basePrice, plantId) {
            let eventMultiplier = 1.0;
            
            // í™œì„± ì´ë²¤íŠ¸ í™•ì¸
            gameState.activeEvents.forEach(event => {
                if (event.affectedPlants.includes(plantId)) {
                    eventMultiplier *= event.priceMultiplier;
                }
            });
            
            return Math.floor(basePrice * eventMultiplier);
        }

        // ì‹ë¬¼ íŒë§¤ (í’ˆì§ˆ ì„ íƒ ê°€ëŠ¥)
        function sellPlant(plantId) {
            const plant = plants.find(p => p.id === plantId);
            const currentSellPrice = getCurrentSellPrice(plant);
            
            // í•´ë‹¹ ì‹ë¬¼ë“¤ì˜ í’ˆì§ˆë³„ ë¶„ë¥˜
            const availablePlants = gameState.harvestedPlants.filter(p => p.plantId === plantId);
            
            if (availablePlants.length === 0) {
                showNotification('âŒ íŒë§¤í•  ì‹ë¬¼ì´ ì—†ìŠµë‹ˆë‹¤!');
                return;
            }
            
            // í’ˆì§ˆë³„ë¡œ ë¶„ë¥˜
            const qualityGroups = {
                perfect: availablePlants.filter(p => p.quality === 'perfect'),
                good: availablePlants.filter(p => p.quality === 'good'),
                normal: availablePlants.filter(p => p.quality === 'normal')
            };
            
            // ê°€ì¥ ë†’ì€ í’ˆì§ˆì˜ ì‹ë¬¼ì„ ìš°ì„  íŒë§¤
            let plantToSell = null;
            if (qualityGroups.perfect.length > 0) {
                plantToSell = qualityGroups.perfect[0];
            } else if (qualityGroups.good.length > 0) {
                plantToSell = qualityGroups.good[0];
            } else {
                plantToSell = qualityGroups.normal[0];
            }
            
            const qualityPrice = getQualityPrice(currentSellPrice, plantToSell.quality, plantToSell.specialEffect || '');
            const eventPrice = getEventPrice(qualityPrice, plantId);
            
            // í•´ë‹¹ ì‹ë¬¼ ì œê±°
            const plantIndex = gameState.harvestedPlants.findIndex(p => 
                p.plantId === plantId && p.quality === plantToSell.quality
            );
            gameState.harvestedPlants.splice(plantIndex, 1);
            gameState.gold += eventPrice;
            
            const qualityEmoji = plantToSell.quality === 'perfect' ? 'âœ¨' : plantToSell.quality === 'good' ? 'â­' : 'ğŸŒ±';
            const qualityText = plantToSell.quality === 'perfect' ? 'ì™„ë²½' : plantToSell.quality === 'good' ? 'ì¢‹ìŒ' : 'ë³´í†µ';
            
            let eventText = '';
            if (eventPrice > qualityPrice) {
                eventText = ` (ì´ë²¤íŠ¸ ë³´ë„ˆìŠ¤: +${eventPrice - qualityPrice})`;
            }
            showNotification(`ğŸ’° ${plant.name} (${qualityEmoji} ${qualityText})ì„(ë¥¼) íŒë§¤í–ˆìŠµë‹ˆë‹¤! +${eventPrice} ê³¨ë“œ${eventText}`);
            
            updateDisplay();
            
            // ì¦‰ì‹œ í˜„ì¬ í™”ë©´ ì—…ë°ì´íŠ¸
            setTimeout(() => {
                const currentContent = document.getElementById('content-area').innerHTML;
                if (currentContent.includes('ì¸ë²¤í† ë¦¬') || currentContent.includes('ì”¨ì•— ì¸ë²¤í† ë¦¬')) {
                    renderInventory();
                } else if (currentContent.includes('ì‹œì„¸ í™•ì¸')) {
                    renderMarketPrices();
                } else if (currentContent.includes('ì‹ë¬¼ ì‹¬ê¸°') || currentContent.includes('plant-inventory')) {
                    renderPlantInventory();
                }
            }, 50);
            
            saveGameState();
        }

        // ë‹¤ìŒë‚  ê¸°ë‹¤ë¦¬ê¸° í™•ì¸
        function waitNextDay() {
            const cost = gameState.nextDayCost;
            const confirmMessage = `ğŸŒ… Day ${gameState.day}ì—ì„œ Day ${gameState.day + 1}ë¡œ ì§„í–‰í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\n` +
                                 `â€¢ ìƒˆë¡œìš´ ë‚ ì”¨ê°€ ì„¤ì •ë©ë‹ˆë‹¤\n` +
                                 `â€¢ ì”¨ì•— ê°€ê²©ì´ ë³€ë™ë©ë‹ˆë‹¤\n` +
                                 `â€¢ ì‹¬ì–´ì§„ ì‹ë¬¼ë“¤ì´ ì„±ì¥í•©ë‹ˆë‹¤\n` +
                                 `â€¢ ë¹„ìš©: ğŸ’ ${cost} ê³¨ë“œ`;
            
            if (confirm(confirmMessage)) {
                if (gameState.gold >= cost) {
                    proceedToNextDay();
                } else {
                    showNotification('âŒ ê³¨ë“œê°€ ë¶€ì¡±í•©ë‹ˆë‹¤! ë‹¤ìŒë‚ ë¡œ ì§„í–‰í•˜ë ¤ë©´ ğŸ’ ' + cost + ' ê³¨ë“œê°€ í•„ìš”í•©ë‹ˆë‹¤.');
                }
            }
        }

        // í™•ë¥  ê¸°ë°˜ ë‚ ì”¨ ì„ íƒ
        function selectWeatherByProbability() {
            const random = Math.random() * 100;
            let cumulativeProbability = 0;
            
            for (const weather of weathers) {
                cumulativeProbability += weather.probability;
                if (random <= cumulativeProbability) {
                    return weather;
                }
            }
            
            // ê¸°ë³¸ê°’ (ë§‘ìŒ)
            return weathers[0];
        }

        // ë‚ ì”¨ íš¨ê³¼ ì ìš©
        function applyWeatherEffects() {
            const currentWeather = weathers.find(w => w.emoji === gameState.weather);
            if (!currentWeather) return;
            
            let effectMessage = '';
            
            switch (currentWeather.effect) {
                case 'growth_boost': // ë¹„
                    if (Math.random() < 0.3) {
                        effectMessage = 'ğŸŒ§ï¸ ë¹„ë¡œ ì¸í•´ ì„±ì¥ ì†ë„ê°€ 50% ì¦ê°€í–ˆìŠµë‹ˆë‹¤!';
                    }
                    break;
                    
                case 'moonlight_bonus': // ë‹¬ë¹›
                    if (Math.random() < 0.2) {
                        effectMessage = 'ğŸŒ™ ë‹¬ë¹› íš¨ê³¼ë¡œ íŒë§¤ê°€ê°€ 2ë°°ê°€ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤!';
                    }
                    break;
                    
                case 'electric_charge': // ë²ˆê°œ
                    if (Math.random() < 0.15) {
                        effectMessage = 'ğŸŒ©ï¸ ë²ˆê°œ ì¶©ì „ìœ¼ë¡œ íŒë§¤ê°€ê°€ 3ë°°ê°€ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤!';
                    }
                    break;
                    
                case 'unstable_price': // ì•ˆê°œ
                    if (Math.random() < 0.2) {
                        effectMessage = 'ğŸŒ«ï¸ ì•ˆê°œë¡œ ì¸í•´ ìˆ˜í™•ê°€ê°€ ë¶ˆì•ˆì •í•´ì§‘ë‹ˆë‹¤ (50~150%)';
                    }
                    break;
                    
                case 'wind_damage': // ê°•í’
                    if (Math.random() < 0.25) {
                        effectMessage = 'ğŸŒªï¸ ê°•í’ìœ¼ë¡œ ì¼ë¶€ ì‘ë¬¼ì´ ì‹œë“¤ê±°ë‚˜ ë‚ ì•„ê°ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤!';
                    } else {
                        effectMessage = 'ğŸŒªï¸ ê°•í’ìœ¼ë¡œ íŒë§¤ê°€ê°€ 10% ì¦ê°€í•©ë‹ˆë‹¤!';
                    }
                    break;
                    
                case 'frost_delay': // ì„œë¦¬
                    if (Math.random() < 0.3) {
                        effectMessage = 'â„ï¸ ì„œë¦¬ë¡œ ì„±ì¥ì´ ì •ì§€ë˜ê³  ë³´ì¡´ ê¸°ê°„ì´ 1ì¼ ì¦ê°€í•©ë‹ˆë‹¤!';
                    }
                    break;
                    
                case 'heat_growth': // ì—´ê¸°
                    effectMessage = 'ğŸ”¥ ì—´ê¸°ë¡œ ì„±ì¥ ì†ë„ê°€ 2ë°° ì¦ê°€í•˜ì§€ë§Œ ì‹œë“¤ ìœ„í—˜ì´ ìˆìŠµë‹ˆë‹¤!';
                    break;
                    
                case 'rainbow_rare': // ë¬´ì§€ê°œ
                    effectMessage = 'ğŸŒˆ ë¬´ì§€ê°œ íš¨ê³¼ë¡œ í¬ê·€ì„±ì´ ë¶€ì—¬ë©ë‹ˆë‹¤ (íŒë§¤ê°€+40%, ì„±ì¥+20%)!';
                    break;
                    
                case 'dark_cloud': // ì•”ìš´
                    effectMessage = 'ğŸŒ˜ ì•”ìš´ìœ¼ë¡œ ì¼ë¶€ ì‘ë¬¼ì— ë¶€ì • íš¨ê³¼ê°€ ìˆì§€ë§Œ ë‹¤ë¥¸ ì‘ë¬¼ì€ ê°•í™”ë©ë‹ˆë‹¤!';
                    break;
            }
            
            if (effectMessage) {
                showNotification(effectMessage);
            }
        }

        // ì´ë²¤íŠ¸ ì²´í¬ ë° ìƒì„±
        function checkAndCreateEvents() {
            const newEvents = [];
            
            events.forEach(event => {
                if (Math.random() < event.probability) {
                    newEvents.push({
                        ...event,
                        startDay: gameState.day,
                        endDay: gameState.day + event.duration
                    });
                }
            });
            
            return newEvents;
        }

        // ì´ë²¤íŠ¸ ì—…ë°ì´íŠ¸ (ë§Œë£Œëœ ì´ë²¤íŠ¸ ì œê±°)
        function updateEvents() {
            gameState.activeEvents = gameState.activeEvents.filter(event => 
                gameState.day <= event.endDay
            );
        }

        // ë‹¤ìŒë‚ ë¡œ ì§„í–‰
        function proceedToNextDay() {
            const cost = gameState.nextDayCost;
            gameState.gold -= cost;
            gameState.day++;
            gameState.time = '6:00 AM';
            
            // ë‹¤ìŒë‚  ë¹„ìš© ì¦ê°€ (ë¬´í•œ ì¦ê°€)
            gameState.nextDayCost += 2;
            
            // ì´ë²¤íŠ¸ ì—…ë°ì´íŠ¸
            updateEvents();
            
            // ìƒˆë¡œìš´ ì´ë²¤íŠ¸ ì²´í¬
            const newEvents = checkAndCreateEvents();
            gameState.activeEvents.push(...newEvents);
            
            // í™•ë¥  ê¸°ë°˜ ë‚ ì”¨ ì„ íƒ
            const newWeather = selectWeatherByProbability();
            gameState.weather = newWeather.emoji;
            gameState.weatherName = newWeather.name;
            
            // ë°°ê²½ ë³€ê²½
            document.body.className = newWeather.class;
            
            showNotification(`ğŸŒ… ìƒˆë¡œìš´ í•˜ë£¨ê°€ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤! (Day ${gameState.day})`);
            showNotification(`ğŸŒ¤ï¸ ì˜¤ëŠ˜ì˜ ë‚ ì”¨: ${newWeather.emoji} ${newWeather.name}`);
            showNotification(`ğŸ’° ì”¨ì•— ê°€ê²©ì´ ë³€ë™ë˜ì—ˆìŠµë‹ˆë‹¤!`);
            showNotification(`ğŸ’¸ ë‹¤ìŒë‚  ì§„í–‰ ë¹„ìš©: -${cost} ê³¨ë“œ`);
            
            // ìƒˆë¡œìš´ ì´ë²¤íŠ¸ ì•Œë¦¼
            newEvents.forEach(event => {
                showNotification(`ğŸ‰ ${event.name}ì´(ê°€) ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤! ${event.description}`);
                showNotification(`ğŸ“ˆ í•´ë‹¹ ì‹ë¬¼ë“¤ì˜ íŒë§¤ê°€ê°€ ${event.priceMultiplier}ë°°ë¡œ ì¦ê°€í•©ë‹ˆë‹¤!`);
                showNotification(`ğŸ“¦ ì´ë²¤íŠ¸ ê¸°ê°„ ì¤‘ í•´ë‹¹ ì‹ë¬¼ë“¤ì˜ ì¬ê³ ê°€ 30%ë¡œ ê°ì†Œí•©ë‹ˆë‹¤!`);
            });
            
            // ë‚ ì”¨ íš¨ê³¼ ì ìš© ë° ì•Œë¦¼
            applyWeatherEffects();
            
            // ìë™ ì§„í–‰ íƒ€ì´ë¨¸ ë¦¬ì…‹
            gameState.lastAutoProgress = Date.now();
            
            // ì „ì²´ í™”ë©´ ìƒˆë¡œê³ ì¹¨
            updateDisplay();
            refreshAllScreens();
            saveGameState();
        }

        // ëª¨ë“  í™”ë©´ ìƒˆë¡œê³ ì¹¨
        function refreshAllScreens() {
            // í˜„ì¬ í™”ë©´ ìƒíƒœ ì €ì¥
            const currentContent = document.getElementById('content-area').innerHTML;
            
            // í˜„ì¬ í™”ë©´ì— ë”°ë¼ í•´ë‹¹ ë Œë”ë§ í•¨ìˆ˜ë§Œ í˜¸ì¶œ
            if (currentContent.includes('ğŸŒ¸ ì”¨ì•— ìƒì ')) {
                renderSeedShop();
            } else if (currentContent.includes('ğŸ“Š ì‹œì„¸ í™•ì¸')) {
                renderMarketPrices();
            } else if (currentContent.includes('ğŸ“¦ ì¸ë²¤í† ë¦¬')) {
                renderInventory();
            } else if (currentContent.includes('ğŸŒ± ì‹ë¬¼ ì‹¬ê¸°')) {
                renderPlantInventory();
            }
            // ë‹¤ë¥¸ í™”ë©´ë“¤ì€ ë°ì´í„°ë§Œ ì—…ë°ì´íŠ¸í•˜ê³  í™”ë©´ì€ ë³€ê²½í•˜ì§€ ì•ŠìŒ
        }

        // ì„±ì¥ ìƒíƒœ ë³´ê¸°
        function showGrowthStatus() {
            const contentArea = document.getElementById('content-area');
            contentArea.innerHTML = `
                <button class="back-button" onclick="showMainMenu()">â† ë’¤ë¡œ ê°€ê¸°</button>
                <h2>ğŸ“ˆ ì„±ì¥ ìƒíƒœ</h2>
                <div id="growth-status"></div>
            `;
            
            renderGrowthStatus();
        }

        // ì„±ì¥ ìƒíƒœ ë Œë”ë§
        function renderGrowthStatus() {
            const growthStatus = document.getElementById('growth-status');
            
            if (gameState.plantedCrops.length === 0) {
                growthStatus.innerHTML = '<p>í˜„ì¬ ì‹¬ì–´ì§„ ì‹ë¬¼ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
                return;
            }
            
            let html = '<table><tr><th>ì‹ë¬¼</th><th>ì„±ì¥ë¥ </th><th>ë‚¨ì€ ì‹œê°„</th><th>ìƒíƒœ</th></tr>';
            
            gameState.plantedCrops.forEach((crop, index) => {
                const plant = plants.find(p => p.id === crop.plantId);
                const progress = (Date.now() - crop.plantTime) / (plant.growTime * 1000);
                const remainingTime = Math.max(0, plant.growTime - (Date.now() - crop.plantTime) / 1000);
                
                let status = 'ğŸŒ± ì„±ì¥ ì¤‘';
                if (progress >= 1) {
                    status = 'âœ¨ ìˆ˜í™• ê°€ëŠ¥!';
                }
                
                html += `
                    <tr>
                        <td>${plant.name}</td>
                        <td>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${Math.min(100, progress * 100)}%"></div>
                            </div>
                            ${Math.round(progress * 100)}%
                        </td>
                        <td>${formatTime(Math.ceil(remainingTime))}</td>
                        <td>${status}</td>
                    </tr>
                `;
            });
            
            html += '</table>';
            growthStatus.innerHTML = html;
        }

        // ë©”ì¸ ë©”ë‰´ í‘œì‹œ
        function showMainMenu() {
            const contentArea = document.getElementById('content-area');
            contentArea.innerHTML = `
                <h2>ğŸŒ¿ ì˜¨ì‹¤ì— ì˜¤ì‹  ê²ƒì„ í™˜ì˜í•©ë‹ˆë‹¤!</h2>
                <div id="plant-slots"></div>
            `;
            renderPlantSlots();
        }

        // ì•Œë¦¼ í‘œì‹œ
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // ì•Œë¦¼ ê¶Œí•œ ìƒíƒœ í™•ì¸ ë° í‘œì‹œ
        function checkNotificationPermission() {
            if ('Notification' in window) {
                if (Notification.permission === 'granted') {
                    showNotification('ğŸ”” ì•Œë¦¼ì´ í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤!');
                } else if (Notification.permission === 'denied') {
                    showNotification('ğŸ”• ì•Œë¦¼ì´ ë¹„í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤. ë¸Œë¼ìš°ì € ì„¤ì •ì—ì„œ í—ˆìš©í•´ì£¼ì„¸ìš”.');
                }
            }
        }

        // ìë™ ì§„í–‰ ì²´í¬
        function checkAutoProgress() {
            if (!gameState.autoProgressEnabled) return;
            
            const now = Date.now();
            const timeSinceLastProgress = now - gameState.lastAutoProgress;
            const fiveMinutes = 5 * 60 * 1000; // 5ë¶„ì„ ë°€ë¦¬ì´ˆë¡œ
            
            if (timeSinceLastProgress >= fiveMinutes) {
                // ìë™ìœ¼ë¡œ ë‹¤ìŒë‚  ì§„í–‰
                proceedToNextDay();
                gameState.lastAutoProgress = now;
                showNotification('â° 5ë¶„ì´ ì§€ë‚˜ ìë™ìœ¼ë¡œ ë‹¤ìŒë‚ ë¡œ ì§„í–‰ë˜ì—ˆìŠµë‹ˆë‹¤!');
                
                // íƒ€ì´ë¨¸ ë¦¬ì…‹
                updateTimer();
            }
        }

        // íƒ€ì´ë¨¸ ì—…ë°ì´íŠ¸
        function updateTimer() {
            const now = Date.now();
            const timeSinceLastProgress = now - gameState.lastAutoProgress;
            const fiveMinutes = 5 * 60 * 1000; // 5ë¶„ì„ ë°€ë¦¬ì´ˆë¡œ
            const remainingTime = Math.max(0, fiveMinutes - timeSinceLastProgress);
            
            const minutes = Math.floor(remainingTime / (60 * 1000));
            const seconds = Math.floor((remainingTime % (60 * 1000)) / 1000);
            
            // ë©”ë‰´ ì¹´ë“œì˜ íƒ€ì´ë¨¸ í‘œì‹œ ì—…ë°ì´íŠ¸
            const timerDisplay = document.getElementById('timer-display');
            if (timerDisplay) {
                timerDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                
                // 1ë¶„ ì´í•˜ì¼ ë•Œ í„ìŠ¤ íš¨ê³¼ ì¶”ê°€
                const timerMenuCard = document.getElementById('timer-menu-card');
                if (remainingTime <= 60000) {
                    timerMenuCard.classList.add('timer-pulse');
                } else {
                    timerMenuCard.classList.remove('timer-pulse');
                }
            }
            
            // ì‚¬ì´ë“œë°” íƒ€ì´ë¨¸ë„ ì—…ë°ì´íŠ¸ (ê¸°ì¡´ ê¸°ëŠ¥ ìœ ì§€)
            const sidebarTimer = document.getElementById('sidebar-timer');
            if (sidebarTimer) {
                const sidebarTimerDisplay = document.getElementById('next-day-timer');
                if (sidebarTimerDisplay) {
                    sidebarTimerDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                    
                    if (remainingTime <= 60000) {
                        sidebarTimer.classList.add('timer-pulse');
                    } else {
                        sidebarTimer.classList.remove('timer-pulse');
                    }
                }
            }
        }

        // ìë™ ì§„í–‰ ìƒíƒœ ì—…ë°ì´íŠ¸
        function updateAutoProgressStatus() {
            const statusElement = document.getElementById('auto-progress-status');
            if (statusElement) {
                // í•­ìƒ í™œì„±í™” ìƒíƒœë¡œ í‘œì‹œ
                statusElement.textContent = 'â° ìë™ ì§„í–‰ í™œì„±í™”';
                statusElement.style.color = '#4CAF50';
            }
        }

        // ë‚ ì”¨ì— ë”°ë¥¸ íƒ€ì´ë¨¸ ìƒ‰ìƒ ì—…ë°ì´íŠ¸
        function updateTimerWeatherStyle() {
            const sidebarTimer = document.getElementById('sidebar-timer');
            if (!sidebarTimer) return;
            
            // ë‚ ì”¨ì— ë”°ë¥¸ ì¶”ê°€ ìŠ¤íƒ€ì¼ ì ìš©
            const weather = gameState.weather;
            switch (weather) {
                case 'â˜€ï¸': // ë§‘ìŒ
                    sidebarTimer.style.borderColor = '#FFD700';
                    break;
                case 'ğŸŒ§ï¸': // ë¹„
                    sidebarTimer.style.borderColor = '#3498db';
                    break;
                case 'ğŸŒ™': // ë‹¬ë¹›
                    sidebarTimer.style.borderColor = '#34495e';
                    break;
                case 'ğŸŒ©ï¸': // ë²ˆê°œ
                    sidebarTimer.style.borderColor = '#8e44ad';
                    break;
                case 'ğŸŒ«ï¸': // ì•ˆê°œ
                    sidebarTimer.style.borderColor = '#95a5a6';
                    break;
                case 'ğŸŒªï¸': // ê°•í’
                    sidebarTimer.style.borderColor = '#8e44ad';
                    break;
                case 'â„ï¸': // ì„œë¦¬
                    sidebarTimer.style.borderColor = '#bdc3c7';
                    break;
                case 'ğŸ”¥': // ì—´ê¸°
                    sidebarTimer.style.borderColor = '#e74c3c';
                    break;
                case 'ğŸŒˆ': // ë¬´ì§€ê°œ
                    sidebarTimer.style.borderColor = '#ff6b6b';
                    break;
                case 'ğŸŒ˜': // ì•”ìš´
                    sidebarTimer.style.borderColor = '#34495e';
                    break;
            }
        }

        // ìë™ ì§„í–‰ í† ê¸€ (ì œê±°ë¨ - í•­ìƒ í™œì„±í™”)
        function toggleAutoProgress() {
            // ì´ í•¨ìˆ˜ëŠ” ë” ì´ìƒ ì‚¬ìš©ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤
            // ìë™ ì§„í–‰ì€ í•­ìƒ í™œì„±í™”ë˜ì–´ ìˆìŠµë‹ˆë‹¤
        }

        // ê²Œì„ ë£¨í”„
        function startGameLoop() {
            setInterval(() => {
                // ìë™ ì§„í–‰ ì²´í¬
                checkAutoProgress();
                
                // ì„±ì¥ ì™„ë£Œëœ ì‹ë¬¼ í™•ì¸
                gameState.plantedCrops.forEach((crop, index) => {
                    const plant = plants.find(p => p.id === crop.plantId);
                    const progress = (Date.now() - crop.plantTime) / (plant.growTime * 1000);
                    
                    if (progress >= 1 && !crop.notified) {
                        showNotification(`âœ¨ ${plant.name}ì´(ê°€) ì„±ì¥ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!`);
                        
                        // ì›¹ ì•Œë¦¼ í‘œì‹œ
                        showWebNotification(
                            'ğŸŒ¿ ë§ˆë²• ì˜¨ì‹¤ - ìˆ˜í™• ì‹œê°„!',
                            `${plant.name}ì´(ê°€) ì™„ì„±ë˜ì—ˆìŠµë‹ˆë‹¤! ìˆ˜í™•í•˜ëŸ¬ ì˜¤ì„¸ìš”!`
                        );
                        
                        crop.notified = true;
                    }
                });
                
                // íƒ€ì´ë¨¸ ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸
                updateTimer();
                
                renderPlantSlots();
            }, 1000);
        }

        // ê²Œì„ ì‹œì‘
        initGame();
    </script>
</body>
</html>
